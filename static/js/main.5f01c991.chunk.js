(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1:function(e,t,r){"use strict";(function(e){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){o(e,t,r[t])})}return e}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&function(e,t){(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?p(e):t}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function d(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}r.d(t,"a",function(){return y}),r.d(t,"b",function(){return m}),r.d(t,"c",function(){return c}),r.d(t,"d",function(){return n}),r.d(t,"e",function(){return f}),r.d(t,"f",function(){return l}),r.d(t,"g",function(){return i}),r.d(t,"h",function(){return h}),r.d(t,"i",function(){return o}),r.d(t,"j",function(){return p}),r.d(t,"k",function(){return s}),r.d(t,"l",function(){return u}),r.d(t,"m",function(){return d}),r.d(t,"n",function(){return _});var _="undefined"!=typeof window?window:"undefined"!=typeof e?e:"undefined"!=typeof self?self:{};function m(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function y(e,t){return e(t={exports:{}},t.exports),t.exports}}).call(this,r(32))},10:function(e,t,r){"use strict";r.d(t,"a",function(){return A}),r.d(t,"b",function(){return a}),r.d(t,"c",function(){return m}),r.d(t,"d",function(){return s}),r.d(t,"e",function(){return y}),r.d(t,"f",function(){return c}),r.d(t,"g",function(){return i}),r.d(t,"h",function(){return g}),r.d(t,"i",function(){return A});var n=r(1),a=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},i="object"==typeof n.n&&n.n&&n.n.Object===Object&&n.n,o="object"==typeof self&&self&&self.Object===Object&&self,s=i||o||Function("return this")(),u=function(){return s.Date.now()},c=s.Symbol,l=Object.prototype,p=l.hasOwnProperty,f=l.toString,h=c?c.toStringTag:void 0,d=Object.prototype.toString,_=c?c.toStringTag:void 0,m=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":_&&_ in Object(e)?function(e){var t=p.call(e,h),r=e[h];try{e[h]=void 0;var n=!0}catch(e){}var a=f.call(e);return n&&(t?e[h]=r:delete e[h]),a}(e):function(e){return d.call(e)}(e)},y=function(e){return null!=e&&"object"==typeof e},g=function(e){return"symbol"==typeof e||y(e)&&"[object Symbol]"==m(e)},b=/^\s+|\s+$/g,v=/^[-+]0x[0-9a-f]+$/i,S=/^0b[01]+$/i,O=/^0o[0-7]+$/i,I=parseInt,E=function(e){if("number"==typeof e)return e;if(g(e))return NaN;if(a(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=a(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(b,"");var r=S.test(e);return r||O.test(e)?I(e.slice(2),r?2:8):v.test(e)?NaN:+e},T=Math.max,w=Math.min,A=function(e,t,r){var n,i,o,s,c,l,p=0,f=!1,h=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function _(t){var r=n,a=i;return n=i=void 0,p=t,s=e.apply(a,r)}function m(e){var r=e-l;return void 0===l||r>=t||r<0||h&&e-p>=o}function y(){var e=u();if(m(e))return g(e);c=setTimeout(y,function(e){var r=t-(e-l);return h?w(r,o-(e-p)):r}(e))}function g(e){return c=void 0,d&&n?_(e):(n=i=void 0,s)}function b(){var e=u(),r=m(e);if(n=arguments,i=this,l=e,r){if(void 0===c)return function(e){return p=e,c=setTimeout(y,t),f?_(e):s}(l);if(h)return c=setTimeout(y,t),_(l)}return void 0===c&&(c=setTimeout(y,t)),s}return t=E(t)||0,a(r)&&(f=!!r.leading,o=(h="maxWait"in r)?T(E(r.maxWait)||0,t):o,d="trailing"in r?!!r.trailing:d),b.cancel=function(){void 0!==c&&clearTimeout(c),p=0,n=l=i=c=void 0},b.flush=function(){return void 0===c?s:g(u())},b}},119:function(e,t,r){e.exports={title:"home_title__3ok97",nav:"home_nav__3smZl"}},125:function(e,t,r){e.exports={mapContainer:"map-navigation_mapContainer__3x2ez",arrow:"map-navigation_arrow__2jbzJ"}},220:function(e,t,r){e.exports=r(432)},225:function(e,t,r){},226:function(e,t,r){},31:function(e,t,r){e.exports={searchContainer:"search_searchContainer__3P2qq",searchInput:"search_searchInput__1BgH8",searchErrorsContainer:"search_searchErrorsContainer__fk9vi",searchItemError:"search_searchItemError__ufY7H",optionListContainer:"search_optionListContainer__3xC3U",optionList:"search_optionList__3wYEj",optionlistItem:"search_optionlistItem__3Yr2D",optionlistItemLoading:"search_optionlistItemLoading__3wMt_ search_optionlistItem__3Yr2D",optionlistItemPlaceholder:"search_optionlistItemPlaceholder__1exp4",loadingContainer:"search_loadingContainer__2Q4Qn",spinner:"search_spinner__Y_1Cs",spin:"search_spin__1NWrg"}},327:function(e,t,r){},4:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"C",function(){return clearHighlightedClickedVessel}),__webpack_require__.d(__webpack_exports__,"bb",function(){return POLYGON_LAYERS_AREA}),__webpack_require__.d(__webpack_exports__,"cb",function(){return zoomIntoVesselCenter}),__webpack_require__.d(__webpack_exports__,"db",function(){return clearHighlightedVessels}),__webpack_require__.d(__webpack_exports__,"eb",function(){return MAX_SPRITES_PER_LAYER}),__webpack_require__.d(__webpack_exports__,"fb",function(){return VESSELS_BASE_RADIUS}),__webpack_require__.d(__webpack_exports__,"gb",function(){return BRUSH_RENDERING_STYLE}),__webpack_require__.d(__webpack_exports__,"hb",function(){return BRUSH_ZOOM_RENDERING_STYLE}),__webpack_require__.d(__webpack_exports__,"ib",function(){return uniq_1}),__webpack_require__.d(__webpack_exports__,"jb",function(){return vesselSatisfiesFilters}),__webpack_require__.d(__webpack_exports__,"kb",function(){return worldToPixels}),__webpack_require__.d(__webpack_exports__,"lb",function(){return TRACKS_DOTS_STYLE_ZOOM_THRESHOLD}),__webpack_require__.d(__webpack_exports__,"mb",function(){return VESSELS_HEATMAP_BLUR_FACTOR}),__webpack_require__.d(__webpack_exports__,"nb",function(){return VESSELS_HEATMAP_DIMMING_ALPHA}),__webpack_require__.d(__webpack_exports__,"ob",function(){return lngLatToWorld}),__webpack_require__.d(__webpack_exports__,"pb",function(){return VESSEL_CLICK_TOLERANCE_PX}),__webpack_require__.d(__webpack_exports__,"qb",function(){return ACTIVITY_HIGHLIGHT_HUE}),__webpack_require__.d(__webpack_exports__,"rb",function(){return VESSELS_RADIAL_GRADIENT_STYLE_ZOOM_THRESHOLD}),__webpack_require__.d(__webpack_exports__,"sb",function(){return MIN_FRAME_LENGTH_MS}),__webpack_require__.d(__webpack_exports__,"tb",function(){return mapConvert}),__webpack_require__.d(__webpack_exports__,"ub",function(){return queryHeatmapVessels}),__webpack_require__.d(__webpack_exports__,"vb",function(){return exportNativeViewport}),__webpack_require__.d(__webpack_exports__,"wb",function(){return TILES_URL_NEEDING_AUTHENTICATION}),__webpack_require__.d(__webpack_exports__,"xb",function(){return TRACKS_LAYER_IN_FRONT_OF_GROUP}),__webpack_require__.d(__webpack_exports__,"yb",function(){return setViewport}),__webpack_require__.d(__webpack_exports__,"zb",function(){return transitionEnd}),__webpack_require__.d(__webpack_exports__,"b",function(){return closePopup}),__webpack_require__.d(__webpack_exports__,"c",function(){return CUSTOM_LAYERS_SUBTYPES}),__webpack_require__.d(__webpack_exports__,"d",function(){return STATIC_LAYERS_CARTO_TILES_ENDPOINT}),__webpack_require__.d(__webpack_exports__,"e",function(){return GL_TRANSPARENT}),__webpack_require__.d(__webpack_exports__,"f",function(){return STATIC_LAYERS_CARTO_ENDPOINT}),__webpack_require__.d(__webpack_exports__,"g",function(){return startLoader}),__webpack_require__.d(__webpack_exports__,"h",function(){return getTilePromises}),__webpack_require__.d(__webpack_exports__,"i",function(){return getCleanVectorArrays}),__webpack_require__.d(__webpack_exports__,"j",function(){return groupData}),__webpack_require__.d(__webpack_exports__,"k",function(){return addTracksPointsRenderingData}),__webpack_require__.d(__webpack_exports__,"l",function(){return getTracksPlaybackData}),__webpack_require__.d(__webpack_exports__,"m",function(){return completeLoader}),__webpack_require__.d(__webpack_exports__,"n",function(){return targetMapVessel}),__webpack_require__.d(__webpack_exports__,"o",function(){return INIT_MODULE}),__webpack_require__.d(__webpack_exports__,"p",function(){return SET_TEMPORAL_EXTENT}),__webpack_require__.d(__webpack_exports__,"q",function(){return SET_HIGHLIGHT_TEMPORAL_EXTENT}),__webpack_require__.d(__webpack_exports__,"r",function(){return START_LOADER}),__webpack_require__.d(__webpack_exports__,"s",function(){return COMPLETE_LOADER}),__webpack_require__.d(__webpack_exports__,"t",function(){return INIT_HEATMAP_LAYERS}),__webpack_require__.d(__webpack_exports__,"u",function(){return UPDATE_HEATMAP_LAYER_TEMPORAL_EXTENTS_LOADED_INDICES}),__webpack_require__.d(__webpack_exports__,"v",function(){return ADD_HEATMAP_LAYER}),__webpack_require__.d(__webpack_exports__,"w",function(){return UPDATE_HEATMAP_LAYER_STYLE}),__webpack_require__.d(__webpack_exports__,"x",function(){return REMOVE_HEATMAP_LAYER}),__webpack_require__.d(__webpack_exports__,"y",function(){return ADD_REFERENCE_TILE}),__webpack_require__.d(__webpack_exports__,"z",function(){return UPDATE_HEATMAP_TILE}),__webpack_require__.d(__webpack_exports__,"A",function(){return RELEASE_HEATMAP_TILES}),__webpack_require__.d(__webpack_exports__,"B",function(){return UPDATE_LOADED_TILES}),__webpack_require__.d(__webpack_exports__,"a",function(){return HIGHLIGHT_VESSELS}),__webpack_require__.d(__webpack_exports__,"D",function(){return HIGHLIGHT_CLICKED_VESSEL}),__webpack_require__.d(__webpack_exports__,"E",function(){return CLEAR_HIGHLIGHT_CLICKED_VESSEL}),__webpack_require__.d(__webpack_exports__,"F",function(){return SET_CURRENTLY_VISIBLE_TILES}),__webpack_require__.d(__webpack_exports__,"G",function(){return SET_CURRENTLY_LOADED_TILES}),__webpack_require__.d(__webpack_exports__,"H",function(){return SET_CURRENTLY_SWAPPED_TILE_UIDS}),__webpack_require__.d(__webpack_exports__,"I",function(){return MARK_TILES_UIDS_AS_LOADED}),__webpack_require__.d(__webpack_exports__,"J",function(){return RELEASE_MARKED_TILES_UIDS}),__webpack_require__.d(__webpack_exports__,"K",function(){return SET_VIEWPORT}),__webpack_require__.d(__webpack_exports__,"L",function(){return UPDATE_VIEWPORT}),__webpack_require__.d(__webpack_exports__,"M",function(){return SET_ZOOM_INCREMENT}),__webpack_require__.d(__webpack_exports__,"N",function(){return TRANSITION_TYPE}),__webpack_require__.d(__webpack_exports__,"O",function(){return SET_MOUSE_LAT_LONG}),__webpack_require__.d(__webpack_exports__,"P",function(){return TRANSITION_END}),__webpack_require__.d(__webpack_exports__,"Q",function(){return SET_NATIVE_VIEWPORT}),__webpack_require__.d(__webpack_exports__,"R",function(){return MAX_ZOOM_LEVEL}),__webpack_require__.d(__webpack_exports__,"S",function(){return MIN_ZOOM_LEVEL}),__webpack_require__.d(__webpack_exports__,"T",function(){return store}),__webpack_require__.d(__webpack_exports__,"U",function(){return setTemporalExtent}),__webpack_require__.d(__webpack_exports__,"V",function(){return initModule}),__webpack_require__.d(__webpack_exports__,"W",function(){return setHighlightTemporalExtent}),__webpack_require__.d(__webpack_exports__,"X",function(){return updateHeatmapLayers}),__webpack_require__.d(__webpack_exports__,"Y",function(){return updateLayerLoadTemporalExtents}),__webpack_require__.d(__webpack_exports__,"Z",function(){return transitionToZoom}),__webpack_require__.d(__webpack_exports__,"ab",function(){return updateViewport});var _chunk_4036bba0_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(10),redux__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(38),TIMELINE_STEP=864e5,MIN_FRAME_LENGTH_MS=TIMELINE_STEP,VESSELS_RADIAL_GRADIENT_STYLE_ZOOM_THRESHOLD=6,VESSELS_BASE_RADIUS=8,VESSELS_HEATMAP_BLUR_FACTOR=.15,ACTIVITY_HIGHLIGHT_HUE=312,VESSELS_HEATMAP_DIMMING_ALPHA=.5,TRACKS_DOTS_STYLE_ZOOM_THRESHOLD=2,MAX_SPRITES_PER_LAYER=2e5,VESSEL_CLICK_TOLERANCE_PX=10,CLUSTER_CLICK_ZOOM_INCREMENT=1,MIN_ZOOM_LEVEL=1,MAX_ZOOM_LEVEL=14,ACTIVITY_LAYERS_MAX_ZOOM_LEVEL_TILE_LOADING=10,TILES_LOAD_ZOOM_OFFSET=.5,STATIC_LAYERS_CARTO_ENDPOINT="https://carto.globalfishingwatch.org/user/admin/api/v1/map?config=$MAPCONFIG",STATIC_LAYERS_CARTO_TILES_ENDPOINT="https://carto.globalfishingwatch.org/user/admin/api/v1/map/$LAYERGROUPID/{z}/{x}/{y}.mvt",TRACKS_LAYER_IN_FRONT_OF_GROUP="static",TILES_URL_NEEDING_AUTHENTICATION="dot-world-fishing",INIT_MODULE="INIT_MODULE",SET_TEMPORAL_EXTENT="SET_TEMPORAL_EXTENT",SET_HIGHLIGHT_TEMPORAL_EXTENT="SET_HIGHLIGHT_TEMPORAL_EXTENT",START_LOADER="START_LOADER",COMPLETE_LOADER="COMPLETE_LOADER",initModule=function(e){return function(t){t({type:INIT_MODULE,payload:e})}},startLoader=function(e,t,r){var n=(new Date).getTime(),a=void 0!==r?"".concat(r,"_").concat(n):n;return e({type:START_LOADER,payload:a}),void 0!==t.map.module.onLoadStart&&t.map.module.onLoadStart(),r},completeLoader=function(e){return function(t,r){t({type:COMPLETE_LOADER,payload:e});var n=r();n.map.module.loaders.length||void 0===n.map.module.onLoadComplete||n.map.module.onLoadComplete()}},onViewportChange=function(){return function(e,t){var r=t(),n=r.map.module.onViewportChange;if(void 0!==n){var a=r.map.viewport;void 0!==a.bounds&&n({zoom:a.viewport.zoom,center:[a.viewport.latitude,a.viewport.longitude],bounds:a.bounds,canZoomIn:a.canZoomIn,canZoomOut:a.canZoomOut,mouseLatLong:a.mouseLatLong})}}},setTemporalExtent=function(e){return{type:SET_TEMPORAL_EXTENT,payload:e}},setHighlightTemporalExtent=function(e){return{type:SET_HIGHLIGHT_TEMPORAL_EXTENT,payload:e}},closePopup=function(){return function(e,t){var r=t();void 0!==r.map.module.onClosePopup&&r.map.module.onClosePopup()}},GL_TRANSPARENT="rgba(0,0,0,0)",TRANSITION_TYPE={ZOOM:"ZOOM"},ENCOUNTERS="Encounters",BRUSH_RENDERING_STYLE={NORMAL:0,BULLSEYE:2},BRUSH_ZOOM_RENDERING_STYLE={RADIAL_GRADIENT:0,CIRCLE:1},POLYGON_LAYERS_AREA="POLYGON_LAYERS_AREA",CUSTOM_LAYERS_SUBTYPES={geojson:"geojson",raster:"raster"},asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(e){if(!Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.b)(e))return!1;var t=Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.c)(e);return t==funcTag||t==genTag||t==asyncTag||t==proxyTag}var isFunction_1=isFunction,coreJsData=_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.d["__core-js_shared__"],_coreJsData=coreJsData,maskSrcKey=(uid=/[^.]+$/.exec(_coreJsData&&_coreJsData.keys&&_coreJsData.keys.IE_PROTO||""),uid?"Symbol(src)_1."+uid:""),uid;function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}var _isMasked=isMasked,funcProto=Function.prototype,funcToString=funcProto.toString;function toSource(e){if(null!=e){try{return funcToString.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var _toSource=toSource,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty=objectProto.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){return!(!Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.b)(e)||_isMasked(e))&&(isFunction_1(e)?reIsNative:reIsHostCtor).test(_toSource(e))}var _baseIsNative=baseIsNative;function getValue(e,t){return null==e?void 0:e[t]}var _getValue=getValue;function getNative(e,t){var r=_getValue(e,t);return _baseIsNative(r)?r:void 0}var _getNative=getNative,nativeCreate=_getNative(Object,"create"),_nativeCreate=nativeCreate;function hashClear(){this.__data__=_nativeCreate?_nativeCreate(null):{},this.size=0}var _hashClear=hashClear;function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var _hashDelete=hashDelete,HASH_UNDEFINED="__lodash_hash_undefined__",objectProto$1=Object.prototype,hasOwnProperty$1=objectProto$1.hasOwnProperty;function hashGet(e){var t=this.__data__;if(_nativeCreate){var r=t[e];return r===HASH_UNDEFINED?void 0:r}return hasOwnProperty$1.call(t,e)?t[e]:void 0}var _hashGet=hashGet,objectProto$2=Object.prototype,hasOwnProperty$2=objectProto$2.hasOwnProperty;function hashHas(e){var t=this.__data__;return _nativeCreate?void 0!==t[e]:hasOwnProperty$2.call(t,e)}var _hashHas=hashHas,HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=_nativeCreate&&void 0===t?HASH_UNDEFINED$1:t,this}var _hashSet=hashSet;function Hash(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Hash.prototype.clear=_hashClear,Hash.prototype.delete=_hashDelete,Hash.prototype.get=_hashGet,Hash.prototype.has=_hashHas,Hash.prototype.set=_hashSet;var _Hash=Hash;function listCacheClear(){this.__data__=[],this.size=0}var _listCacheClear=listCacheClear;function eq(e,t){return e===t||e!=e&&t!=t}var eq_1=eq;function assocIndexOf(e,t){for(var r=e.length;r--;)if(eq_1(e[r][0],t))return r;return-1}var _assocIndexOf=assocIndexOf,arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(e){var t=this.__data__,r=_assocIndexOf(t,e);return!(r<0)&&(r==t.length-1?t.pop():splice.call(t,r,1),--this.size,!0)}var _listCacheDelete=listCacheDelete;function listCacheGet(e){var t=this.__data__,r=_assocIndexOf(t,e);return r<0?void 0:t[r][1]}var _listCacheGet=listCacheGet;function listCacheHas(e){return _assocIndexOf(this.__data__,e)>-1}var _listCacheHas=listCacheHas;function listCacheSet(e,t){var r=this.__data__,n=_assocIndexOf(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var _listCacheSet=listCacheSet;function ListCache(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ListCache.prototype.clear=_listCacheClear,ListCache.prototype.delete=_listCacheDelete,ListCache.prototype.get=_listCacheGet,ListCache.prototype.has=_listCacheHas,ListCache.prototype.set=_listCacheSet;var _ListCache=ListCache,Map=_getNative(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.d,"Map"),_Map=Map;function mapCacheClear(){this.size=0,this.__data__={hash:new _Hash,map:new(_Map||_ListCache),string:new _Hash}}var _mapCacheClear=mapCacheClear;function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}var _isKeyable=isKeyable;function getMapData(e,t){var r=e.__data__;return _isKeyable(t)?r["string"==typeof t?"string":"hash"]:r.map}var _getMapData=getMapData;function mapCacheDelete(e){var t=_getMapData(this,e).delete(e);return this.size-=t?1:0,t}var _mapCacheDelete=mapCacheDelete;function mapCacheGet(e){return _getMapData(this,e).get(e)}var _mapCacheGet=mapCacheGet;function mapCacheHas(e){return _getMapData(this,e).has(e)}var _mapCacheHas=mapCacheHas;function mapCacheSet(e,t){var r=_getMapData(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var _mapCacheSet=mapCacheSet;function MapCache(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}MapCache.prototype.clear=_mapCacheClear,MapCache.prototype.delete=_mapCacheDelete,MapCache.prototype.get=_mapCacheGet,MapCache.prototype.has=_mapCacheHas,MapCache.prototype.set=_mapCacheSet;var _MapCache=MapCache,HASH_UNDEFINED$2="__lodash_hash_undefined__";function setCacheAdd(e){return this.__data__.set(e,HASH_UNDEFINED$2),this}var _setCacheAdd=setCacheAdd;function setCacheHas(e){return this.__data__.has(e)}var _setCacheHas=setCacheHas;function SetCache(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new _MapCache;++t<r;)this.add(e[t])}SetCache.prototype.add=SetCache.prototype.push=_setCacheAdd,SetCache.prototype.has=_setCacheHas;var _SetCache=SetCache;function baseFindIndex(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}var _baseFindIndex=baseFindIndex;function baseIsNaN(e){return e!=e}var _baseIsNaN=baseIsNaN;function strictIndexOf(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var _strictIndexOf=strictIndexOf;function baseIndexOf(e,t,r){return t==t?_strictIndexOf(e,t,r):_baseFindIndex(e,_baseIsNaN,r)}var _baseIndexOf=baseIndexOf;function arrayIncludes(e,t){return!(null==e||!e.length)&&_baseIndexOf(e,t,0)>-1}var _arrayIncludes=arrayIncludes;function arrayIncludesWith(e,t,r){for(var n=-1,a=null==e?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var _arrayIncludesWith=arrayIncludesWith;function arrayMap(e,t){for(var r=-1,n=null==e?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var _arrayMap=arrayMap;function baseUnary(e){return function(t){return e(t)}}var _baseUnary=baseUnary;function cacheHas(e,t){return e.has(t)}var _cacheHas=cacheHas,LARGE_ARRAY_SIZE=200;function baseDifference(e,t,r,n){var a=-1,i=_arrayIncludes,o=!0,s=e.length,u=[],c=t.length;if(!s)return u;r&&(t=_arrayMap(t,_baseUnary(r))),n?(i=_arrayIncludesWith,o=!1):t.length>=LARGE_ARRAY_SIZE&&(i=_cacheHas,o=!1,t=new _SetCache(t));e:for(;++a<s;){var l=e[a],p=null==r?l:r(l);if(l=n||0!==l?l:0,o&&p==p){for(var f=c;f--;)if(t[f]===p)continue e;u.push(l)}else i(t,p,n)||u.push(l)}return u}var _baseDifference=baseDifference;function arrayPush(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var _arrayPush=arrayPush,argsTag="[object Arguments]";function baseIsArguments(e){return Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.e)(e)&&Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.c)(e)==argsTag}var _baseIsArguments=baseIsArguments,objectProto$3=Object.prototype,hasOwnProperty$3=objectProto$3.hasOwnProperty,propertyIsEnumerable=objectProto$3.propertyIsEnumerable,isArguments=_baseIsArguments(function(){return arguments}())?_baseIsArguments:function(e){return Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.e)(e)&&hasOwnProperty$3.call(e,"callee")&&!propertyIsEnumerable.call(e,"callee")},isArguments_1=isArguments,isArray=Array.isArray,isArray_1=isArray,spreadableSymbol=_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.f?_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.f.isConcatSpreadable:void 0;function isFlattenable(e){return isArray_1(e)||isArguments_1(e)||!!(spreadableSymbol&&e&&e[spreadableSymbol])}var _isFlattenable=isFlattenable;function baseFlatten(e,t,r,n,a){var i=-1,o=e.length;for(r||(r=_isFlattenable),a||(a=[]);++i<o;){var s=e[i];t>0&&r(s)?t>1?baseFlatten(s,t-1,r,n,a):_arrayPush(a,s):n||(a[a.length]=s)}return a}var _baseFlatten=baseFlatten;function identity(e){return e}var identity_1=identity;function apply(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var _apply=apply,nativeMax=Math.max;function overRest(e,t,r){return t=nativeMax(void 0===t?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=nativeMax(n.length-t,0),o=Array(i);++a<i;)o[a]=n[t+a];a=-1;for(var s=Array(t+1);++a<t;)s[a]=n[a];return s[t]=r(o),_apply(e,this,s)}}var _overRest=overRest;function constant(e){return function(){return e}}var constant_1=constant,defineProperty=function(){try{var e=_getNative(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),_defineProperty=defineProperty,baseSetToString=_defineProperty?function(e,t){return _defineProperty(e,"toString",{configurable:!0,enumerable:!1,value:constant_1(t),writable:!0})}:identity_1,_baseSetToString=baseSetToString,HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(e){var t=0,r=0;return function(){var n=nativeNow(),a=HOT_SPAN-(n-r);if(r=n,a>0){if(++t>=HOT_COUNT)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var _shortOut=shortOut,setToString=_shortOut(_baseSetToString),_setToString=setToString;function baseRest(e,t){return _setToString(_overRest(e,t,identity_1),e+"")}var _baseRest=baseRest,MAX_SAFE_INTEGER=9007199254740991;function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=MAX_SAFE_INTEGER}var isLength_1=isLength;function isArrayLike(e){return null!=e&&isLength_1(e.length)&&!isFunction_1(e)}var isArrayLike_1=isArrayLike;function isArrayLikeObject(e){return Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.e)(e)&&isArrayLike_1(e)}var isArrayLikeObject_1=isArrayLikeObject,difference=_baseRest(function(e,t){return isArrayLikeObject_1(e)?_baseDifference(e,_baseFlatten(t,1,isArrayLikeObject_1,!0)):[]}),difference_1=difference,Set=_getNative(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.d,"Set"),_Set=Set;function noop(){}var noop_1=noop;function setToArray(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var _setToArray=setToArray,INFINITY=1/0,createSet=_Set&&1/_setToArray(new _Set([,-0]))[1]==INFINITY?function(e){return new _Set(e)}:noop_1,_createSet=createSet,LARGE_ARRAY_SIZE$1=200;function baseUniq(e,t,r){var n=-1,a=_arrayIncludes,i=e.length,o=!0,s=[],u=s;if(r)o=!1,a=_arrayIncludesWith;else if(i>=LARGE_ARRAY_SIZE$1){var c=t?null:_createSet(e);if(c)return _setToArray(c);o=!1,a=_cacheHas,u=new _SetCache}else u=t?[]:s;e:for(;++n<i;){var l=e[n],p=t?t(l):l;if(l=r||0!==l?l:0,o&&p==p){for(var f=u.length;f--;)if(u[f]===p)continue e;t&&u.push(p),s.push(l)}else a(u,p,r)||(u!==s&&u.push(p),s.push(l))}return s}var _baseUniq=baseUniq;function uniq(e){return e&&e.length?_baseUniq(e):[]}var uniq_1=uniq;function stackClear(){this.__data__=new _ListCache,this.size=0}var _stackClear=stackClear;function stackDelete(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var _stackDelete=stackDelete;function stackGet(e){return this.__data__.get(e)}var _stackGet=stackGet;function stackHas(e){return this.__data__.has(e)}var _stackHas=stackHas,LARGE_ARRAY_SIZE$2=200;function stackSet(e,t){var r=this.__data__;if(r instanceof _ListCache){var n=r.__data__;if(!_Map||n.length<LARGE_ARRAY_SIZE$2-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new _MapCache(n)}return r.set(e,t),this.size=r.size,this}var _stackSet=stackSet;function Stack(e){var t=this.__data__=new _ListCache(e);this.size=t.size}Stack.prototype.clear=_stackClear,Stack.prototype.delete=_stackDelete,Stack.prototype.get=_stackGet,Stack.prototype.has=_stackHas,Stack.prototype.set=_stackSet;var _Stack=Stack;function arraySome(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var _arraySome=arraySome,COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function equalArrays(e,t,r,n,a,i){var o=r&COMPARE_PARTIAL_FLAG,s=e.length,u=t.length;if(s!=u&&!(o&&u>s))return!1;var c=i.get(e);if(c&&i.get(t))return c==t;var l=-1,p=!0,f=r&COMPARE_UNORDERED_FLAG?new _SetCache:void 0;for(i.set(e,t),i.set(t,e);++l<s;){var h=e[l],d=t[l];if(n)var _=o?n(d,h,l,t,e,i):n(h,d,l,e,t,i);if(void 0!==_){if(_)continue;p=!1;break}if(f){if(!_arraySome(t,function(e,t){if(!_cacheHas(f,t)&&(h===e||a(h,e,r,n,i)))return f.push(t)})){p=!1;break}}else if(h!==d&&!a(h,d,r,n,i)){p=!1;break}}return i.delete(e),i.delete(t),p}var _equalArrays=equalArrays,Uint8Array$1=_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.d.Uint8Array,_Uint8Array=Uint8Array$1;function mapToArray(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}var _mapToArray=mapToArray,COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2,boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.f?_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.f.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(e,t,r,n,a,i,o){switch(r){case dataViewTag:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case arrayBufferTag:return!(e.byteLength!=t.byteLength||!i(new _Uint8Array(e),new _Uint8Array(t)));case boolTag:case dateTag:case numberTag:return eq_1(+e,+t);case errorTag:return e.name==t.name&&e.message==t.message;case regexpTag:case stringTag:return e==t+"";case mapTag:var s=_mapToArray;case setTag:var u=n&COMPARE_PARTIAL_FLAG$1;if(s||(s=_setToArray),e.size!=t.size&&!u)return!1;var c=o.get(e);if(c)return c==t;n|=COMPARE_UNORDERED_FLAG$1,o.set(e,t);var l=_equalArrays(s(e),s(t),n,a,i,o);return o.delete(e),l;case symbolTag:if(symbolValueOf)return symbolValueOf.call(e)==symbolValueOf.call(t)}return!1}var _equalByTag=equalByTag;function baseGetAllKeys(e,t,r){var n=t(e);return isArray_1(e)?n:_arrayPush(n,r(e))}var _baseGetAllKeys=baseGetAllKeys;function arrayFilter(e,t){for(var r=-1,n=null==e?0:e.length,a=0,i=[];++r<n;){var o=e[r];t(o,r,e)&&(i[a++]=o)}return i}var _arrayFilter=arrayFilter;function stubArray(){return[]}var stubArray_1=stubArray,objectProto$4=Object.prototype,propertyIsEnumerable$1=objectProto$4.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols?function(e){return null==e?[]:(e=Object(e),_arrayFilter(nativeGetSymbols(e),function(t){return propertyIsEnumerable$1.call(e,t)}))}:stubArray_1,_getSymbols=getSymbols;function baseTimes(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var _baseTimes=baseTimes;function stubFalse(){return!1}var stubFalse_1=stubFalse,isBuffer_1=Object(_chunk_4036bba0_js__WEBPACK_IMPORTED_MODULE_0__.a)(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r?_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.d.Buffer:void 0,i=(a?a.isBuffer:void 0)||stubFalse_1;e.exports=i}),MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var r=typeof e;return!!(t=null==t?MAX_SAFE_INTEGER$1:t)&&("number"==r||"symbol"!=r&&reIsUint.test(e))&&e>-1&&e%1==0&&e<t}var _isIndex=isIndex,argsTag$1="[object Arguments]",arrayTag="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag$1="[object Function]",mapTag$1="[object Map]",numberTag$1="[object Number]",objectTag="[object Object]",regexpTag$1="[object RegExp]",setTag$1="[object Set]",stringTag$1="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray(e){return Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.e)(e)&&isLength_1(e.length)&&!!typedArrayTags[Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.c)(e)]}typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag$1]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag$1]=typedArrayTags[boolTag$1]=typedArrayTags[dataViewTag$1]=typedArrayTags[dateTag$1]=typedArrayTags[errorTag$1]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$1]=typedArrayTags[numberTag$1]=typedArrayTags[objectTag]=typedArrayTags[regexpTag$1]=typedArrayTags[setTag$1]=typedArrayTags[stringTag$1]=typedArrayTags[weakMapTag]=!1;var _baseIsTypedArray=baseIsTypedArray,_nodeUtil=Object(_chunk_4036bba0_js__WEBPACK_IMPORTED_MODULE_0__.a)(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r&&_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.g.process,i=function(){try{return n&&n.require&&n.require("util").types||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=i}),nodeIsTypedArray=_nodeUtil&&_nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?_baseUnary(nodeIsTypedArray):_baseIsTypedArray,isTypedArray_1=isTypedArray,objectProto$5=Object.prototype,hasOwnProperty$4=objectProto$5.hasOwnProperty;function arrayLikeKeys(e,t){var r=isArray_1(e),n=!r&&isArguments_1(e),a=!r&&!n&&isBuffer_1(e),i=!r&&!n&&!a&&isTypedArray_1(e),o=r||n||a||i,s=o?_baseTimes(e.length,String):[],u=s.length;for(var c in e)!t&&!hasOwnProperty$4.call(e,c)||o&&("length"==c||a&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||_isIndex(c,u))||s.push(c);return s}var _arrayLikeKeys=arrayLikeKeys,objectProto$6=Object.prototype;function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||objectProto$6)}var _isPrototype=isPrototype;function overArg(e,t){return function(r){return e(t(r))}}var _overArg=overArg,nativeKeys=_overArg(Object.keys,Object),_nativeKeys=nativeKeys,objectProto$7=Object.prototype,hasOwnProperty$5=objectProto$7.hasOwnProperty;function baseKeys(e){if(!_isPrototype(e))return _nativeKeys(e);var t=[];for(var r in Object(e))hasOwnProperty$5.call(e,r)&&"constructor"!=r&&t.push(r);return t}var _baseKeys=baseKeys;function keys(e){return isArrayLike_1(e)?_arrayLikeKeys(e):_baseKeys(e)}var keys_1=keys;function getAllKeys(e){return _baseGetAllKeys(e,keys_1,_getSymbols)}var _getAllKeys=getAllKeys,COMPARE_PARTIAL_FLAG$2=1,objectProto$8=Object.prototype,hasOwnProperty$6=objectProto$8.hasOwnProperty;function equalObjects(e,t,r,n,a,i){var o=r&COMPARE_PARTIAL_FLAG$2,s=_getAllKeys(e),u=s.length;if(u!=_getAllKeys(t).length&&!o)return!1;for(var c=u;c--;){var l=s[c];if(!(o?l in t:hasOwnProperty$6.call(t,l)))return!1}var p=i.get(e);if(p&&i.get(t))return p==t;var f=!0;i.set(e,t),i.set(t,e);for(var h=o;++c<u;){var d=e[l=s[c]],_=t[l];if(n)var m=o?n(_,d,l,t,e,i):n(d,_,l,e,t,i);if(!(void 0===m?d===_||a(d,_,r,n,i):m)){f=!1;break}h||(h="constructor"==l)}if(f&&!h){var y=e.constructor,g=t.constructor;y!=g&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof g&&g instanceof g)&&(f=!1)}return i.delete(e),i.delete(t),f}var _equalObjects=equalObjects,DataView$1=_getNative(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.d,"DataView"),_DataView=DataView$1,Promise$1=_getNative(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.d,"Promise"),_Promise=Promise$1,WeakMap=_getNative(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.d,"WeakMap"),_WeakMap=WeakMap,mapTag$2="[object Map]",objectTag$1="[object Object]",promiseTag="[object Promise]",setTag$2="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$2="[object DataView]",dataViewCtorString=_toSource(_DataView),mapCtorString=_toSource(_Map),promiseCtorString=_toSource(_Promise),setCtorString=_toSource(_Set),weakMapCtorString=_toSource(_WeakMap),getTag=_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.c;(_DataView&&getTag(new _DataView(new ArrayBuffer(1)))!=dataViewTag$2||_Map&&getTag(new _Map)!=mapTag$2||_Promise&&getTag(_Promise.resolve())!=promiseTag||_Set&&getTag(new _Set)!=setTag$2||_WeakMap&&getTag(new _WeakMap)!=weakMapTag$1)&&(getTag=function(e){var t=Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.c)(e),r=t==objectTag$1?e.constructor:void 0,n=r?_toSource(r):"";if(n)switch(n){case dataViewCtorString:return dataViewTag$2;case mapCtorString:return mapTag$2;case promiseCtorString:return promiseTag;case setCtorString:return setTag$2;case weakMapCtorString:return weakMapTag$1}return t});var _getTag=getTag,COMPARE_PARTIAL_FLAG$3=1,argsTag$2="[object Arguments]",arrayTag$1="[object Array]",objectTag$2="[object Object]",objectProto$9=Object.prototype,hasOwnProperty$7=objectProto$9.hasOwnProperty;function baseIsEqualDeep(e,t,r,n,a,i){var o=isArray_1(e),s=isArray_1(t),u=o?arrayTag$1:_getTag(e),c=s?arrayTag$1:_getTag(t),l=(u=u==argsTag$2?objectTag$2:u)==objectTag$2,p=(c=c==argsTag$2?objectTag$2:c)==objectTag$2,f=u==c;if(f&&isBuffer_1(e)){if(!isBuffer_1(t))return!1;o=!0,l=!1}if(f&&!l)return i||(i=new _Stack),o||isTypedArray_1(e)?_equalArrays(e,t,r,n,a,i):_equalByTag(e,t,u,r,n,a,i);if(!(r&COMPARE_PARTIAL_FLAG$3)){var h=l&&hasOwnProperty$7.call(e,"__wrapped__"),d=p&&hasOwnProperty$7.call(t,"__wrapped__");if(h||d){var _=h?e.value():e,m=d?t.value():t;return i||(i=new _Stack),a(_,m,r,n,i)}}return!!f&&(i||(i=new _Stack),_equalObjects(e,t,r,n,a,i))}var _baseIsEqualDeep=baseIsEqualDeep;function baseIsEqual(e,t,r,n,a){return e===t||(null==e||null==t||!Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.e)(e)&&!Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.e)(t)?e!=e&&t!=t:_baseIsEqualDeep(e,t,r,n,baseIsEqual,a))}var _baseIsEqual=baseIsEqual,COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2;function baseIsMatch(e,t,r,n){var a=r.length,i=a,o=!n;if(null==e)return!i;for(e=Object(e);a--;){var s=r[a];if(o&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++a<i;){var u=(s=r[a])[0],c=e[u],l=s[1];if(o&&s[2]){if(void 0===c&&!(u in e))return!1}else{var p=new _Stack;if(n)var f=n(c,l,u,e,t,p);if(!(void 0===f?_baseIsEqual(l,c,COMPARE_PARTIAL_FLAG$4|COMPARE_UNORDERED_FLAG$2,n,p):f))return!1}}return!0}var _baseIsMatch=baseIsMatch;function isStrictComparable(e){return e==e&&!Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.b)(e)}var _isStrictComparable=isStrictComparable;function getMatchData(e){for(var t=keys_1(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,_isStrictComparable(a)]}return t}var _getMatchData=getMatchData;function matchesStrictComparable(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}}var _matchesStrictComparable=matchesStrictComparable;function baseMatches(e){var t=_getMatchData(e);return 1==t.length&&t[0][2]?_matchesStrictComparable(t[0][0],t[0][1]):function(r){return r===e||_baseIsMatch(r,e,t)}}var _baseMatches=baseMatches,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(e,t){if(isArray_1(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.h)(e))||reIsPlainProp.test(e)||!reIsDeepProp.test(e)||null!=t&&e in Object(t)}var _isKey=isKey,FUNC_ERROR_TEXT="Expected a function";function memoize(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT);var r=function r(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var o=e.apply(this,n);return r.cache=i.set(a,o)||i,o};return r.cache=new(memoize.Cache||_MapCache),r}memoize.Cache=_MapCache;var memoize_1=memoize,MAX_MEMOIZE_SIZE=500;function memoizeCapped(e){var t=memoize_1(e,function(e){return r.size===MAX_MEMOIZE_SIZE&&r.clear(),e}),r=t.cache;return t}var _memoizeCapped=memoizeCapped,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=_memoizeCapped(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(rePropName,function(e,r,n,a){t.push(n?a.replace(reEscapeChar,"$1"):r||e)}),t}),_stringToPath=stringToPath,INFINITY$1=1/0,symbolProto$1=_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.f?_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.f.prototype:void 0,symbolToString=symbolProto$1?symbolProto$1.toString:void 0;function baseToString(e){if("string"==typeof e)return e;if(isArray_1(e))return _arrayMap(e,baseToString)+"";if(Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.h)(e))return symbolToString?symbolToString.call(e):"";var t=e+"";return"0"==t&&1/e==-INFINITY$1?"-0":t}var _baseToString=baseToString;function toString(e){return null==e?"":_baseToString(e)}var toString_1=toString;function castPath(e,t){return isArray_1(e)?e:_isKey(e,t)?[e]:_stringToPath(toString_1(e))}var _castPath=castPath,INFINITY$2=1/0;function toKey(e){if("string"==typeof e||Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.h)(e))return e;var t=e+"";return"0"==t&&1/e==-INFINITY$2?"-0":t}var _toKey=toKey;function baseGet(e,t){for(var r=0,n=(t=_castPath(t,e)).length;null!=e&&r<n;)e=e[_toKey(t[r++])];return r&&r==n?e:void 0}var _baseGet=baseGet;function get(e,t,r){var n=null==e?void 0:_baseGet(e,t);return void 0===n?r:n}var get_1=get;function baseHasIn(e,t){return null!=e&&t in Object(e)}var _baseHasIn=baseHasIn;function hasPath(e,t,r){for(var n=-1,a=(t=_castPath(t,e)).length,i=!1;++n<a;){var o=_toKey(t[n]);if(!(i=null!=e&&r(e,o)))break;e=e[o]}return i||++n!=a?i:!!(a=null==e?0:e.length)&&isLength_1(a)&&_isIndex(o,a)&&(isArray_1(e)||isArguments_1(e))}var _hasPath=hasPath;function hasIn(e,t){return null!=e&&_hasPath(e,t,_baseHasIn)}var hasIn_1=hasIn,COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function baseMatchesProperty(e,t){return _isKey(e)&&_isStrictComparable(t)?_matchesStrictComparable(_toKey(e),t):function(r){var n=get_1(r,e);return void 0===n&&n===t?hasIn_1(r,e):_baseIsEqual(t,n,COMPARE_PARTIAL_FLAG$5|COMPARE_UNORDERED_FLAG$3)}}var _baseMatchesProperty=baseMatchesProperty;function baseProperty(e){return function(t){return null==t?void 0:t[e]}}var _baseProperty=baseProperty;function basePropertyDeep(e){return function(t){return _baseGet(t,e)}}var _basePropertyDeep=basePropertyDeep;function property(e){return _isKey(e)?_baseProperty(_toKey(e)):_basePropertyDeep(e)}var property_1=property;function baseIteratee(e){return"function"==typeof e?e:null==e?identity_1:"object"==typeof e?isArray_1(e)?_baseMatchesProperty(e[0],e[1]):_baseMatches(e):property_1(e)}var _baseIteratee=baseIteratee;function uniqBy(e,t){return e&&e.length?_baseUniq(e,_baseIteratee(t,2)):[]}var uniqBy_1=uniqBy;function baseIndexOfWith(e,t,r,n){for(var a=r-1,i=e.length;++a<i;)if(n(e[a],t))return a;return-1}var _baseIndexOfWith=baseIndexOfWith;function copyArray(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var _copyArray=copyArray,arrayProto$1=Array.prototype,splice$1=arrayProto$1.splice;function basePullAll(e,t,r,n){var a=n?_baseIndexOfWith:_baseIndexOf,i=-1,o=t.length,s=e;for(e===t&&(t=_copyArray(t)),r&&(s=_arrayMap(e,_baseUnary(r)));++i<o;)for(var u=0,c=t[i],l=r?r(c):c;(u=a(s,l,u,n))>-1;)s!==e&&splice$1.call(s,u,1),splice$1.call(e,u,1);return e}var _basePullAll=basePullAll;function pullAll(e,t){return e&&e.length&&t&&t.length?_basePullAll(e,t):e}var pullAll_1=pullAll,pull=_baseRest(pullAll_1),pull_1=pull;function baseSum(e,t){for(var r,n=-1,a=e.length;++n<a;){var i=t(e[n]);void 0!==i&&(r=void 0===r?i:r+i)}return r}var _baseSum=baseSum;function sumBy(e,t){return e&&e.length?_baseSum(e,_baseIteratee(t,2)):0}var sumBy_1=sumBy;function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _typeof2(e){return(_typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)})(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArrayLimit(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}var EPSILON=1e-6,ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,degree=Math.PI/180;function create(){var e=new ARRAY_TYPE(4);return ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function scale(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function transformMat4(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3];return e[0]=r[0]*n+r[4]*a+r[8]*i+r[12]*o,e[1]=r[1]*n+r[5]*a+r[9]*i+r[13]*o,e[2]=r[2]*n+r[6]*a+r[10]*i+r[14]*o,e[3]=r[3]*n+r[7]*a+r[11]*i+r[15]*o,e}var forEach=(vec=create(),function(e,t,r,n,a,i){var o,s;for(t||(t=4),r||(r=0),s=n?Math.min(n*t+r,e.length):e.length,o=r;o<s;o+=t)vec[0]=e[o],vec[1]=e[o+1],vec[2]=e[o+2],vec[3]=e[o+3],a(vec,vec,i),e[o]=vec[0],e[o+1]=vec[1],e[o+2]=vec[2],e[o+3]=vec[3];return e}),vec;function createMat4(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function transformVector(e,t){var r=transformMat4([],t,e);return scale(r,r,1/r[3]),r}function invert(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=t[8],p=t[9],f=t[10],h=t[11],d=t[12],_=t[13],m=t[14],y=t[15],g=r*s-n*o,b=r*u-a*o,v=r*c-i*o,S=n*u-a*s,O=n*c-i*s,I=a*c-i*u,E=l*_-p*d,T=l*m-f*d,w=l*y-h*d,A=p*m-f*_,M=p*y-h*_,P=f*y-h*m,L=g*P-b*M+v*A+S*w-O*T+I*E;return L?(L=1/L,e[0]=(s*P-u*M+c*A)*L,e[1]=(a*M-n*P-i*A)*L,e[2]=(_*I-m*O+y*S)*L,e[3]=(f*O-p*I-h*S)*L,e[4]=(u*w-o*P-c*T)*L,e[5]=(r*P-a*w+i*T)*L,e[6]=(m*v-d*I-y*b)*L,e[7]=(l*I-f*v+h*b)*L,e[8]=(o*M-s*w+c*E)*L,e[9]=(n*w-r*M-i*E)*L,e[10]=(d*O-_*v+y*g)*L,e[11]=(p*v-l*O-h*g)*L,e[12]=(s*T-o*A-u*E)*L,e[13]=(r*A-n*T+a*E)*L,e[14]=(_*b-d*S-m*g)*L,e[15]=(l*S-p*b+f*g)*L,e):null}function multiply(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],c=t[6],l=t[7],p=t[8],f=t[9],h=t[10],d=t[11],_=t[12],m=t[13],y=t[14],g=t[15],b=r[0],v=r[1],S=r[2],O=r[3];return e[0]=b*n+v*s+S*p+O*_,e[1]=b*a+v*u+S*f+O*m,e[2]=b*i+v*c+S*h+O*y,e[3]=b*o+v*l+S*d+O*g,b=r[4],v=r[5],S=r[6],O=r[7],e[4]=b*n+v*s+S*p+O*_,e[5]=b*a+v*u+S*f+O*m,e[6]=b*i+v*c+S*h+O*y,e[7]=b*o+v*l+S*d+O*g,b=r[8],v=r[9],S=r[10],O=r[11],e[8]=b*n+v*s+S*p+O*_,e[9]=b*a+v*u+S*f+O*m,e[10]=b*i+v*c+S*h+O*y,e[11]=b*o+v*l+S*d+O*g,b=r[12],v=r[13],S=r[14],O=r[15],e[12]=b*n+v*s+S*p+O*_,e[13]=b*a+v*u+S*f+O*m,e[14]=b*i+v*c+S*h+O*y,e[15]=b*o+v*l+S*d+O*g,e}function translate(e,t,r){var n,a,i,o,s,u,c,l,p,f,h,d,_=r[0],m=r[1],y=r[2];return t===e?(e[12]=t[0]*_+t[4]*m+t[8]*y+t[12],e[13]=t[1]*_+t[5]*m+t[9]*y+t[13],e[14]=t[2]*_+t[6]*m+t[10]*y+t[14],e[15]=t[3]*_+t[7]*m+t[11]*y+t[15]):(n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],c=t[6],l=t[7],p=t[8],f=t[9],h=t[10],d=t[11],e[0]=n,e[1]=a,e[2]=i,e[3]=o,e[4]=s,e[5]=u,e[6]=c,e[7]=l,e[8]=p,e[9]=f,e[10]=h,e[11]=d,e[12]=n*_+s*m+p*y+t[12],e[13]=a*_+u*m+f*y+t[13],e[14]=i*_+c*m+h*y+t[14],e[15]=o*_+l*m+d*y+t[15]),e}function scale$1(e,t,r){var n=r[0],a=r[1],i=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*a,e[5]=t[5]*a,e[6]=t[6]*a,e[7]=t[7]*a,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function rotateX(e,t,r){var n=Math.sin(r),a=Math.cos(r),i=t[4],o=t[5],s=t[6],u=t[7],c=t[8],l=t[9],p=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*a+c*n,e[5]=o*a+l*n,e[6]=s*a+p*n,e[7]=u*a+f*n,e[8]=c*a-i*n,e[9]=l*a-o*n,e[10]=p*a-s*n,e[11]=f*a-u*n,e}function rotateZ(e,t,r){var n=Math.sin(r),a=Math.cos(r),i=t[0],o=t[1],s=t[2],u=t[3],c=t[4],l=t[5],p=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*a+c*n,e[1]=o*a+l*n,e[2]=s*a+p*n,e[3]=u*a+f*n,e[4]=c*a-i*n,e[5]=l*a-o*n,e[6]=p*a-s*n,e[7]=f*a-u*n,e}function perspective(e,t,r,n,a){var i,o=1/Math.tan(t/2);return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=a&&a!==1/0?(i=1/(n-a),e[10]=(a+n)*i,e[14]=2*a*n*i):(e[10]=-1,e[14]=-2*n),e}function equals(e,t){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],p=e[9],f=e[10],h=e[11],d=e[12],_=e[13],m=e[14],y=e[15],g=t[0],b=t[1],v=t[2],S=t[3],O=t[4],I=t[5],E=t[6],T=t[7],w=t[8],A=t[9],M=t[10],P=t[11],L=t[12],x=t[13],C=t[14],R=t[15];return Math.abs(r-g)<=EPSILON*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(n-b)<=EPSILON*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(a-v)<=EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(i-S)<=EPSILON*Math.max(1,Math.abs(i),Math.abs(S))&&Math.abs(o-O)<=EPSILON*Math.max(1,Math.abs(o),Math.abs(O))&&Math.abs(s-I)<=EPSILON*Math.max(1,Math.abs(s),Math.abs(I))&&Math.abs(u-E)<=EPSILON*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(c-T)<=EPSILON*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(l-w)<=EPSILON*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(p-A)<=EPSILON*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(f-M)<=EPSILON*Math.max(1,Math.abs(f),Math.abs(M))&&Math.abs(h-P)<=EPSILON*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(d-L)<=EPSILON*Math.max(1,Math.abs(d),Math.abs(L))&&Math.abs(_-x)<=EPSILON*Math.max(1,Math.abs(_),Math.abs(x))&&Math.abs(m-C)<=EPSILON*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(y-R)<=EPSILON*Math.max(1,Math.abs(y),Math.abs(R))}function create$1(){var e=new ARRAY_TYPE(2);return ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0),e}function add(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function negate(e,t){return e[0]=-t[0],e[1]=-t[1],e}function lerp(e,t,r,n){var a=t[0],i=t[1];return e[0]=a+n*(r[0]-a),e[1]=i+n*(r[1]-i),e}var forEach$1=function(){var e=create$1();return function(t,r,n,a,i,o){var s,u;for(r||(r=2),n||(n=0),u=a?Math.min(a*r+n,t.length):t.length,s=n;s<u;s+=r)e[0]=t[s],e[1]=t[s+1],i(e,e,o),t[s]=e[0],t[s+1]=e[1];return t}}();function create$2(){var e=new ARRAY_TYPE(3);return ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function negate$1(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}var forEach$2=function(){var e=create$2();return function(t,r,n,a,i,o){var s,u;for(r||(r=3),n||(n=0),u=a?Math.min(a*r+n,t.length):t.length,s=n;s<u;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],i(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}();function assert(e,t){if(!e)throw new Error(t||"viewport-mercator-project: assertion failed.")}var PI=Math.PI,PI_4=PI/4,DEGREES_TO_RADIANS=PI/180,RADIANS_TO_DEGREES=180/PI,TILE_SIZE=512,EARTH_CIRCUMFERENCE=4003e4,DEFAULT_ALTITUDE=1.5;function zoomToScale(e){return Math.pow(2,e)}function lngLatToWorld(e,t){var r=_slicedToArray(e,2),n=r[0],a=r[1];assert(Number.isFinite(n)&&Number.isFinite(t)),assert(Number.isFinite(a)&&a>=-90&&a<=90,"invalid latitude");var i=a*DEGREES_TO_RADIANS;return[(t*=TILE_SIZE)*(n*DEGREES_TO_RADIANS+PI)/(2*PI),t*(PI-Math.log(Math.tan(PI_4+.5*i)))/(2*PI)]}function worldToLngLat(e,t){var r=_slicedToArray(e,2),n=r[0],a=r[1],i=n/(t*=TILE_SIZE)*(2*PI)-PI,o=2*(Math.atan(Math.exp(PI-a/t*(2*PI)))-PI_4);return[i*RADIANS_TO_DEGREES,o*RADIANS_TO_DEGREES]}function getDistanceScales(e){var t=e.latitude,r=e.longitude,n=e.zoom,a=e.scale,i=e.highPrecision,o=void 0!==i&&i;a=void 0!==a?a:zoomToScale(n),assert(Number.isFinite(t)&&Number.isFinite(r)&&Number.isFinite(a));var s={},u=TILE_SIZE*a,c=Math.cos(t*DEGREES_TO_RADIANS),l=u/360,p=l/c,f=u/EARTH_CIRCUMFERENCE/c;if(s.pixelsPerMeter=[f,-f,f],s.metersPerPixel=[1/f,-1/f,1/f],s.pixelsPerDegree=[l,-p,f],s.degreesPerPixel=[1/l,-1/p,1/f],o){var h=DEGREES_TO_RADIANS*Math.tan(t*DEGREES_TO_RADIANS)/c,d=l*h/2,_=u/EARTH_CIRCUMFERENCE*h,m=_/p*f;s.pixelsPerDegree2=[0,-d,_],s.pixelsPerMeter2=[m,0,m]}return s}function getViewMatrix(e){var t=e.height,r=e.pitch,n=e.bearing,a=e.altitude,i=e.center,o=void 0===i?null:i,s=e.flipY,u=void 0!==s&&s,c=createMat4();return translate(c,c,[0,0,-a]),scale$1(c,c,[1,1,1/t]),rotateX(c,c,-r*DEGREES_TO_RADIANS),rotateZ(c,c,n*DEGREES_TO_RADIANS),u&&scale$1(c,c,[1,-1,1]),o&&translate(c,c,negate$1([],o)),c}function getProjectionParameters(e){var t=e.width,r=e.height,n=e.altitude,a=void 0===n?DEFAULT_ALTITUDE:n,i=e.pitch,o=void 0===i?0:i,s=e.nearZMultiplier,u=void 0===s?1:s,c=e.farZMultiplier,l=void 0===c?1:c,p=o*DEGREES_TO_RADIANS,f=Math.atan(.5/a),h=Math.sin(f)*a/Math.sin(Math.PI/2-p-f),d=Math.cos(Math.PI/2-p)*h+a;return{fov:2*Math.atan(r/2/a),aspect:t/r,focalDistance:a,near:u,far:d*l}}function getProjectionMatrix(e){var t=e.width,r=e.height,n=e.pitch,a=getProjectionParameters({width:t,height:r,altitude:e.altitude,pitch:n,nearZMultiplier:e.nearZMultiplier,farZMultiplier:e.farZMultiplier});return perspective([],a.fov,a.aspect,a.near,a.far)}function worldToPixels(e,t){var r=_slicedToArray(e,3),n=r[0],a=r[1],i=r[2],o=void 0===i?0:i;return assert(Number.isFinite(n)&&Number.isFinite(a)&&Number.isFinite(o)),transformVector(t,[n,a,o,1])}function pixelsToWorld(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=_slicedToArray(e,3),a=n[0],i=n[1],o=n[2];if(assert(Number.isFinite(a)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(o))return transformVector(t,[a,i,o,1]);var s=transformVector(t,[a,i,0,1]),u=transformVector(t,[a,i,1,1]),c=s[2],l=u[2];return lerp([],s,u,c===l?0:((r||0)-c)/(l-c))}var IDENTITY=createMat4(),Viewport=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.width,n=t.height,a=t.viewMatrix,i=void 0===a?IDENTITY:a,o=t.projectionMatrix,s=void 0===o?IDENTITY:o;_classCallCheck(this,e),this.width=r||1,this.height=n||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=i,this.projectionMatrix=s;var u=createMat4();multiply(u,u,this.projectionMatrix),multiply(u,u,this.viewMatrix),this.viewProjectionMatrix=u;var c=createMat4();scale$1(c,c,[this.width/2,-this.height/2,1]),translate(c,c,[1,-1,0]),multiply(c,c,this.viewProjectionMatrix);var l=invert(createMat4(),c);if(!l)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=c,this.pixelUnprojectionMatrix=l,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return _createClass(e,[{key:"equals",value:function(t){return t instanceof e&&t.width===this.width&&t.height===this.height&&equals(t.projectionMatrix,this.projectionMatrix)&&equals(t.viewMatrix,this.viewMatrix)}},{key:"project",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).topLeft,r=void 0===t||t,n=worldToPixels(this.projectPosition(e),this.pixelProjectionMatrix),a=_slicedToArray(n,2),i=a[0],o=a[1],s=r?o:this.height-o;return 2===e.length?[i,s]:[i,s,n[2]]}},{key:"unproject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.topLeft,n=void 0===r||r,a=t.targetZ,i=_slicedToArray(e,3),o=i[0],s=i[1],u=i[2],c=n?s:this.height-s,l=a&&a*this.pixelsPerMeter,p=pixelsToWorld([o,c,u],this.pixelUnprojectionMatrix,l),f=_slicedToArray(this.unprojectPosition(p),3),h=f[0],d=f[1],_=f[2];return Number.isFinite(u)?[h,d,_]:Number.isFinite(a)?[h,d,a]:[h,d]}},{key:"projectPosition",value:function(e){var t=_slicedToArray(this.projectFlat(e),2);return[t[0],t[1],(e[2]||0)*this.pixelsPerMeter]}},{key:"unprojectPosition",value:function(e){var t=_slicedToArray(this.unprojectFlat(e),2);return[t[0],t[1],(e[2]||0)/this.pixelsPerMeter]}},{key:"projectFlat",value:function(e){return arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale,e}},{key:"unprojectFlat",value:function(e){return arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale,e}}]),e}();function fitBounds(e){var t=e.width,r=e.height,n=e.bounds,a=e.padding,i=void 0===a?0:a,o=e.offset,s=void 0===o?[0,0]:o,u=_slicedToArray(n,2),c=_slicedToArray(u[0],2),l=c[0],p=c[1],f=_slicedToArray(u[1],2),h=f[0],d=f[1];Number.isFinite(i)?i={top:i,bottom:i,left:i,right:i}:assert(Number.isFinite(i.top)&&Number.isFinite(i.bottom)&&Number.isFinite(i.left)&&Number.isFinite(i.right));var _=new WebMercatorViewport({width:t,height:r,longitude:0,latitude:0,zoom:0}),m=_.project([l,d]),y=_.project([h,p]),g=[Math.abs(y[0]-m[0]),Math.abs(y[1]-m[1])],b=[t-i.left-i.right-2*Math.abs(s[0]),r-i.top-i.bottom-2*Math.abs(s[1])];assert(b[0]>0&&b[1]>0);var v=b[0]/g[0],S=b[1]/g[1],O=(i.right-i.left)/2/v,I=(i.bottom-i.top)/2/S,E=[(y[0]+m[0])/2+O,(y[1]+m[1])/2+I],T=_.unproject(E),w=_.zoom+Math.log2(Math.abs(Math.min(v,S)));return{longitude:T[0],latitude:T[1],zoom:w}}var WebMercatorViewport=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.width,a=r.height,i=r.latitude,o=void 0===i?0:i,s=r.longitude,u=void 0===s?0:s,c=r.zoom,l=void 0===c?0:c,p=r.pitch,f=void 0===p?0:p,h=r.bearing,d=void 0===h?0:h,_=r.altitude,m=void 0===_?1.5:_,y=r.nearZMultiplier,g=r.farZMultiplier;_classCallCheck(this,t),n=n||1,a=a||1;var b=zoomToScale(l);m=Math.max(.75,m);var v=lngLatToWorld([u,o],b);v[2]=0;var S=getProjectionMatrix({width:n,height:a,pitch:f,bearing:d,altitude:m,nearZMultiplier:y||1/a,farZMultiplier:g||1.01}),O=getViewMatrix({height:a,center:v,pitch:f,bearing:d,altitude:m,flipY:!0});return(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,{width:n,height:a,viewMatrix:O,projectionMatrix:S}))).latitude=o,e.longitude=u,e.zoom=l,e.pitch=f,e.bearing=d,e.altitude=m,e.scale=b,e.center=v,e.pixelsPerMeter=getDistanceScales(_assertThisInitialized(_assertThisInitialized(e))).pixelsPerMeter[2],Object.freeze(_assertThisInitialized(_assertThisInitialized(e))),e}return _inherits(t,Viewport),_createClass(t,[{key:"projectFlat",value:function(e){return lngLatToWorld(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale)}},{key:"unprojectFlat",value:function(e){return worldToLngLat(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale)}},{key:"getMapCenterByLngLatPosition",value:function(e){var t=e.lngLat,r=pixelsToWorld(e.pos,this.pixelUnprojectionMatrix),n=add([],lngLatToWorld(t,this.scale),negate([],r));return worldToLngLat(add([],this.center,n),this.scale)}},{key:"getLocationAtPoint",value:function(e){var t=e.lngLat,r=e.pos;return this.getMapCenterByLngLatPosition({lngLat:t,pos:r})}},{key:"fitBounds",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.width,a=this.height,i=fitBounds(Object.assign({width:n,height:a,bounds:e},r));return new t({width:n,height:a,longitude:i.longitude,latitude:i.latitude,zoom:i.zoom})}}]),t}(),VESSELS_MINIMUM_RADIUS_FACTOR=.25,VESSELS_MINIMUM_OPACITY=.5,VESSELS_HEATMAP_STYLE_ZOOM_THRESHOLD=6,PLAYBACK_PRECISION=864e5,TIMELINE_OVERALL_START_DATE=new Date(Date.UTC(2012,0,1)),TIMELINE_OVERALL_START_DATE_OFFSET=Math.floor(TIMELINE_OVERALL_START_DATE/PLAYBACK_PRECISION),getTimeAtPrecision=function(e){return Math.floor(e/PLAYBACK_PRECISION)},mapConvert={latLonToWorldCoordinates:function(e,t){return{worldX:(t+180)/360*256,worldY:(1-Math.log(Math.tan(e*Math.PI/180)+1/Math.cos(e*Math.PI/180))/Math.PI)/2*256}},sigmaToRadius:function(e,t,r){var n=t*Math.max(.8,2+Math.log(e*r));return Math.max(VESSELS_MINIMUM_RADIUS_FACTOR,n)},weightToOpacity:function(e,t){var r=3+Math.log(e*t);return r=Math.max(0,r),r=.1+.2*(r=3+Math.log(r)),Math.min(1,Math.max(VESSELS_MINIMUM_OPACITY,r))},getZoomFactorOpacity:function(e){return Math.pow(e-1,3.5)/1e3},getZoomFactorRadiusRenderingMode:function(e){return e<VESSELS_HEATMAP_STYLE_ZOOM_THRESHOLD?.3:.15},getZoomFactorRadius:function(e){return Math.pow(e-1,2.5)},getOffsetedTimeAtPrecision:function(e){return Math.max(0,getTimeAtPrecision(e)-TIMELINE_OVERALL_START_DATE_OFFSET)},getTimestampFromOffsetedtTimeAtPrecision:function(e){return(TIMELINE_OVERALL_START_DATE_OFFSET+e)*PLAYBACK_PRECISION}};function baseAssignValue(e,t,r){"__proto__"==t&&_defineProperty?_defineProperty(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var _baseAssignValue=baseAssignValue,objectProto$a=Object.prototype,hasOwnProperty$8=objectProto$a.hasOwnProperty;function assignValue(e,t,r){var n=e[t];hasOwnProperty$8.call(e,t)&&eq_1(n,r)&&(void 0!==r||t in e)||_baseAssignValue(e,t,r)}var _assignValue=assignValue;function copyObject(e,t,r,n){var a=!r;r||(r={});for(var i=-1,o=t.length;++i<o;){var s=t[i],u=n?n(r[s],e[s],s,r,e):void 0;void 0===u&&(u=e[s]),a?_baseAssignValue(r,s,u):_assignValue(r,s,u)}return r}var _copyObject=copyObject;function isIterateeCall(e,t,r){if(!Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.b)(r))return!1;var n=typeof t;return!!("number"==n?isArrayLike_1(r)&&_isIndex(t,r.length):"string"==n&&t in r)&&eq_1(r[t],e)}var _isIterateeCall=isIterateeCall;function createAssigner(e){return _baseRest(function(t,r){var n=-1,a=r.length,i=a>1?r[a-1]:void 0,o=a>2?r[2]:void 0;for(i=e.length>3&&"function"==typeof i?(a--,i):void 0,o&&_isIterateeCall(r[0],r[1],o)&&(i=a<3?void 0:i,a=1),t=Object(t);++n<a;){var s=r[n];s&&e(t,s,n,i)}return t})}var _createAssigner=createAssigner;function nativeKeysIn(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}var _nativeKeysIn=nativeKeysIn,objectProto$b=Object.prototype,hasOwnProperty$9=objectProto$b.hasOwnProperty;function baseKeysIn(e){if(!Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.b)(e))return _nativeKeysIn(e);var t=_isPrototype(e),r=[];for(var n in e)("constructor"!=n||!t&&hasOwnProperty$9.call(e,n))&&r.push(n);return r}var _baseKeysIn=baseKeysIn;function keysIn(e){return isArrayLike_1(e)?_arrayLikeKeys(e,!0):_baseKeysIn(e)}var keysIn_1=keysIn,assignInWith=_createAssigner(function(e,t,r,n){_copyObject(t,keysIn_1(t),e,n)}),assignInWith_1=assignInWith,getPrototype=_overArg(Object.getPrototypeOf,Object),_getPrototype=getPrototype,objectTag$3="[object Object]",funcProto$2=Function.prototype,objectProto$c=Object.prototype,funcToString$2=funcProto$2.toString,hasOwnProperty$a=objectProto$c.hasOwnProperty,objectCtorString=funcToString$2.call(Object);function isPlainObject(e){if(!Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.e)(e)||Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.c)(e)!=objectTag$3)return!1;var t=_getPrototype(e);if(null===t)return!0;var r=hasOwnProperty$a.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&funcToString$2.call(r)==objectCtorString}var isPlainObject_1=isPlainObject,domExcTag="[object DOMException]",errorTag$2="[object Error]";function isError(e){if(!Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.e)(e))return!1;var t=Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.c)(e);return t==errorTag$2||t==domExcTag||"string"==typeof e.message&&"string"==typeof e.name&&!isPlainObject_1(e)}var isError_1=isError,attempt=_baseRest(function(e,t){try{return _apply(e,void 0,t)}catch(e){return isError_1(e)?e:new Error(e)}}),attempt_1=attempt;function baseValues(e,t){return _arrayMap(t,function(t){return e[t]})}var _baseValues=baseValues,objectProto$d=Object.prototype,hasOwnProperty$b=objectProto$d.hasOwnProperty;function customDefaultsAssignIn(e,t,r,n){return void 0===e||eq_1(e,objectProto$d[r])&&!hasOwnProperty$b.call(n,r)?t:e}var _customDefaultsAssignIn=customDefaultsAssignIn,stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function escapeStringChar(e){return"\\"+stringEscapes[e]}var _escapeStringChar=escapeStringChar,reInterpolate=/<%=([\s\S]+?)%>/g,_reInterpolate=reInterpolate;function basePropertyOf(e){return function(t){return null==e?void 0:e[t]}}var _basePropertyOf=basePropertyOf,htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},escapeHtmlChar=_basePropertyOf(htmlEscapes),_escapeHtmlChar=escapeHtmlChar,reUnescapedHtml=/[&<>"']/g,reHasUnescapedHtml=RegExp(reUnescapedHtml.source);function escape(e){return(e=toString_1(e))&&reHasUnescapedHtml.test(e)?e.replace(reUnescapedHtml,_escapeHtmlChar):e}var _escape=escape,reEscape=/<%-([\s\S]+?)%>/g,_reEscape=reEscape,reEvaluate=/<%([\s\S]+?)%>/g,_reEvaluate=reEvaluate,templateSettings={escape:_reEscape,evaluate:_reEvaluate,interpolate:_reInterpolate,variable:"",imports:{_:{escape:_escape}}},templateSettings_1=templateSettings,reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g,reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,reNoMatch=/($^)/,reUnescapedString=/['\n\r\u2028\u2029\\]/g;function template(e,t,r){var n=templateSettings_1.imports._.templateSettings||templateSettings_1;r&&_isIterateeCall(e,t,r)&&(t=void 0),e=toString_1(e),t=assignInWith_1({},t,n,_customDefaultsAssignIn);var a,i,o=assignInWith_1({},t.imports,n.imports,_customDefaultsAssignIn),s=keys_1(o),u=_baseValues(o,s),c=0,l=t.interpolate||reNoMatch,p="__p += '",f=RegExp((t.escape||reNoMatch).source+"|"+l.source+"|"+(l===_reInterpolate?reEsTemplate:reNoMatch).source+"|"+(t.evaluate||reNoMatch).source+"|$","g"),h="sourceURL"in t?"//# sourceURL="+t.sourceURL+"\n":"";e.replace(f,function(t,r,n,o,s,u){return n||(n=o),p+=e.slice(c,u).replace(reUnescapedString,_escapeStringChar),r&&(a=!0,p+="' +\n__e("+r+") +\n'"),s&&(i=!0,p+="';\n"+s+";\n__p += '"),n&&(p+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),c=u+t.length,t}),p+="';\n";var d=t.variable;d||(p="with (obj) {\n"+p+"\n}\n"),p=(i?p.replace(reEmptyStringLeading,""):p).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;"),p="function("+(d||"obj")+") {\n"+(d?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var _=attempt_1(function(){return Function(s,h+"return "+p).apply(void 0,u)});if(_.source=p,isError_1(_))throw _;return _}var template_1=template,buildEndpoint=function(e,t){return templateSettings_1.interpolate=/{{([\s\S]+?)}}/g,template_1(e)(t)},byname={Uint8:{size:Uint8Array.BYTES_PER_ELEMENT,array:"Float32Array",getter:"getUint8",setter:"setUint8"},Int8:{size:Int8Array.BYTES_PER_ELEMENT,array:"Float32Array",getter:"getUint8",setter:"setUint8"},Uint16:{size:Uint16Array.BYTES_PER_ELEMENT,array:"Float32Array",getter:"getUint16",setter:"setUint16"},Int16:{size:Int16Array.BYTES_PER_ELEMENT,array:"Float32Array",getter:"getInt16",setter:"setInt16"},Uint32:{size:Uint32Array.BYTES_PER_ELEMENT,array:"Float32Array",getter:"getUint32",setter:"setUint32"},Int32:{size:Int32Array.BYTES_PER_ELEMENT,array:"Float32Array",getter:"getInt32",setter:"setInt32"},Float32:{size:Float32Array.BYTES_PER_ELEMENT,array:"Float32Array",getter:"getFloat32",setter:"setFloat32"},Float64:{size:Float64Array.BYTES_PER_ELEMENT,array:"Float64Array",getter:"getFloat64",setter:"setFloat64"}},writeStringToArrayBuffer=function(e,t,r,n,a){null==r&&(r=e.length),null==t&&(t=0),null==a&&(a=t);for(var i=t;i<r;i++)n[i-t+a]=255&e.charCodeAt(i)},stringToArrayBuffer=function(e,t,r){null==r&&(r=e.length),null==t&&(t=0);var n=new Uint8ClampedArray(r-t);return writeStringToArrayBuffer(e,t,r,n,0),n.buffer},arrayBufferToString=function(e){return String.fromCharCode.apply(null,new Uint8Array(e))},pack=function(e,t,r){var n=new ArrayBuffer(e.size);return new DataView(n)[e.setter](0,t,r),arrayBufferToString(n)},Pack={typemap:{byname:byname,byarray:{}},pack:pack,arrayBufferToString:arrayBufferToString,stringToArrayBuffer:stringToArrayBuffer,writeStringToArrayBuffer:writeStringToArrayBuffer};for(var name in Pack.typemap.byname){var spec=Pack.typemap.byname[name];spec.name=name,Pack.typemap.byarray[spec.array]=spec}var PelagosClient=function(){function PelagosClient(){Object(_chunk_4036bba0_js__WEBPACK_IMPORTED_MODULE_0__.d)(this,PelagosClient),this.MAGIC_COOKIE="tmtx"}return Object(_chunk_4036bba0_js__WEBPACK_IMPORTED_MODULE_0__.g)(PelagosClient,[{key:"obtainTile",value:function(e,t){return new Promise(function(r,n){if(this.request=null,"undefined"==typeof XMLHttpRequest)throw"XMLHttpRequest is disabled";this.request=new XMLHttpRequest,this.resolve=r,this.reject=n,this.request.open("GET",e,!0),t&&this.request.setRequestHeader("Authorization","Bearer ".concat(t)),this.request.responseType="arraybuffer",this.request.onload=this.handleData.bind(this),this.request.onerror=this.handleData.bind(this),this.request.send(null)}.bind(this))}},{key:"handleData",value:function handleData(){var self=this;if(this.request){if(this.error)return!0;if(4==this.request.readyState){var success=200==this.request.status||this.isFileUri&&0==this.request.status;if(!success)return void this.resolve(null)}if(this.request.response){var length=this.request.response.byteLength,response=this.request.response,dataView=new DataView(response);if(!(length<8)){if(null==self.headerLen){var cookie=Pack.arrayBufferToString(response.slice(0,4));if(cookie!=this.MAGIC_COOKIE)return void this.reject("Could not load "+this.url+" due to incorrect file format. Cookie: ["+this.cookie+"]");self.headerLen=dataView.getInt32(4,!0),self.offset=8}if(!(length<self.offset+self.headerLen)){if(!self.headerIsLoaded){self.header=JSON.parse(Pack.arrayBufferToString(response.slice(self.offset,self.offset+self.headerLen))),self.rowLen=0,self.header.colsByName={};for(var colidx=0;colidx<self.header.cols.length;colidx++){var col=self.header.cols[colidx];col.idx=colidx,self.header.colsByName[col.name]=col,col.typespec=Pack.typemap.byname[col.type],null!=col.multiplier&&null!=col.min&&(col.min=col.min*col.multiplier),null!=col.offset&&null!=col.min&&(col.min=col.min+col.offset),null!=col.multiplier&&null!=col.max&&(col.max=col.max*col.multiplier),null!=col.offset&&null!=col.max&&(col.max=col.max+col.offset),self.rowLen+=col.typespec.size}if(self.offset+=self.headerLen,self.offset+=(4-self.headerLen%4)%4,self.headerIsLoaded=!0,"rowwise"!=self.header.orientation&&"columnwise"!=self.header.orientation)return self.errorLoading({orientation:self.header.orientation,toString:function(){return"Could not load "+this.url+" due to unsupported file orientation. Orientation: "+this.orientation+". Supported orientations: rowwise, columnwise."}}),!0;if(!self.rowLen)return self.allLoaded(),!0}if("rowwise"==self.header.orientation){for(var result={};self.offset+self.rowLen<=length;self.rowidx++){for(var row={},colidx=0;colidx<self.header.cols.length;colidx++){var col=self.header.cols[colidx],val=dataView[col.typespec.getter](self.offset,!0);row[col.name]=val,self.offset+=col.typespec.size}result[col.name]=row}self.rowidx==self.header.length&&this.resolve(result)}else if("columnwise"==self.header.orientation){var colValues=null,result={};if(length>=self.offset+self.header.length*self.rowLen){for(var colidx=0;colidx<self.header.cols.length;colidx++){var col=self.header.cols[colidx];colValues=new(eval(col.typespec.array))(response.slice(self.offset,self.offset+col.typespec.size*self.header.length)),self.offset+=self.header.length*col.typespec.size,result[col.name]=colValues}return this.resolve(result),!0}}}}}}}}]),PelagosClient}(),read=function(e,t,r,n,a){var i,o,s=8*a-n-1,u=(1<<s)-1,c=u>>1,l=-7,p=r?a-1:0,f=r?-1:1,h=e[t+p];for(p+=f,i=h&(1<<-l)-1,h>>=-l,l+=s;l>0;i=256*i+e[t+p],p+=f,l-=8);for(o=i&(1<<-l)-1,i>>=-l,l+=n;l>0;o=256*o+e[t+p],p+=f,l-=8);if(0===i)i=1-c;else{if(i===u)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,n),i-=c}return(h?-1:1)*o*Math.pow(2,i-n)},write=function(e,t,r,n,a,i){var o,s,u,c=8*i-a-1,l=(1<<c)-1,p=l>>1,f=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:i-1,d=n?1:-1,_=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),(t+=o+p>=1?f/u:f*Math.pow(2,1-p))*u>=2&&(o++,u/=2),o+p>=l?(s=0,o=l):o+p>=1?(s=(t*u-1)*Math.pow(2,a),o+=p):(s=t*Math.pow(2,p-1)*Math.pow(2,a),o=0));a>=8;e[r+h]=255&s,h+=d,s/=256,a-=8);for(o=o<<a|s,c+=a;c>0;e[r+h]=255&o,h+=d,o/=256,c-=8);e[r+h-d]|=128*_},ieee754={read:read,write:write},pbf=Pbf;function Pbf(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Pbf.Varint=0,Pbf.Fixed64=1,Pbf.Bytes=2,Pbf.Fixed32=5;var SHIFT_LEFT_32=4294967296,SHIFT_RIGHT_32=1/SHIFT_LEFT_32;function readVarintRemainder(e,t,r){var n,a,i=r.buf;if(n=(112&(a=i[r.pos++]))>>4,a<128)return toNum(e,n,t);if(n|=(127&(a=i[r.pos++]))<<3,a<128)return toNum(e,n,t);if(n|=(127&(a=i[r.pos++]))<<10,a<128)return toNum(e,n,t);if(n|=(127&(a=i[r.pos++]))<<17,a<128)return toNum(e,n,t);if(n|=(127&(a=i[r.pos++]))<<24,a<128)return toNum(e,n,t);if(n|=(1&(a=i[r.pos++]))<<31,a<128)return toNum(e,n,t);throw new Error("Expected varint not more than 10 bytes")}function readPackedEnd(e){return e.type===Pbf.Bytes?e.readVarint()+e.pos:e.pos+1}function toNum(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function writeBigVarint(e,t){var r,n;if(e>=0?(r=e%4294967296|0,n=e/4294967296|0):(n=~(-e/4294967296),4294967295^(r=~(-e%4294967296))?r=r+1|0:(r=0,n=n+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),writeBigVarintLow(r,n,t),writeBigVarintHigh(n,t)}function writeBigVarintLow(e,t,r){r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos]=127&e}function writeBigVarintHigh(e,t){var r=(7&e)<<4;t.buf[t.pos++]|=r|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}function makeRoomForExtraLength(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(n);for(var a=r.pos-1;a>=e;a--)r.buf[a+n]=r.buf[a]}function _writePackedVarint(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function _writePackedSVarint(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function _writePackedFloat(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function _writePackedDouble(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function _writePackedBoolean(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function _writePackedFixed(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function _writePackedSFixed(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function _writePackedFixed2(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function _writePackedSFixed2(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function readUInt32(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function writeInt32(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function readInt32(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function readUtf8(e,t,r){for(var n="",a=t;a<r;){var i,o,s,u=e[a],c=null,l=u>239?4:u>223?3:u>191?2:1;if(a+l>r)break;1===l?u<128&&(c=u):2===l?128==(192&(i=e[a+1]))&&(c=(31&u)<<6|63&i)<=127&&(c=null):3===l?(i=e[a+1],o=e[a+2],128==(192&i)&&128==(192&o)&&((c=(15&u)<<12|(63&i)<<6|63&o)<=2047||c>=55296&&c<=57343)&&(c=null)):4===l&&(i=e[a+1],o=e[a+2],s=e[a+3],128==(192&i)&&128==(192&o)&&128==(192&s)&&((c=(15&u)<<18|(63&i)<<12|(63&o)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,l=1):c>65535&&(c-=65536,n+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),n+=String.fromCharCode(c),a+=l}return n}function writeUtf8(e,t,r){for(var n,a,i=0;i<t.length;i++){if((n=t.charCodeAt(i))>55295&&n<57344){if(!a){n>56319||i+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):a=n;continue}if(n<56320){e[r++]=239,e[r++]=191,e[r++]=189,a=n;continue}n=a-55296<<10|n-56320|65536,a=null}else a&&(e[r++]=239,e[r++]=191,e[r++]=189,a=null);n<128?e[r++]=n:(n<2048?e[r++]=n>>6|192:(n<65536?e[r++]=n>>12|224:(e[r++]=n>>18|240,e[r++]=n>>12&63|128),e[r++]=n>>6&63|128),e[r++]=63&n|128)}return r}Pbf.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),a=n>>3,i=this.pos;this.type=7&n,e(a,t,this),this.pos===i&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=readUInt32(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=readInt32(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=readUInt32(this.buf,this.pos)+readUInt32(this.buf,this.pos+4)*SHIFT_LEFT_32;return this.pos+=8,e},readSFixed64:function(){var e=readUInt32(this.buf,this.pos)+readInt32(this.buf,this.pos+4)*SHIFT_LEFT_32;return this.pos+=8,e},readFloat:function(){var e=ieee754.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=ieee754.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,n=this.buf;return t=127&(r=n[this.pos++]),r<128?t:(t|=(127&(r=n[this.pos++]))<<7,r<128?t:(t|=(127&(r=n[this.pos++]))<<14,r<128?t:(t|=(127&(r=n[this.pos++]))<<21,r<128?t:readVarintRemainder(t|=(15&(r=n[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=readUtf8(this.buf,this.pos,e);return this.pos=e,t},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Pbf.Bytes)return e.push(this.readVarint(t));var r=readPackedEnd(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readSVarint());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readBoolean());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readFloat());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readDouble());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readFixed32());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readSFixed32());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readFixed64());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Pbf.Bytes)return e.push(this.readSFixed64());var t=readPackedEnd(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Pbf.Varint)for(;this.buf[this.pos++]>127;);else if(t===Pbf.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Pbf.Fixed32)this.pos+=4;else{if(t!==Pbf.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),writeInt32(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),writeInt32(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),writeInt32(this.buf,-1&e,this.pos),writeInt32(this.buf,Math.floor(e*SHIFT_RIGHT_32),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),writeInt32(this.buf,-1&e,this.pos),writeInt32(this.buf,Math.floor(e*SHIFT_RIGHT_32),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?writeBigVarint(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=writeUtf8(this.buf,e,this.pos);var r=this.pos-t;r>=128&&makeRoomForExtraLength(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),ieee754.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),ieee754.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&makeRoomForExtraLength(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,r){this.writeTag(e,Pbf.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,_writePackedVarint,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,_writePackedSVarint,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,_writePackedBoolean,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,_writePackedFloat,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,_writePackedDouble,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,_writePackedFixed,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,_writePackedSFixed,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,_writePackedFixed2,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,_writePackedSFixed2,t)},writeBytesField:function(e,t){this.writeTag(e,Pbf.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Pbf.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Pbf.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Pbf.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Pbf.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Pbf.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Pbf.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Pbf.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Pbf.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Pbf.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var pointGeometry=Point;function Point(e,t){this.x=e,this.y=t}Point.prototype={clone:function(){return new Point(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,a=r*this.x+t*this.y;return this.x=n,this.y=a,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),a=t.x+r*(this.x-t.x)-n*(this.y-t.y),i=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=a,this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Point.convert=function(e){return e instanceof Point?e:Array.isArray(e)?new Point(e[0],e[1]):e};var vectortilefeature=VectorTileFeature;function VectorTileFeature(e,t,r,n,a){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=a,e.readFields(readFeature,this,t)}function readFeature(e,t,r){1==e?t.id=r.readVarint():2==e?readTag(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function readTag(e,t){for(var r=e.readVarint()+e.pos;e.pos<r;){var n=t._keys[e.readVarint()],a=t._values[e.readVarint()];t.properties[n]=a}}function classifyRings(e){var t=e.length;if(t<=1)return[e];for(var r,n,a=[],i=0;i<t;i++){var o=signedArea(e[i]);0!==o&&(void 0===n&&(n=o<0),n===o<0?(r&&a.push(r),r=[e[i]]):r.push(e[i]))}return r&&a.push(r),a}function signedArea(e){for(var t,r,n=0,a=0,i=e.length,o=i-1;a<i;o=a++)t=e[a],n+=((r=e[o]).x-t.x)*(t.y+r.y);return n}VectorTileFeature.types=["Unknown","Point","LineString","Polygon"],VectorTileFeature.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,n=1,a=0,i=0,o=0,s=[];e.pos<r;){if(a<=0){var u=e.readVarint();n=7&u,a=u>>3}if(a--,1===n||2===n)i+=e.readSVarint(),o+=e.readSVarint(),1===n&&(t&&s.push(t),t=[]),t.push(new pointGeometry(i,o));else{if(7!==n)throw new Error("unknown command "+n);t&&t.push(t[0].clone())}}return t&&s.push(t),s},VectorTileFeature.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,a=0,i=0,o=1/0,s=-1/0,u=1/0,c=-1/0;e.pos<t;){if(n<=0){var l=e.readVarint();r=7&l,n=l>>3}if(n--,1===r||2===r)(a+=e.readSVarint())<o&&(o=a),a>s&&(s=a),(i+=e.readSVarint())<u&&(u=i),i>c&&(c=i);else if(7!==r)throw new Error("unknown command "+r)}return[o,u,s,c]},VectorTileFeature.prototype.toGeoJSON=function(e,t,r){var n,a,i=this.extent*Math.pow(2,r),o=this.extent*e,s=this.extent*t,u=this.loadGeometry(),c=VectorTileFeature.types[this.type];function l(e){for(var t=0;t<e.length;t++){var r=e[t],n=180-360*(r.y+s)/i;e[t]=[360*(r.x+o)/i-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(n=0;n<u.length;n++)p[n]=u[n][0];l(u=p);break;case 2:for(n=0;n<u.length;n++)l(u[n]);break;case 3:for(u=classifyRings(u),n=0;n<u.length;n++)for(a=0;a<u[n].length;a++)l(u[n][a])}1===u.length?u=u[0]:c="Multi"+c;var f={type:"Feature",geometry:{type:c,coordinates:u},properties:this.properties};return"id"in this&&(f.id=this.id),f};var vectortilelayer=VectorTileLayer;function VectorTileLayer(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(readLayer,this,t),this.length=this._features.length}function readLayer(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(readValueMessage(r))}function readValueMessage(e){for(var t=null,r=e.readVarint()+e.pos;e.pos<r;){var n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}return t}VectorTileLayer.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new vectortilefeature(this._pbf,t,this.extent,this._keys,this._values)};var vectortile=VectorTile;function VectorTile(e,t){this.layers=e.readFields(readTile,{},t)}function readTile(e,t,r){if(3===e){var n=new vectortilelayer(r,r.readVarint()+r.pos);n.length&&(t[n.name]=n)}}var VectorTile$1=vectortile,getPBFTile=function(e,t){return fetch(e,{headers:t?{Authorization:"Bearer ".concat(t)}:{}}).then(function(t){if(!t.ok)throw new Error("could not load tile ".concat(e));return t.blob().then(function(e){var t=new FileReader;return new Promise(function(r){t.addEventListener("loadend",function(){var e=new pbf(t.result),n=new VectorTile$1(e);return r(n)}),t.readAsArrayBuffer(e)})})}).catch(function(e){console.warn(e)})},getTemporalTileURLs=function(e,t,r){var n=[];return(t||[null]).forEach(function(t,a){var i={id:r.seriesgroup};null!==t&&!0!==r.temporalExtentsLess&&(i.startTimeISO=new Date(t[0]).toISOString(),i.endTimeISO=new Date(t[1]).toISOString()),r.tileCoordinates&&(i.x=r.tileCoordinates.x,i.y=r.tileCoordinates.y,i.z=r.tileCoordinates.zoom);var o=buildEndpoint(e,i);(!0===r.temporalExtentsLess||!r.temporalExtentsIndices||r.temporalExtentsIndices.indexOf(a)>-1)&&n.push(o)}),n},getTilePromises=function(e,t,r,n){for(var a=[],i=getTemporalTileURLs(e,r,n),o=0,s=i.length;o<s;o++)!0===n.isPBF?a.push(getPBFTile(i[o],t)):a.push((new PelagosClient).obtainTile(i[o],t));return a},getCleanVectorArrays=function(e){return e.filter(function(e){return null!==e})},groupData=function(e,t){var r,n={},a=sumBy_1(e,function(e){return e.longitude.length}),i=t.filter(function(t){return!e[0]||void 0!==e[0][t]||(console.warn("column ".concat(t," is present in layerHeader.colsByName but not in tile data")),!1)});i.forEach(function(e){n[e]=new Float32Array(a)});for(var o=0,s=function(e){n[e].set(r[e],o)},u=0,c=e.length;u<c;u++)r=e[u],i.forEach(s),o+=r.longitude.length;return n},getTilePlaybackData=function(e,t,r,n,a){var i=void 0===a?[]:a,o=r.zoom,s=mapConvert.getZoomFactorRadius(o),u=mapConvert.getZoomFactorRadiusRenderingMode(o),c=mapConvert.getZoomFactorOpacity(o),l={},p=Object.keys(t);p.forEach(function(e){l[e]=!0});var f=[].concat(p);!0===l.sigma&&f.push("radius"),!0===l.weight&&f.push("opacity"),!0===l.longitude&&(f.push("worldX"),f.push("worldY")),!0===l.id&&f.push("series"),["latitude","longitude","datetime"].forEach(function(e){void 0!==t[e]&&!0!==t[e].hidden||pull_1(f,e)}),pull_1(f,"sigma","weight"),f=uniq_1(f);for(var h=function(t,a){var h=void 0;if(!0===n){var d=e.feature(t);h=d.properties;var _=d.toGeoJSON(r.x,r.y,o).geometry.coordinates;h.longitude=_[0],h.latitude=_[1]}else h={},p.forEach(function(r){h[r]=e[r][t]});var m=l.timeIndex?h.timeIndex:mapConvert.getOffsetedTimeAtPrecision(h.datetime),y=lngLatToWorld([h.longitude,h.latitude],1),g=Object(_chunk_4036bba0_js__WEBPACK_IMPORTED_MODULE_0__.h)(y,2),b=g[0],v=g[1];if(h.worldX=b,h.worldY=v,l.sigma&&(h.radius=mapConvert.sigmaToRadius(h.sigma,u,s)),l.weight&&(h.opacity=mapConvert.weightToOpacity(h.weight,c)),l.id&&(h.series=h.id),!i[m]){var S={};return f.forEach(function(e){S[e]=[h[e]]}),i[m]=S,"continue"}var O=i[m];f.forEach(function(e){O[e].push(h[e])})},d=0,_=!0===n?e.length:e.latitude.length;d<_;d++)h(d);return i},addTracksPointsRenderingData=function(e){e.hasFishing=[],e.worldX=[],e.worldY=[];for(var t=0,r=e.weight.length;t<r;t++){var n=lngLatToWorld([e.longitude[t],e.latitude[t]],1),a=Object(_chunk_4036bba0_js__WEBPACK_IMPORTED_MODULE_0__.h)(n,2),i=a[0],o=a[1];e.worldX[t]=i,e.worldY[t]=o,e.hasFishing[t]=e.weight[t]>0}return e},getTracksPlaybackData=function(e){for(var t=[],r=0,n=e.series.length;r<n;r++){var a=e.datetime[r],i=mapConvert.getOffsetedTimeAtPrecision(a);if(t[i]){var o=t[i];o.worldX.push(e.worldX[r]),o.worldY.push(e.worldY[r]),o.series.push(e.series[r]),o.hasFishing.push(e.hasFishing[r])}else{var s={worldX:[e.worldX[r]],worldY:[e.worldY[r]],series:[e.series[r]],hasFishing:[e.hasFishing[r]]};t[i]=s}}return t},vesselSatisfiesFilters=function(e,t,r){return Object.keys(r).every(function(n){return void 0!==e[n]&&r[n].indexOf(e[n][t])>-1})},vesselSatisfiesAllFilters=function(e,t,r){return r.filter(function(e){return!0!==e.pass}).some(function(r){return vesselSatisfiesFilters(e,t,r.filterValues)})},selectVesselsAt=function(e,t,r,n,a){for(var i=[],o=t.worldX,s=t.worldY,u=t.toleranceRadiusInWorldUnits,c=function(t){var r=e[t];if(void 0===r)return"continue";for(var n=function(e){var t=r.worldX[e],n=r.worldY[e];if((!a.length||vesselSatisfiesAllFilters(r,e,a))&&t>=o-u&&t<=o+u&&n>=s-u&&n<=s+u){var c={};Object.keys(r).forEach(function(t){c[t]=r[t][e]}),i.push(c)}},c=0;c<r.worldX.length;c++)n(c)},l=r;l<n;l++)c(l);return i},d2r=Math.PI/180,r2d=180/Math.PI;function tileToBBOX(e){var t=tile2lon(e[0]+1,e[2]);return[tile2lon(e[0],e[2]),tile2lat(e[1]+1,e[2]),t,tile2lat(e[1],e[2])]}function tileToGeoJSON(e){var t=tileToBBOX(e);return{type:"Polygon",coordinates:[[[t[0],t[1]],[t[0],t[3]],[t[2],t[3]],[t[2],t[1]],[t[0],t[1]]]]}}function tile2lon(e,t){return e/Math.pow(2,t)*360-180}function tile2lat(e,t){var r=Math.PI-2*Math.PI*e/Math.pow(2,t);return r2d*Math.atan(.5*(Math.exp(r)-Math.exp(-r)))}function pointToTile(e,t,r){var n=pointToTileFraction(e,t,r);return n[0]=Math.floor(n[0]),n[1]=Math.floor(n[1]),n}function getChildren(e){return[[2*e[0],2*e[1],e[2]+1],[2*e[0]+1,2*e[1],e[2]+1],[2*e[0]+1,2*e[1]+1,e[2]+1],[2*e[0],2*e[1]+1,e[2]+1]]}function getParent(e){return e[0]%2==0&&e[1]%2==0?[e[0]/2,e[1]/2,e[2]-1]:e[0]%2==0&&!e[1]%2==0?[e[0]/2,(e[1]-1)/2,e[2]-1]:!e[0]%2==0&&e[1]%2==0?[(e[0]-1)/2,e[1]/2,e[2]-1]:[(e[0]-1)/2,(e[1]-1)/2,e[2]-1]}function getSiblings(e){return getChildren(getParent(e))}function hasSiblings(e,t){for(var r=getSiblings(e),n=0;n<r.length;n++)if(!hasTile(t,r[n]))return!1;return!0}function hasTile(e,t){for(var r=0;r<e.length;r++)if(tilesEqual(e[r],t))return!0;return!1}function tilesEqual(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function tileToQuadkey(e){for(var t="",r=e[2];r>0;r--){var n=0,a=1<<r-1;0!=(e[0]&a)&&n++,0!=(e[1]&a)&&(n+=2),t+=n.toString()}return t}function quadkeyToTile(e){for(var t=0,r=0,n=e.length,a=n;a>0;a--){var i=1<<a-1,o=+e[n-a];1===o&&(t|=i),2===o&&(r|=i),3===o&&(t|=i,r|=i)}return[t,r,n]}function bboxToTile(e){var t=pointToTile(e[0],e[1],32),r=pointToTile(e[2],e[3],32),n=[t[0],t[1],r[0],r[1]],a=getBboxZoom(n);return 0===a?[0,0,0]:[n[0]>>>32-a,n[1]>>>32-a,a]}function getBboxZoom(e){for(var t=0;t<28;t++){var r=1<<32-(t+1);if((e[0]&r)!=(e[2]&r)||(e[1]&r)!=(e[3]&r))return t}return 28}function pointToTileFraction(e,t,r){var n=Math.sin(t*d2r),a=Math.pow(2,r);return[a*(e/360+.5),a*(.5-.25*Math.log((1+n)/(1-n))/Math.PI),r]}var tilebelt={tileToGeoJSON:tileToGeoJSON,tileToBBOX:tileToBBOX,getChildren:getChildren,getParent:getParent,getSiblings:getSiblings,hasTile:hasTile,hasSiblings:hasSiblings,tilesEqual:tilesEqual,tileToQuadkey:tileToQuadkey,quadkeyToTile:quadkeyToTile,pointToTile:pointToTile,bboxToTile:bboxToTile,pointToTileFraction:pointToTileFraction},geojson=function(e,t){return{type:"FeatureCollection",features:getTiles(e,t).map(tileToFeature)}};function tileToFeature(e){return{type:"Feature",geometry:tilebelt.tileToGeoJSON(e),properties:{}}}var tiles=getTiles,indexes=function(e,t){return getTiles(e,t).map(tilebelt.tileToQuadkey)};function getTiles(e,t){var r,n,a=e.coordinates,i=t.max_zoom,o={},s=[];if("Point"===e.type)return[tilebelt.pointToTile(a[0],a[1],i)];if("MultiPoint"===e.type)for(r=0;r<a.length;r++)o[toID((n=tilebelt.pointToTile(a[r][0],a[r][1],i))[0],n[1],n[2])]=!0;else if("LineString"===e.type)lineCover(o,a,i);else if("MultiLineString"===e.type)for(r=0;r<a.length;r++)lineCover(o,a[r],i);else if("Polygon"===e.type)polygonCover(o,s,a,i);else{if("MultiPolygon"!==e.type)throw new Error("Geometry type not implemented");for(r=0;r<a.length;r++)polygonCover(o,s,a[r],i)}if(t.min_zoom!==i){var u=s.length;for(appendHashTiles(o,s),r=0;r<u;r++){var c=s[r];o[toID(c[0],c[1],c[2])]=!0}return mergeTiles(o,s,t)}return appendHashTiles(o,s),s}function mergeTiles(e,t,r){for(var n=[],a=r.max_zoom;a>r.min_zoom;a--){for(var i={},o=[],s=0;s<t.length;s++){var u=t[s];if(u[0]%2==0&&u[1]%2==0){var c=toID(u[0]+1,u[1],a),l=toID(u[0],u[1]+1,a),p=toID(u[0]+1,u[1]+1,a);if(e[c]&&e[l]&&e[p]){e[toID(u[0],u[1],u[2])]=!1,e[c]=!1,e[l]=!1,e[p]=!1;var f=[u[0]/2,u[1]/2,a-1];a-1===r.min_zoom?n.push(f):(i[toID(u[0]/2,u[1]/2,a-1)]=!0,o.push(f))}}}for(s=0;s<t.length;s++)e[toID((u=t[s])[0],u[1],u[2])]&&n.push(u);e=i,t=o}return n}function polygonCover(e,t,r,n){for(var a=[],i=0;i<r.length;i++){var o=[];lineCover(e,r[i],n,o);for(var s=0,u=o.length,c=u-1;s<u;c=s++){var l=(s+1)%u,p=o[s][1];(p>o[c][1]||p>o[l][1])&&(p<o[c][1]||p<o[l][1])&&p!==o[l][1]&&a.push(o[s])}}for(a.sort(compareTiles),i=0;i<a.length;i+=2){p=a[i][1];for(var f=a[i][0]+1;f<a[i+1][0];f++)e[toID(f,p,n)]||t.push([f,p,n])}}function compareTiles(e,t){return e[1]-t[1]||e[0]-t[0]}function lineCover(e,t,r,n){for(var a,i,o=0;o<t.length-1;o++){var s=tilebelt.pointToTileFraction(t[o][0],t[o][1],r),u=tilebelt.pointToTileFraction(t[o+1][0],t[o+1][1],r),c=s[0],l=s[1],p=u[0]-c,f=u[1]-l;if(0!==f||0!==p){var h=p>0?1:-1,d=f>0?1:-1,_=Math.floor(c),m=Math.floor(l),y=0===p?1/0:Math.abs(((p>0?1:0)+_-c)/p),g=0===f?1/0:Math.abs(((f>0?1:0)+m-l)/f),b=Math.abs(h/p),v=Math.abs(d/f);for(_===a&&m===i||(e[toID(_,m,r)]=!0,n&&m!==i&&n.push([_,m]),a=_,i=m);y<1||g<1;)y<g?(y+=b,_+=h):(g+=v,m+=d),e[toID(_,m,r)]=!0,n&&m!==i&&n.push([_,m]),a=_,i=m}}n&&m===n[0][1]&&n.pop()}function appendHashTiles(e,t){for(var r=Object.keys(e),n=0;n<r.length;n++)t.push(fromID(+r[n]))}function toID(e,t,r){return 32*(2*(1<<r)*t+e)+r}function fromID(e){var t=e%32,r=2*(1<<t),n=(e-t)/32,a=n%r;return[a,(n-a)/r%r,t]}var tileCover={geojson:geojson,tiles:tiles,indexes:indexes},SET_CURRENTLY_VISIBLE_TILES="SET_CURRENTLY_VISIBLE_TILES",SET_CURRENTLY_LOADED_TILES="SET_CURRENTLY_LOADED_TILES",SET_CURRENTLY_SWAPPED_TILE_UIDS="SET_CURRENTLY_SWAPPED_TILE_UIDS",MARK_TILES_UIDS_AS_LOADED="MARK_TILES_UIDS_AS_LOADED",RELEASE_MARKED_TILES_UIDS="RELEASE_MARKED_TILES_UIDS",getTilecoverLimits=function(e){var t=Math.ceil(e+TILES_LOAD_ZOOM_OFFSET),r=!0;return t>ACTIVITY_LAYERS_MAX_ZOOM_LEVEL_TILE_LOADING&&(t=ACTIVITY_LAYERS_MAX_ZOOM_LEVEL_TILE_LOADING,r=!1),{min_zoom:t,max_zoom:t,tilesAvailable:r}},flushToReleaseTiles=function(){return function(e,t){var r=t();if(!r.map.heatmapTiles.currentToLoadTileUids.length){var n=r.map.heatmapTiles.currentToReleaseTileUids;e(releaseTiles(n)),e({type:RELEASE_MARKED_TILES_UIDS})}}},markTileAsLoaded=function(e){return function(t){t({type:MARK_TILES_UIDS_AS_LOADED,payload:e}),t(flushToReleaseTiles())}},flushTileState=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(t,r){var n=r(),a=n.map.heatmapTiles.currentVisibleTiles,i=[],o=[];if(!0===e)i=a;else{var s=n.map.heatmapTiles.currentLoadedTiles;a.forEach(function(e){void 0===s.find(function(t){return t.uid===e.uid})&&i.push(e)}),s.forEach(function(e){void 0===a.find(function(t){return t.uid===e.uid})&&o.push(e.uid)})}var u=i.map(function(e){return e.uid});i.forEach(function(e){t(getTile(e))}),t({type:SET_CURRENTLY_LOADED_TILES,payload:a}),t({type:SET_CURRENTLY_SWAPPED_TILE_UIDS,payload:{tilesToLoadUids:u,tilesToReleaseUids:o}}),t(updateLoadedTiles()),t(flushToReleaseTiles())}},_debouncedFlushState=function(e){e(flushTileState())},debouncedFlushState=Object(_chunk_552d8fc4_js__WEBPACK_IMPORTED_MODULE_1__.i)(_debouncedFlushState,500),updateHeatmapTilesFromViewport=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(t,r){var n=r().map.viewport,a=n.viewport;if(null===n.currentTransition){var i=new WebMercatorViewport(a),o=[i.unproject([0,0]),i.unproject([a.width,a.height])],s=o[0],u=o[1],c=[s[0],u[1],u[0],s[1]],l=c[0],p=c[1],f=c[2],h=c[3],d=[],_=getTilecoverLimits(a.zoom);if(!1!==_.tilesAvailable||!0===e){if(f>180||l<-180){var m=f>180?l:l+360,y=f>180?f-360:f;d.push([[[m,h],[179.999,h],[179.999,p],[m,p],[m,h]]]),d.push([[[-180,h],[y,h],[y,p],[-180,p],[-180,h]]])}else d.push([[[l,h],[f,h],[f,p],[l,p],[l,h]]]);var g={type:"MultiPolygon",coordinates:d},b=tileCover.tiles(g,_),v=tileCover.indexes(g,_),S=[];b.forEach(function(e,t){var r=v[t];e[2]>=2&&S.push({tileCoordinates:{x:e[0],y:e[1],zoom:e[2]},uid:r})}),t({type:SET_CURRENTLY_VISIBLE_TILES,payload:S}),!1===(n.prevZoom!==a.zoom)?t(flushTileState(e)):debouncedFlushState(t)}}}},queryHeatmapVessels=function(e,t){return function(r,n){var a={type:"Point",coordinates:[e.longitude,e.latitude]},i=n().map.viewport.viewport.zoom,o=[i,i-1,i+1].map(function(e){return getTilecoverLimits(e)}).map(function(e){return tileCover.indexes(a,e)}).map(function(e){return e[0]});r(highlightVesselFromHeatmap(Object(_chunk_4036bba0_js__WEBPACK_IMPORTED_MODULE_0__.l)({},e,{uids:o}),t))}},ADD_HEATMAP_LAYER="ADD_HEATMAP_LAYER",UPDATE_HEATMAP_LAYER_STYLE="UPDATE_HEATMAP_LAYER_STYLE",ADD_REFERENCE_TILE="ADD_REFERENCE_TILE",HIGHLIGHT_VESSELS="HIGHLIGHT_VESSELS",INIT_HEATMAP_LAYERS="INIT_HEATMAP_LAYERS",REMOVE_HEATMAP_LAYER="REMOVE_HEATMAP_LAYER",UPDATE_HEATMAP_LAYER_TEMPORAL_EXTENTS_LOADED_INDICES="UPDATE_HEATMAP_LAYER_TEMPORAL_EXTENTS_LOADED_INDICES",UPDATE_HEATMAP_TILE="UPDATE_HEATMAP_TILE",RELEASE_HEATMAP_TILES="RELEASE_HEATMAP_TILES",UPDATE_LOADED_TILES="UPDATE_LOADED_TILES",HIGHLIGHT_CLICKED_VESSEL="HIGHLIGHT_CLICKED_VESSEL",CLEAR_HIGHLIGHT_CLICKED_VESSEL="CLEAR_HIGHLIGHT_CLICKED_VESSEL";function getTemporalExtentsVisibleIndices(e,t){var r=e[0].getTime(),n=e[1].getTime(),a=[];return t.forEach(function(e,t){var i=e[0];e[1]>=r&&i<=n&&a.push(t)}),a}function loadLayerTile(e,t,r,n,a){var i=a.url,o=a.temporalExtents,s=a.temporalExtentsLess,u=a.isPBF;if(void 0===i)throw new Error("URL/endpoints object is not available on this tilesets header");var c=getTilePromises(i,r,o,{tileCoordinates:t,temporalExtentsIndices:n,temporalExtentsLess:s,isPBF:u}),l=Promise.all(c);return new Promise(function(t){l.then(function(r){t({loadedLayerId:e,rawTileData:r})})})}function parseLayerTile(e,t,r,n,a){var i;if(!0===r){if(void 0===e||!e.length||void 0===e[0]||!Object.keys(e[0].layers).length)return[];i=e[0].layers.points}else{var o=getCleanVectorArrays(e);if(i=groupData(o,Object.keys(t)),0===Object.keys(i).length)return[]}return getTilePlaybackData(i,t,n,r,a)}function getTiles$1(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return function(n,a){var i=a(),o=startLoader(n,i,e.join("-")),s=i.map.module.token,u=i.map.heatmap.heatmapLayers,c={};e.forEach(function(e){c[e]=Object(_chunk_4036bba0_js__WEBPACK_IMPORTED_MODULE_0__.m)(u[e].tiles)});var l=[];e.forEach(function(e){var a=u[e].header,i=Object(_chunk_4036bba0_js__WEBPACK_IMPORTED_MODULE_0__.l)({},a),o=i.temporalExtents,p=i.temporalExtentsLess,f=i.isPBF,h=i.colsByName,d=a.endpoints.tiles;t.forEach(function(t){var a=c[e].find(function(e){return e.uid===t.uid});a||(a={uid:t.uid,temporalExtentsIndicesLoaded:[]},c[e].push(a));var i=void 0===r?u[e].visibleTemporalExtentsIndices:r[e],_=difference_1(i,a.temporalExtentsIndicesLoaded),m=loadLayerTile(e,t.tileCoordinates,s,_,{url:d,temporalExtents:o,temporalExtentsLess:p,isPBF:f});l.push(m),m.then(function(e){var r=e.loadedLayerId,i=e.rawTileData;a.temporalExtentsIndicesLoaded=uniq_1(a.temporalExtentsIndicesLoaded.concat(_)),a.data=parseLayerTile(i,h,f,t.tileCoordinates,a.data),n({type:UPDATE_HEATMAP_TILE,payload:{layerId:r,tile:a}})})})}),Promise.all(l).then(function(){n(completeLoader(o)),n(markTileAsLoaded(t.map(function(e){return e.uid})))})}}function getTile(e){return function(t,r){t({type:ADD_REFERENCE_TILE,payload:e});var n=r().map.heatmap.heatmapLayers,a=Object.keys(n).filter(function(e){return!0===n[e].visible});a.length&&t(getTiles$1(a,[e]))}}var releaseTiles=function(e){return{type:RELEASE_HEATMAP_TILES,payload:e}},updateLoadedTiles=function(){return{type:UPDATE_LOADED_TILES}};function loadAllTilesForLayer(e){return function(t,r){var n=r().map.heatmap.referenceTiles;t(getTiles$1([e],n))}}var addHeatmapLayer=function(e,t){return function(r){var n=e.header.temporalExtents;r({type:ADD_HEATMAP_LAYER,payload:Object(_chunk_4036bba0_js__WEBPACK_IMPORTED_MODULE_0__.l)({},e,{visibleTemporalExtentsIndices:getTemporalExtentsVisibleIndices(t,n)})}),!0===e.visible&&r(loadAllTilesForLayer(e.id))}},removeHeatmapLayer=function(e){return function(t){t({type:REMOVE_HEATMAP_LAYER,payload:{id:e}})}};function updateLayerLoadTemporalExtents(e){return function(t,r){var n=r(),a=n.map.heatmap.heatmapLayers,i={};Object.keys(a).forEach(function(r){var n=a[r],o=n.header.temporalExtents,s=n.visibleTemporalExtentsIndices,u=getTemporalExtentsVisibleIndices(e,o),c=difference_1(u,s);c.length&&(i[r]=c,t({type:UPDATE_HEATMAP_LAYER_TEMPORAL_EXTENTS_LOADED_INDICES,payload:{layerId:r,indicesAdded:c}}))});var o=Object.keys(i);o.length&&t(getTiles$1(o,n.map.heatmap.referenceTiles,i))}}var _queryHeatmap=function(e,t,r){var n=e.map.heatmap.heatmapLayers,a=r[0],i=r[1],o=[];Object.keys(n).forEach(function(e){var r=n[e];if(!0===r.visible){var s=t.uids.map(function(e){return r.tiles.find(function(t){return t.uid===e})}).filter(function(e){return void 0!==e&&void 0!==e.data}),u=r.filters;if(s.length){var c=s[0];o.push({layer:r,vessels:selectVesselsAt(c.data,t,a,i,u)})}}});var s,u,c,l,p,f=o.filter(function(e){return e.vessels.length>0}),h=f.filter(function(e){return e.layer.subtype===ENCOUNTERS}).length>0;if(0===f.length)c=!0;else if(f.length>1&&!h)s=!0;else{var d=(l=h?f.find(function(e){return e.layer.subtype===ENCOUNTERS}):f[0]).vessels;0===d.length?c=!0:d.filter(function(e){return e.seriesgroup<0}).length?s=!0:u=(p=uniqBy_1(d,function(e){return e.series})).length>1}return{isEmpty:c,isCluster:s,isMouseCluster:u,foundVessels:p,layer:void 0===l?{}:l.layer}};function clearHighlightedVessels(){return{type:HIGHLIGHT_VESSELS,payload:{isEmpty:!0,clickableCluster:!1}}}function highlightVesselFromHeatmap(e,t){return function(r,n){var a=n(),i=_queryHeatmap(a,e,t),o=i.layer,s=i.isEmpty,u=i.isCluster,c=i.isMouseCluster,l=i.foundVessels;void 0!==o.id||a.map.heatmap.highlightedVessels.layerId!==o.id?r({type:HIGHLIGHT_VESSELS,payload:{layer:{id:o.id,tilesetId:o.tilesetId,subtype:o.subtype,header:o.header},isEmpty:s,clickableCluster:!0===u||!0===c,highlightableCluster:!0!==u,foundVessels:l}}):r(clearHighlightedVessels())}}var clearHighlightedClickedVessel=function(){return{type:CLEAR_HIGHLIGHT_CLICKED_VESSEL}},updateHeatmapLayers=function(e,t){return function(r,n){if(null!==e){var a=n().map.heatmap.heatmapLayers;e.forEach(function(e){var n=e.id,i=a[n];void 0===i?r(addHeatmapLayer(e,t)):(i.visible!==e.visible&&!0===e.visible&&r(loadAllTilesForLayer(n)),i.visible===e.visible&&i.hue===e.hue&&i.opacity===e.opacity&&i.filters===e.filters&&i.interactive===e.interactive||r({type:UPDATE_HEATMAP_LAYER_STYLE,payload:{id:e.id,visible:e.visible,hue:e.hue,opacity:e.opacity,filters:e.filters,interactive:e.interactive}}))}),Object.keys(a).forEach(function(t){e.find(function(e){return e.id===t})||r(removeHeatmapLayer(t))})}else console.warn("New layers in updateHeatmapLayers can't be null")}},SET_VIEWPORT="SET_VIEWPORT",UPDATE_VIEWPORT="UPDATE_VIEWPORT",SET_ZOOM_INCREMENT="SET_ZOOM_INCREMENT",SET_MOUSE_LAT_LONG="SET_MOUSE_LAT_LONG",TRANSITION_END="TRANSITION_END",SET_NATIVE_VIEWPORT="SET_NATIVE_VIEWPORT",setViewport=function(e){return function(t){t({type:SET_VIEWPORT,payload:e}),t(updateHeatmapTilesFromViewport()),t(onViewportChange())}},updateViewport=function(e){return function(t){t({type:UPDATE_VIEWPORT,payload:e}),t(updateHeatmapTilesFromViewport()),t(onViewportChange())}},transitionTo=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return function(a){a({type:SET_ZOOM_INCREMENT,payload:{increment:e,latitude:t,longitude:r,zoom:n}}),a(updateHeatmapTilesFromViewport()),a(onViewportChange())}},transitionToZoom=function(e){return function(t){t(transitionTo(null,null,null,e))}},transitionEnd=function(){return function(e){e({type:TRANSITION_END}),e(updateHeatmapTilesFromViewport()),e(onViewportChange())}},zoomIntoVesselCenter=function(e,t){return function(r){r(transitionTo(CLUSTER_CLICK_ZOOM_INCREMENT,e,t))}},fitToBounds=function(e){return function(t,r){var n=r(),a=fitBounds({bounds:[[e.minLng,e.minLat],[e.maxLng,e.maxLat]],width:n.map.viewport.viewport.width,height:n.map.viewport.viewport.height,padding:50});t(transitionTo(null,a.latitude,a.longitude,a.zoom))}},exportNativeViewport=function(e){return function(t){var r=[0,0],n=[e.width,e.height],a=pixelsToWorld(r,e.pixelUnprojectionMatrix),i=pixelsToWorld(n,e.pixelUnprojectionMatrix),o=a[0]/e.scale,s=i[0]/e.scale,u=e.unproject(r),c=e.unproject(n),l={north:u[1],south:c[1],west:u[0],east:c[0]};t({type:SET_NATIVE_VIEWPORT,payload:{leftWorldScaled:o,rightWorldScaled:s,bounds:l}})}};function createThunkMiddleware(e){return function(t){var r=t.dispatch,n=t.getState;return function(t){return function(a){return"function"==typeof a?a(r,n,e):t(a)}}}}var thunk=createThunkMiddleware();thunk.withExtraArgument=createThunkMiddleware;var composeEnhancers=redux__WEBPACK_IMPORTED_MODULE_2__.d,composeWithDevTools;Object({NODE_ENV:"production",PUBLIC_URL:"/pcp-prototypes"}).REACT_APP_MAP_REDUX_REMOTE_DEBUG;var store=Object(redux__WEBPACK_IMPORTED_MODULE_2__.e)(function(){},{},composeEnhancers(Object(redux__WEBPACK_IMPORTED_MODULE_2__.a)(thunk))),targetMapVessel=function(e){var t=store.getState().map.tracks.data.find(function(t){return t.id===e.toString()});return store.dispatch(fitToBounds(t.geoBounds)),t.timelineBounds}},432:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),i=r(205),o=r.n(i),s=(r(225),r(226),r(60)),u=r(119),c=r.n(u),l=function(){return a.a.createElement(n.Fragment,null,a.a.createElement("h1",{className:c.a.title},"Pew Carrier Portal prototypes"),a.a.createElement("nav",{className:c.a.nav},a.a.createElement(s.a,{to:"".concat("/pcp-prototypes","/search")},"Search"),a.a.createElement(s.a,{to:"".concat("/pcp-prototypes","/scrolling")},"History scroll"),a.a.createElement(s.a,{to:"".concat("/pcp-prototypes","/map-navigation")},"Map navigation")))},p=r(20),f=r(19),h=r(1),d=r(6),_=r.n(d),m=Object(h.a)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&Symbol.for,n=r?Symbol.for("react.element"):60103,a=r?Symbol.for("react.portal"):60106,i=r?Symbol.for("react.fragment"):60107,o=r?Symbol.for("react.strict_mode"):60108,s=r?Symbol.for("react.profiler"):60114,u=r?Symbol.for("react.provider"):60109,c=r?Symbol.for("react.context"):60110,l=r?Symbol.for("react.async_mode"):60111,p=r?Symbol.for("react.concurrent_mode"):60111,f=r?Symbol.for("react.forward_ref"):60112,h=r?Symbol.for("react.suspense"):60113,d=r?Symbol.for("react.memo"):60115,_=r?Symbol.for("react.lazy"):60116;function m(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case l:case p:case i:case s:case o:case h:return e;default:switch(e=e&&e.$$typeof){case c:case f:case u:return e;default:return t}}case _:case d:case a:return t}}}function y(e){return m(e)===p}t.typeOf=m,t.AsyncMode=l,t.ConcurrentMode=p,t.ContextConsumer=c,t.ContextProvider=u,t.Element=n,t.ForwardRef=f,t.Fragment=i,t.Lazy=_,t.Memo=d,t.Portal=a,t.Profiler=s,t.StrictMode=o,t.Suspense=h,t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===i||e===p||e===s||e===o||e===h||"object"==typeof e&&null!==e&&(e.$$typeof===_||e.$$typeof===d||e.$$typeof===u||e.$$typeof===c||e.$$typeof===f)},t.isAsyncMode=function(e){return y(e)||m(e)===l},t.isConcurrentMode=y,t.isContextConsumer=function(e){return m(e)===c},t.isContextProvider=function(e){return m(e)===u},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return m(e)===f},t.isFragment=function(e){return m(e)===i},t.isLazy=function(e){return m(e)===_},t.isMemo=function(e){return m(e)===d},t.isPortal=function(e){return m(e)===a},t.isProfiler=function(e){return m(e)===s},t.isStrictMode=function(e){return m(e)===o},t.isSuspense=function(e){return m(e)===h}});Object(h.b)(m),m.typeOf,m.AsyncMode,m.ConcurrentMode,m.ContextConsumer,m.ContextProvider,m.Element,m.ForwardRef,m.Fragment,m.Lazy,m.Memo,m.Portal,m.Profiler,m.StrictMode,m.Suspense,m.isValidElementType,m.isAsyncMode,m.isConcurrentMode,m.isContextConsumer,m.isContextProvider,m.isElement,m.isForwardRef,m.isFragment,m.isLazy,m.isMemo,m.isPortal,m.isProfiler,m.isStrictMode,m.isSuspense;var y=Object(h.a)(function(e,t){});Object(h.b)(y),y.typeOf,y.AsyncMode,y.ConcurrentMode,y.ContextConsumer,y.ContextProvider,y.Element,y.ForwardRef,y.Fragment,y.Lazy,y.Memo,y.Portal,y.Profiler,y.StrictMode,y.Suspense,y.isValidElementType,y.isAsyncMode,y.isConcurrentMode,y.isContextConsumer,y.isContextProvider,y.isElement,y.isForwardRef,y.isFragment,y.isLazy,y.isMemo,y.isPortal,y.isProfiler,y.isStrictMode,y.isSuspense,Object(h.a)(function(e){e.exports=m});Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;(function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}})()&&Object.assign;var g="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";function b(){}function v(){}Function.call.bind(Object.prototype.hasOwnProperty),v.resetWarningCache=b;var S=Object(h.a)(function(e){e.exports=function(){function e(e,t,r,n,a,i){if(i!==g){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:v,resetWarningCache:b};return r.PropTypes=r,r}()}),O=[{ISO2:"AW",ISO3:"ABW",name:"Aruba"},{ISO2:"AF",ISO3:"AFG",name:"Afghanistan"},{ISO2:"AO",ISO3:"AGO",name:"Angola"},{ISO2:"AI",ISO3:"AIA",name:"Anguilla"},{ISO2:"AX",ISO3:"ALA",name:"\xc5land Islands"},{ISO2:"AL",ISO3:"ALB",name:"Albania"},{ISO2:"AD",ISO3:"AND",name:"Andorra"},{ISO2:"AE",ISO3:"ARE",name:"United Arab Emirates"},{ISO2:"AR",ISO3:"ARG",name:"Argentina"},{ISO2:"AM",ISO3:"ARM",name:"Armenia"},{ISO2:"AS",ISO3:"ASM",name:"American Samoa"},{ISO2:"AQ",ISO3:"ATA",name:"Antarctica"},{ISO2:"TF",ISO3:"ATF",name:"French Southern and Antarctic Lands"},{ISO2:"AG",ISO3:"ATG",name:"Antigua and Barbuda"},{ISO2:"AU",ISO3:"AUS",name:"Australia"},{ISO2:"AT",ISO3:"AUT",name:"Austria"},{ISO2:"AZ",ISO3:"AZE",name:"Azerbaijan"},{ISO2:"BI",ISO3:"BDI",name:"Burundi"},{ISO2:"BE",ISO3:"BEL",name:"Belgium"},{ISO2:"BJ",ISO3:"BEN",name:"Benin"},{ISO2:"BF",ISO3:"BFA",name:"Burkina Faso"},{ISO2:"BD",ISO3:"BGD",name:"Bangladesh"},{ISO2:"BG",ISO3:"BGR",name:"Bulgaria"},{ISO2:"BH",ISO3:"BHR",name:"Bahrain"},{ISO2:"BS",ISO3:"BHS",name:"Bahamas"},{ISO2:"BA",ISO3:"BIH",name:"Bosnia and Herzegovina"},{ISO2:"BL",ISO3:"BLM",name:"Saint Barth\xe9lemy"},{ISO2:"SH",ISO3:"SHN",name:"Saint Helena, Ascension and Tristan da Cunha"},{ISO2:"BY",ISO3:"BLR",name:"Belarus"},{ISO2:"BZ",ISO3:"BLZ",name:"Belize"},{ISO2:"BM",ISO3:"BMU",name:"Bermuda"},{ISO2:"BO",ISO3:"BOL",name:"Bolivia"},{ISO2:"BQ",ISO3:"BES",name:"Caribbean Netherlands"},{ISO2:"BR",ISO3:"BRA",name:"Brazil"},{ISO2:"BB",ISO3:"BRB",name:"Barbados"},{ISO2:"BN",ISO3:"BRN",name:"Brunei"},{ISO2:"BT",ISO3:"BTN",name:"Bhutan"},{ISO2:"BV",ISO3:"BVT",name:"Bouvet Island"},{ISO2:"BW",ISO3:"BWA",name:"Botswana"},{ISO2:"CF",ISO3:"CAF",name:"Central African Republic"},{ISO2:"CA",ISO3:"CAN",name:"Canada"},{ISO2:"CC",ISO3:"CCK",name:"Cocos (Keeling) Islands"},{ISO2:"CH",ISO3:"CHE",name:"Switzerland"},{ISO2:"CL",ISO3:"CHL",name:"Chile"},{ISO2:"CN",ISO3:"CHN",name:"China"},{ISO2:"CI",ISO3:"CIV",name:"Ivory Coast"},{ISO2:"CM",ISO3:"CMR",name:"Cameroon"},{ISO2:"CD",ISO3:"COD",name:"DR Congo"},{ISO2:"CG",ISO3:"COG",name:"Republic of the Congo"},{ISO2:"CK",ISO3:"COK",name:"Cook Islands"},{ISO2:"CO",ISO3:"COL",name:"Colombia"},{ISO2:"KM",ISO3:"COM",name:"Comoros"},{ISO2:"CV",ISO3:"CPV",name:"Cape Verde"},{ISO2:"CR",ISO3:"CRI",name:"Costa Rica"},{ISO2:"CU",ISO3:"CUB",name:"Cuba"},{ISO2:"CW",ISO3:"CUW",name:"Cura\xe7ao"},{ISO2:"CX",ISO3:"CXR",name:"Christmas Island"},{ISO2:"KY",ISO3:"CYM",name:"Cayman Islands"},{ISO2:"CY",ISO3:"CYP",name:"Cyprus"},{ISO2:"CZ",ISO3:"CZE",name:"Czechia"},{ISO2:"DE",ISO3:"DEU",name:"Germany"},{ISO2:"DJ",ISO3:"DJI",name:"Djibouti"},{ISO2:"DM",ISO3:"DMA",name:"Dominica"},{ISO2:"DK",ISO3:"DNK",name:"Denmark"},{ISO2:"DO",ISO3:"DOM",name:"Dominican Republic"},{ISO2:"DZ",ISO3:"DZA",name:"Algeria"},{ISO2:"EC",ISO3:"ECU",name:"Ecuador"},{ISO2:"EG",ISO3:"EGY",name:"Egypt"},{ISO2:"ER",ISO3:"ERI",name:"Eritrea"},{ISO2:"EH",ISO3:"ESH",name:"Western Sahara"},{ISO2:"ES",ISO3:"ESP",name:"Spain"},{ISO2:"EE",ISO3:"EST",name:"Estonia"},{ISO2:"ET",ISO3:"ETH",name:"Ethiopia"},{ISO2:"FI",ISO3:"FIN",name:"Finland"},{ISO2:"FJ",ISO3:"FJI",name:"Fiji"},{ISO2:"FK",ISO3:"FLK",name:"Falkland Islands"},{ISO2:"FR",ISO3:"FRA",name:"France"},{ISO2:"FO",ISO3:"FRO",name:"Faroe Islands"},{ISO2:"FM",ISO3:"FSM",name:"Micronesia"},{ISO2:"GA",ISO3:"GAB",name:"Gabon"},{ISO2:"GB",ISO3:"GBR",name:"United Kingdom"},{ISO2:"GE",ISO3:"GEO",name:"Georgia"},{ISO2:"GG",ISO3:"GGY",name:"Guernsey"},{ISO2:"GH",ISO3:"GHA",name:"Ghana"},{ISO2:"GI",ISO3:"GIB",name:"Gibraltar"},{ISO2:"GN",ISO3:"GIN",name:"Guinea"},{ISO2:"GP",ISO3:"GLP",name:"Guadeloupe"},{ISO2:"GM",ISO3:"GMB",name:"Gambia"},{ISO2:"GW",ISO3:"GNB",name:"Guinea-Bissau"},{ISO2:"GQ",ISO3:"GNQ",name:"Equatorial Guinea"},{ISO2:"GR",ISO3:"GRC",name:"Greece"},{ISO2:"GD",ISO3:"GRD",name:"Grenada"},{ISO2:"GL",ISO3:"GRL",name:"Greenland"},{ISO2:"GT",ISO3:"GTM",name:"Guatemala"},{ISO2:"GF",ISO3:"GUF",name:"French Guiana"},{ISO2:"GU",ISO3:"GUM",name:"Guam"},{ISO2:"GY",ISO3:"GUY",name:"Guyana"},{ISO2:"HK",ISO3:"HKG",name:"Hong Kong"},{ISO2:"HM",ISO3:"HMD",name:"Heard Island and McDonald Islands"},{ISO2:"HN",ISO3:"HND",name:"Honduras"},{ISO2:"HR",ISO3:"HRV",name:"Croatia"},{ISO2:"HT",ISO3:"HTI",name:"Haiti"},{ISO2:"HU",ISO3:"HUN",name:"Hungary"},{ISO2:"ID",ISO3:"IDN",name:"Indonesia"},{ISO2:"IM",ISO3:"IMN",name:"Isle of Man"},{ISO2:"IN",ISO3:"IND",name:"India"},{ISO2:"IO",ISO3:"IOT",name:"British Indian Ocean Territory"},{ISO2:"IE",ISO3:"IRL",name:"Ireland"},{ISO2:"IR",ISO3:"IRN",name:"Iran"},{ISO2:"IQ",ISO3:"IRQ",name:"Iraq"},{ISO2:"IS",ISO3:"ISL",name:"Iceland"},{ISO2:"IL",ISO3:"ISR",name:"Israel"},{ISO2:"IT",ISO3:"ITA",name:"Italy"},{ISO2:"JM",ISO3:"JAM",name:"Jamaica"},{ISO2:"JE",ISO3:"JEY",name:"Jersey"},{ISO2:"JO",ISO3:"JOR",name:"Jordan"},{ISO2:"JP",ISO3:"JPN",name:"Japan"},{ISO2:"KZ",ISO3:"KAZ",name:"Kazakhstan"},{ISO2:"KE",ISO3:"KEN",name:"Kenya"},{ISO2:"KG",ISO3:"KGZ",name:"Kyrgyzstan"},{ISO2:"KH",ISO3:"KHM",name:"Cambodia"},{ISO2:"KI",ISO3:"KIR",name:"Kiribati"},{ISO2:"KN",ISO3:"KNA",name:"Saint Kitts and Nevis"},{ISO2:"KR",ISO3:"KOR",name:"South Korea"},{ISO2:"XK",ISO3:"UNK",name:"Kosovo"},{ISO2:"KW",ISO3:"KWT",name:"Kuwait"},{ISO2:"LA",ISO3:"LAO",name:"Laos"},{ISO2:"LB",ISO3:"LBN",name:"Lebanon"},{ISO2:"LR",ISO3:"LBR",name:"Liberia"},{ISO2:"LY",ISO3:"LBY",name:"Libya"},{ISO2:"LC",ISO3:"LCA",name:"Saint Lucia"},{ISO2:"LI",ISO3:"LIE",name:"Liechtenstein"},{ISO2:"LK",ISO3:"LKA",name:"Sri Lanka"},{ISO2:"LS",ISO3:"LSO",name:"Lesotho"},{ISO2:"LT",ISO3:"LTU",name:"Lithuania"},{ISO2:"LU",ISO3:"LUX",name:"Luxembourg"},{ISO2:"LV",ISO3:"LVA",name:"Latvia"},{ISO2:"MO",ISO3:"MAC",name:"Macau"},{ISO2:"MF",ISO3:"MAF",name:"Saint Martin"},{ISO2:"MA",ISO3:"MAR",name:"Morocco"},{ISO2:"MC",ISO3:"MCO",name:"Monaco"},{ISO2:"MD",ISO3:"MDA",name:"Moldova"},{ISO2:"MG",ISO3:"MDG",name:"Madagascar"},{ISO2:"MV",ISO3:"MDV",name:"Maldives"},{ISO2:"MX",ISO3:"MEX",name:"Mexico"},{ISO2:"MH",ISO3:"MHL",name:"Marshall Islands"},{ISO2:"MK",ISO3:"MKD",name:"Macedonia"},{ISO2:"ML",ISO3:"MLI",name:"Mali"},{ISO2:"MT",ISO3:"MLT",name:"Malta"},{ISO2:"MM",ISO3:"MMR",name:"Myanmar"},{ISO2:"ME",ISO3:"MNE",name:"Montenegro"},{ISO2:"MN",ISO3:"MNG",name:"Mongolia"},{ISO2:"MP",ISO3:"MNP",name:"Northern Mariana Islands"},{ISO2:"MZ",ISO3:"MOZ",name:"Mozambique"},{ISO2:"MR",ISO3:"MRT",name:"Mauritania"},{ISO2:"MS",ISO3:"MSR",name:"Montserrat"},{ISO2:"MQ",ISO3:"MTQ",name:"Martinique"},{ISO2:"MU",ISO3:"MUS",name:"Mauritius"},{ISO2:"MW",ISO3:"MWI",name:"Malawi"},{ISO2:"MY",ISO3:"MYS",name:"Malaysia"},{ISO2:"YT",ISO3:"MYT",name:"Mayotte"},{ISO2:"NA",ISO3:"NAM",name:"Namibia"},{ISO2:"NC",ISO3:"NCL",name:"New Caledonia"},{ISO2:"NE",ISO3:"NER",name:"Niger"},{ISO2:"NF",ISO3:"NFK",name:"Norfolk Island"},{ISO2:"NG",ISO3:"NGA",name:"Nigeria"},{ISO2:"NI",ISO3:"NIC",name:"Nicaragua"},{ISO2:"NU",ISO3:"NIU",name:"Niue"},{ISO2:"NL",ISO3:"NLD",name:"Netherlands"},{ISO2:"NO",ISO3:"NOR",name:"Norway"},{ISO2:"NP",ISO3:"NPL",name:"Nepal"},{ISO2:"NR",ISO3:"NRU",name:"Nauru"},{ISO2:"NZ",ISO3:"NZL",name:"New Zealand"},{ISO2:"OM",ISO3:"OMN",name:"Oman"},{ISO2:"PK",ISO3:"PAK",name:"Pakistan"},{ISO2:"PA",ISO3:"PAN",name:"Panama"},{ISO2:"PN",ISO3:"PCN",name:"Pitcairn Islands"},{ISO2:"PE",ISO3:"PER",name:"Peru"},{ISO2:"PH",ISO3:"PHL",name:"Philippines"},{ISO2:"PW",ISO3:"PLW",name:"Palau"},{ISO2:"PG",ISO3:"PNG",name:"Papua New Guinea"},{ISO2:"PL",ISO3:"POL",name:"Poland"},{ISO2:"PR",ISO3:"PRI",name:"Puerto Rico"},{ISO2:"KP",ISO3:"PRK",name:"North Korea"},{ISO2:"PT",ISO3:"PRT",name:"Portugal"},{ISO2:"PY",ISO3:"PRY",name:"Paraguay"},{ISO2:"PS",ISO3:"PSE",name:"Palestine"},{ISO2:"PF",ISO3:"PYF",name:"French Polynesia"},{ISO2:"QA",ISO3:"QAT",name:"Qatar"},{ISO2:"RE",ISO3:"REU",name:"R\xe9union"},{ISO2:"RO",ISO3:"ROU",name:"Romania"},{ISO2:"RU",ISO3:"RUS",name:"Russia"},{ISO2:"RW",ISO3:"RWA",name:"Rwanda"},{ISO2:"SA",ISO3:"SAU",name:"Saudi Arabia"},{ISO2:"SD",ISO3:"SDN",name:"Sudan"},{ISO2:"SN",ISO3:"SEN",name:"Senegal"},{ISO2:"SG",ISO3:"SGP",name:"Singapore"},{ISO2:"GS",ISO3:"SGS",name:"South Georgia"},{ISO2:"SJ",ISO3:"SJM",name:"Svalbard and Jan Mayen"},{ISO2:"SB",ISO3:"SLB",name:"Solomon Islands"},{ISO2:"SL",ISO3:"SLE",name:"Sierra Leone"},{ISO2:"SV",ISO3:"SLV",name:"El Salvador"},{ISO2:"SM",ISO3:"SMR",name:"San Marino"},{ISO2:"SO",ISO3:"SOM",name:"Somalia"},{ISO2:"PM",ISO3:"SPM",name:"Saint Pierre and Miquelon"},{ISO2:"RS",ISO3:"SRB",name:"Serbia"},{ISO2:"SS",ISO3:"SSD",name:"South Sudan"},{ISO2:"ST",ISO3:"STP",name:"S\xe3o Tom\xe9 and Pr\xedncipe"},{ISO2:"SR",ISO3:"SUR",name:"Suriname"},{ISO2:"SK",ISO3:"SVK",name:"Slovakia"},{ISO2:"SI",ISO3:"SVN",name:"Slovenia"},{ISO2:"SE",ISO3:"SWE",name:"Sweden"},{ISO2:"SZ",ISO3:"SWZ",name:"Eswatini"},{ISO2:"SX",ISO3:"SXM",name:"Sint Maarten"},{ISO2:"SC",ISO3:"SYC",name:"Seychelles"},{ISO2:"SY",ISO3:"SYR",name:"Syria"},{ISO2:"TC",ISO3:"TCA",name:"Turks and Caicos Islands"},{ISO2:"TD",ISO3:"TCD",name:"Chad"},{ISO2:"TG",ISO3:"TGO",name:"Togo"},{ISO2:"TH",ISO3:"THA",name:"Thailand"},{ISO2:"TJ",ISO3:"TJK",name:"Tajikistan"},{ISO2:"TK",ISO3:"TKL",name:"Tokelau"},{ISO2:"TM",ISO3:"TKM",name:"Turkmenistan"},{ISO2:"TL",ISO3:"TLS",name:"Timor-Leste"},{ISO2:"TO",ISO3:"TON",name:"Tonga"},{ISO2:"TT",ISO3:"TTO",name:"Trinidad and Tobago"},{ISO2:"TN",ISO3:"TUN",name:"Tunisia"},{ISO2:"TR",ISO3:"TUR",name:"Turkey"},{ISO2:"TV",ISO3:"TUV",name:"Tuvalu"},{ISO2:"TW",ISO3:"TWN",name:"Taiwan"},{ISO2:"TZ",ISO3:"TZA",name:"Tanzania"},{ISO2:"UG",ISO3:"UGA",name:"Uganda"},{ISO2:"UA",ISO3:"UKR",name:"Ukraine"},{ISO2:"UM",ISO3:"UMI",name:"United States Minor Outlying Islands"},{ISO2:"UY",ISO3:"URY",name:"Uruguay"},{ISO2:"US",ISO3:"USA",name:"United States"},{ISO2:"UZ",ISO3:"UZB",name:"Uzbekistan"},{ISO2:"VA",ISO3:"VAT",name:"Vatican City"},{ISO2:"VC",ISO3:"VCT",name:"Saint Vincent and the Grenadines"},{ISO2:"VE",ISO3:"VEN",name:"Venezuela"},{ISO2:"VG",ISO3:"VGB",name:"British Virgin Islands"},{ISO2:"VI",ISO3:"VIR",name:"United States Virgin Islands"},{ISO2:"VN",ISO3:"VNM",name:"Vietnam"},{ISO2:"VU",ISO3:"VUT",name:"Vanuatu"},{ISO2:"WF",ISO3:"WLF",name:"Wallis and Futuna"},{ISO2:"WS",ISO3:"WSM",name:"Samoa"},{ISO2:"YE",ISO3:"YEM",name:"Yemen"},{ISO2:"ZA",ISO3:"ZAF",name:"South Africa"},{ISO2:"ZM",ISO3:"ZMB",name:"Zambia"},{ISO2:"ZW",ISO3:"ZWE",name:"Zimbabwe"}],I=Object(h.a)(function(e,t){var r,n;e.exports=(r=function(e){return Array.prototype.toString.call(e)},n=function(e,t){try{var r=document.createElement("canvas");r.width=1,r.height=1;var n=r.getContext("2d");return n.textBaseline="top",n.font="100px -no-font-family-here-",n.fillStyle=t,n.scale(.01,.01),n.fillText(e,0,0),n.getImageData(0,0,1,1).data}catch(e){return!1}},function(e){var t=n(e,"#000"),a=n(e,"#fff");return t&&a&&function(e,t){var n=r(e);return n===r(t)&&"0,0,0,0"!==n}(t,a)})})("\ud83c\udde7\ud83c\uddf9"),E=function(e){function t(){return Object(h.d)(this,t),Object(h.e)(this,Object(h.f)(t).apply(this,arguments))}return Object(h.c)(t,d.PureComponent),Object(h.g)(t,[{key:"render",value:function(){var e=this.props,t=e.iso,r=e.iso2,n=e.svg,a=e.size,i=e.margin;if(!t&&!r)return console.error(" Country flag iso (iso 3) or iso2 code is required"),null;r&&console.warn("iso2 parameter is deprecated, use iso instead");var o=function(e){var t,r,n;if(2===e.length)t=e.toLowerCase(),r=t.toUpperCase(),n=O.find(function(e){return e.ISO2===r});else{if(3!==e.length)throw new Error(e," is not an ISO 2 nor ISO 3 code");var a=e.toUpperCase();n=O.find(function(e){return e.ISO3===a}),t=(r=n.ISO2).toLowerCase()}if(void 0===n)throw new Error("Could not find a country corresponding to provided ISO:",e);var i=null;return I&&(i=String.fromCodePoint(r.codePointAt(0)+127397,r.codePointAt(1)+127397)),{emoji:i,svg:"https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/flags/4x3/{iso2}.svg".replace("{iso2}",t),name:n.name}}(t||r);return!0===n||null===o.emoji?_.a.createElement("img",{style:{height:a,marginRight:i.right,marginLeft:i.left},alt:o.name,src:o.svg}):_.a.createElement("span",{style:{fontSize:a},role:"img","aria-label":o.name},o.emoji)}}]),t}();E.propTypes={iso:S.string.isRequired,svg:S.bool,size:S.string,margin:S.shape({left:S.string,righ:S.string})},E.defaultProps={svg:!1,size:"1em",margin:{left:"0.1em",right:"0.2em"}};var T=r(120),w=r.n(T),A=r(93),M=r.n(A),P=r(17),L=r(31),x=r.n(L),C=r(40),R=r(207),j=r(92),k=new RegExp("\xa0","g"),D=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/\s/gi,"\xa0")},N=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(k," ")},F=function(e){return e.replace(/[.*+?^${}\/()|[\]\\]/g,"")},B=function(e){return e?e.replace(/:/gi," ").replace(/,/gi," ").split(" ").filter(function(e){return e}):[]},U=function(e){return null===e?{}:e.reduce(function(e,t){var r=t.type,n=t.id,a=t.label;return e[r]?(e[r].values.push({id:n,label:a}),e):Object(P.a)({},e,Object(j.a)({},r,{type:r,values:[{id:n,label:a}]}))},{})},V=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ",r=Object.values(e).length-1;return Object.values(e).reduce(function(e,n,a){return"".concat(""!==e?"".concat(e," "):"").concat(n.type,":").concat(n.values.map(function(e){return D(e.label)}).join(",")).concat(a===r?t:"")},"")}(U(e),t)},z={flag:"flag",rfmo:"rfmo",vessel:"vessel",after:"after",before:"before",port:"port"},H=[z.flag,z.rfmo,z.vessel,z.after,z.before],G=[z.vessel],q=[z.after,z.before],K=function(e){var t=e.itemToString,r=e.setDownshiftRef,n=e.downshiftRefLoaded,i=e.initialInputValue,o=e.initialSelection,s=e.onChange,u=e.customEventHandler,c=e.stateReducer,l=e.items,f=e.onStateChange,h=e.loading?[].concat(Object(p.a)(l),[{type:"loading",id:"loading",label:"loading"}]):l;return a.a.createElement(C.a,{onChange:s,initialInputValue:i,initialSelectedItem:o,stateReducer:c,itemToString:t,onStateChange:f,defaultHighlightedIndex:0},function(e){!1===n&&r(e);var i=e.getInputProps,o=e.getMenuProps,s=e.getItemProps,c=e.isOpen,l=e.inputValue,f=e.selectedItem,d=e.highlightedIndex;return a.a.createElement("div",{className:x.a.searchContainer},a.a.createElement("div",null,!c&&a.a.createElement("div",{className:x.a.searchErrorsContainer},function(e,t){if(!e)return"";var r=null!==t?Array.from(new Set([].concat(Object(p.a)(t.map(function(e){return D(e.label)})),Object(p.a)(t.map(function(e){return e.type}))))):[],n=B(e).filter(function(e){return!r.some(function(t){return t===e})}),i=F(e);return n.length&&n.forEach(function(e){i=i.replace(new RegExp("\\b".concat(F(e),"\\b"),"g"),"<span class=".concat(x.a.searchItemError,">").concat(e,"</span>"))}),a.a.createElement("span",{dangerouslySetInnerHTML:{__html:i}})}(l||"",f)),a.a.createElement("input",Object.assign({className:x.a.searchInput},i({placeholder:"Start searching",onKeyDown:void 0!==u?function(t){return u(t,e)}:void 0,onClick:void 0!==u?function(t){return u(t,e)}:void 0}),{spellCheck:!1}))),c?a.a.createElement("div",{className:x.a.optionListContainer},h.length>0?a.a.createElement(R.a,Object.assign({height:300,itemSize:40,itemCount:h.length,outerElementType:"ul",className:x.a.optionList},o()),function(e){var r=e.index,n=e.style,i=h[r];return"loading"===i.type?a.a.createElement("li",{key:i.id,className:x.a.optionlistItemLoading,style:Object(P.a)({},n)},a.a.createElement("span",{className:x.a.spinner})):a.a.createElement("li",Object.assign({key:i.id,className:x.a.optionlistItem},s({item:i,index:r}),{style:Object(P.a)({},n,{backgroundColor:d===r?"#ccc":"transparent",color:f===i?"#0f0f0f":"#000"})}),a.a.createElement("div",{className:x.a.optionListText},i.type,":"," ",i.type===z.flag&&a.a.createElement(E,{iso:i.id})," ",t(i)),d===r&&a.a.createElement("span",{className:x.a.optionlistItemPlaceholder},function(e){var t="Press \u23ce to";switch(e){case z.flag:return"".concat(t," see the activity of carriers from this flag state");case z.rfmo:return"".concat(t," see the activity that occurred in this RFMO area");case z.after:return"".concat(t," see the activity that occurred after this date");case z.before:return"".concat(t," see the activity that occurred before this date");case z.vessel:return"".concat(t," see the activity from this carrier");default:return"".concat(t," select")}}(i.type)))}):a.a.createElement("span",{className:x.a.optionlistItem},"There are no filters matching your query")):null)})},$=r(56),Y=r(75),W=r.n(Y),Z=r(41),X=function(e,t,r){for(var n=t&&t.map(function(e){return e.type})||[],a=t&&t.map(function(e){return e.label})||[],i={},o=B(e).map(N).filter(function(e){return n.includes(e)?!!i[e]||(i[e]=!0,!1):!a.includes(e)}),s=0,u=r;u>0;u--)if(":"===e[u]){s=u;break}if(-1===e.slice(s,r+1).indexOf(" ")){for(var c=0,l=s;l>0;l--)if(" "===e[l]){c=l+1;break}var p=e.slice(c,s);p&&o.push(p)}return Array.from(new Set(o))},J=Object(Z.a)(function(e,t){return e.reduce(function(e,t){return Object($.a)(e,t,{keys:[{key:"type",threshold:$.b.EQUAL},{key:"label",threshold:$.b.WORD_STARTS_WITH}]})},t)}),Q=Object(Z.a)(function(e,t){return t.length>0?e.filter(function(e){return!t.includes(e.id)}):e}),ee=function(e,t,r,n){if(!t)return e;var a=r&&r.map(function(e){return e.id})||[],i=X(t,r,n),o=Q(e,a);return J(i,o)},te=r(208),re=r.n(te),ne=function(e){var t=e.selectedItems,r=e.onChange,i=function(e,t){var r={loading:!1,staticData:e,selectedItem:[],cursorPosition:0,search:t||"",results:e,cachedResults:e},a=Object(n.useReducer)(function(e,t){switch(t.type){case"inputChange":return Object(P.a)({},e,{search:t.payload.search,selectedItem:t.payload.selectedItem});case"setCursorPosition":return Object(P.a)({},e,{cursorPosition:t.payload});case"startSearch":var r=e.staticData,n=e.search,a=e.selectedItem,i=e.cursorPosition;return Object(P.a)({},e,{results:ee(r,n,a,i),loading:t.payload});case"endSearch":return Object(P.a)({},e,{results:[].concat(Object(p.a)(e.results),Object(p.a)(t.payload)),cachedResults:W()([].concat(Object(p.a)(e.cachedResults),Object(p.a)(t.payload)),"id"),loading:!1});default:return e}},r),i=Object(f.a)(a,2),o=i[0],s=i[1],u=o.search,c=o.selectedItem,l=o.cursorPosition;return Object(n.useEffect)(function(){var e=X(u,c,l),t=e.filter(function(e){return H.includes(e)}),r=0===t.length||t.some(function(e){return G.includes(e)}),n=c.map(function(e){return e.id}),a=c.map(function(e){return e.label}),i=e.filter(function(e){return!a.includes(e)&&!H.includes(e)}).join(","),o=r&&""!==i;if(s({type:"startSearch",payload:o}),o){var p=new AbortController,f="https://vessels-dot-world-fishing-827.appspot.com/datasets/indonesia/vessels?query=".concat(i,"&offset=0");return fetch(f,{signal:p.signal}).then(function(e){return e.status>=200&&e.status<300?Promise.resolve(e):Promise.reject(new Error(e.statusText))}).then(function(e){return e.json()}).then(function(e){var t=e.entries.filter(function(e){return e.name}).map(function(e){return{id:e.vesselId,label:e.name,type:"vessel"}}).filter(function(e){return!n.includes(e.id)});s({type:"endSearch",payload:t})}).catch(function(e){"AbortError"!==e.name&&console.error("Oops!",e),s({type:"endSearch",payload:[]})}),function(){return p.abort()}}},[u,l,c]),[o,s]}(e.staticOptions,""),o=Object(f.a)(i,2),s=o[0],u=o[1],c=s.results,l=s.loading,h=s.cachedResults,d=Object(n.useMemo)(function(){return re()(function(e){u({type:"inputChange",payload:e})},100)},[u]),_=Object(n.useCallback)(function(e,t){if(e.hasOwnProperty("inputValue")){var r=t.inputValue,n=void 0===r?"":r,a=t.selectedItem;d({search:n||"",selectedItem:a})}},[d]),m=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" ",n=e.selectedItem||[],a=n.some(function(e){return e.type===t.selectedItem.type}),i=q.includes(t.selectedItem.type),o=Object(p.a)(n);i&&!a||!i?o.push(t.selectedItem):o=o.map(function(e){return e.type===t.selectedItem.type?t.selectedItem:e});var s=V(o,r);return Object(P.a)({},t,{selectedItem:o,inputValue:s})},y=function(e,t){var r=e?function(e){return e.split(" ").filter(function(e){return e}).map(function(e){var t=e.split(":"),r=Object(f.a)(t,2),n=r[0],a=r[1];return{type:n,labels:a?a.split(",").map(N).filter(function(e){return e}):[]}})}(e):null;return null!==r?t.filter(function(e){return void 0!==r.find(function(t){return t.type===e.type&&void 0!==t.labels&&t.labels.includes(e.label)})}):[]},g=Object(n.useCallback)(function(e,t){var r={};if(!t.selectedItem||!e.selectedItem)return t;if(e.selectedItem.length===t.selectedItem.length)return t;var n=W()(t.selectedItem,"id").filter(function(e){return!!e&&(void 0!==r[e.type]?!q.includes(e.type):(r[e.type]=!0,!0))}),a=V(n);return Object(P.a)({},t,{inputValue:a,selectedItem:n})},[]),b=Object(n.useCallback)(function(e,t){var r=t.inputValue||"",n=e.selectedItem||[],a=W()([].concat(Object(p.a)(n),Object(p.a)(h)),"id"),i=y(r,a),o=function(e,t){if(!e||!t)return 0;for(var r=Math.max(t.length,e.length),n=0;n<r;n++){if(void 0===e[n])return n-1;if(e[n]!==t[n])return n}return 0}(t.inputValue||"",e.inputValue||"");return u({type:"setCursorPosition",payload:o}),Object(P.a)({},t,{selectedItem:i,isOpen:""!==r&&","!==r[o]})},[h,u]),v=Object(n.useCallback)(function(e,t){switch(t.type){case C.a.stateChangeTypes.keyDownEnter:case C.a.stateChangeTypes.clickItem:return m(e,t);case"keyDownComa":return m(e,t,"");case"externalChanges":return g(e,t);case C.a.stateChangeTypes.changeInput:return b(e,t);default:return Object(P.a)({},t,{inputValue:t.inputValue||e.inputValue||"",selectedItem:t.selectedItem||e.selectedItem||[]})}},[b,g]),S=Object(n.useCallback)(function(e,t){if("ArrowLeft"===e.key||"ArrowRight"===e.key||"click"===e.type){var r=e.target.selectionStart;u({type:"setCursorPosition",payload:r})}var n=t.highlightedIndex,a=t.inputValue,i=t.setState,o=""!==a&&" "!==a,s=" "===e.key,l=","===e.key,p=1===c.length;if(o&&(s||l)&&p&&(e.nativeEvent.preventDownshiftDefault=!0,null!==n&&n>=0)){var f=c[n];f&&i({type:"keyDownComa",selectedItem:f,inputValue:a})}},[u,c]),O=Object(n.useCallback)(function(e){return e?e.label:""},[]),I=Object(n.useMemo)(function(){return null!==t?V(t):""},[t]),E=Object(n.useMemo)(function(){return t||[]},[t]),T=Object(n.useRef)(null),w=Object(n.useCallback)(function(e){T.current=e},[]);return Object(n.useEffect)(function(){null!==T.current&&(0,T.current.setState)({type:"externalChanges",selectedItem:t})},[t]),a.a.createElement(K,{items:c,loading:l,onChange:r,setDownshiftRef:w,downshiftRefLoaded:null!==T.current,itemToString:O,stateReducer:v,selectedItems:t,initialSelection:E,initialInputValue:I,customEventHandler:S,onStateChange:_})},ae=r(209),ie=r(210),oe=r(218),se=r(211),ue=r(219),ce=r(48),le=r.n(ce),pe=function(e){function t(){var e,r;Object(ae.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(r=Object(oe.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(i)))).input=a.a.createRef(),r.itemToString=function(e){return e?e.label:""},r.handleChange=function(e){r.props.selectedItems.includes(e)?r.props.onRemoveItem(e):r.props.onSelectedItem(e)},r}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"getItems",value:function(e){return e?Object($.a)(this.props.options,e,{keys:["label"]}):this.props.options}},{key:"stateReducer",value:function(e,t){switch(t.type){case C.a.stateChangeTypes.keyDownEnter:case C.a.stateChangeTypes.clickItem:return Object(P.a)({},t,{highlightedIndex:e.highlightedIndex,isOpen:!0,inputValue:""});default:return t}}},{key:"render",value:function(){var e=this,t=this.props,r=t.selectedItems,n=t.onRemoveItem;return a.a.createElement(C.a,{stateReducer:this.stateReducer,selectedItem:null,onChange:this.handleChange,itemToString:this.itemToString},function(t){var i=t.getInputProps,o=t.getToggleButtonProps,s=t.getMenuProps,u=t.isOpen,c=t.inputValue,l=t.getItemProps,p=t.highlightedIndex,f=t.toggleMenu;return a.a.createElement("div",{className:le.a.container},a.a.createElement("div",{onClick:function(){f(),!u&&null!==e.input.current&&e.input.current.focus()}},a.a.createElement("div",{className:le.a.selections},r.length>0?r.map(function(e){return a.a.createElement("div",{key:e.id,className:le.a.selectionItem},a.a.createElement("div",null,a.a.createElement("span",null,e.label),a.a.createElement("button",{onClick:function(t){t.stopPropagation(),n(e)},className:le.a.selectionItemRemoveBtn},"\ud835\ude05")))}):"Select a value",a.a.createElement("input",Object.assign({},i({ref:e.input,onKeyUp:function(e){"Backspace"!==e.key||c||n(r[r.length-1])}}),{className:le.a.inputText}))),a.a.createElement("button",Object.assign({},o({onClick:function(e){e.stopPropagation()}}),{className:le.a.toggleBtn}),a.a.createElement("svg",{viewBox:"0 0 20 20",preserveAspectRatio:"none",width:16,fill:"transparent",stroke:"#979797",strokeWidth:"1.1px",transform:u?"rotate(180)":void 0},a.a.createElement("path",{d:"M1,6 L10,15 L19,6"})))),a.a.createElement("ul",Object.assign({},s(),{className:le.a.listContainer}),u?e.getItems(c).map(function(e,t){return a.a.createElement("li",Object.assign({key:e.id},l({item:e,index:t}),{style:{backgroundColor:p===t?"#ccc":"transparent",color:r.includes(e)?"#0f0f0f":"#000"}}),e.label)}):null))})}}]),t}(a.a.Component),fe=function(e){return e?"".concat(e.getFullYear(),"/").concat(e.getMonth()+1,"/").concat(e.getDate()):""},he=[2017],de=he.flatMap(function(e){return Array.from(Array(12).keys()).reduce(function(t,r){var n=new Date(Date.UTC(e,r+1,0)).getDate(),a=Array.from(Array(n).keys()).reduce(function(t,n){var a=new Date(Date.UTC(e,r,n+1));return t.push({id:a.toISOString(),label:fe(a)}),t},[]);return[].concat(Object(p.a)(t),Object(p.a)(a))},[])}),_e=new Date(Date.UTC(he[he.length-1]+1,0)),me={id:_e.toISOString(),label:fe(_e)},ye=[{id:"ICCAT",label:"ICCAT"},{id:"IOTC",label:"IOTC"},{id:"WCPFC",label:"WCPFC"},{id:"IATTC",label:"IATTC"},{id:"AIDCP",label:"AIDCP"},{id:"CCSBT",label:"CCSBT"}].map(function(e){return Object(P.a)({},e,{type:z.rfmo})}),ge=[{id:"ABW",label:"Aruba"},{id:"AFG",label:"Afghanistan"},{id:"AGO",label:"Angola"},{id:"AIA",label:"Anguilla"},{id:"ALA",label:"\xc5land Islands"},{id:"ALB",label:"Albania"},{id:"AND",label:"Andorra"},{id:"ARE",label:"United Arab Emirates"},{id:"ARG",label:"Argentina"},{id:"ARM",label:"Armenia"},{id:"ASM",label:"American Samoa"},{id:"ATA",label:"Antarctica"},{id:"ATF",label:"French Southern and Antarctic Lands"},{id:"ATG",label:"Antigua and Barbuda"},{id:"AUS",label:"Australia"},{id:"AUT",label:"Austria"},{id:"AZE",label:"Azerbaijan"},{id:"BDI",label:"Burundi"},{id:"BEL",label:"Belgium"},{id:"BEN",label:"Benin"},{id:"BFA",label:"Burkina Faso"},{id:"BGD",label:"Bangladesh"},{id:"BGR",label:"Bulgaria"},{id:"BHR",label:"Bahrain"},{id:"BHS",label:"Bahamas"},{id:"BIH",label:"Bosnia and Herzegovina"},{id:"BLM",label:"Saint Barth\xe9lemy"},{id:"SHN",label:"Saint Helena Ascension and Tristan da Cunha"},{id:"BLR",label:"Belarus"},{id:"BLZ",label:"Belize"},{id:"BMU",label:"Bermuda"},{id:"BOL",label:"Bolivia"},{id:"BES",label:"Caribbean Netherlands"},{id:"BRA",label:"Brazil"},{id:"BRB",label:"Barbados"},{id:"BRN",label:"Brunei"},{id:"BTN",label:"Bhutan"},{id:"BVT",label:"Bouvet Island"},{id:"BWA",label:"Botswana"},{id:"CAF",label:"Central African Republic"},{id:"CAN",label:"Canada"},{id:"CCK",label:"Cocos (Keeling) Islands"},{id:"CHE",label:"Switzerland"},{id:"CHL",label:"Chile"},{id:"CHN",label:"China"},{id:"CIV",label:"Ivory Coast"},{id:"CMR",label:"Cameroon"},{id:"COD",label:"DR Congo"},{id:"COG",label:"Republic of the Congo"},{id:"COK",label:"Cook Islands"},{id:"COL",label:"Colombia"},{id:"COM",label:"Comoros"},{id:"CPV",label:"Cape Verde"},{id:"CRI",label:"Costa Rica"},{id:"CUB",label:"Cuba"},{id:"CUW",label:"Cura\xe7ao"},{id:"CXR",label:"Christmas Island"},{id:"CYM",label:"Cayman Islands"},{id:"CYP",label:"Cyprus"},{id:"CZE",label:"Czechia"},{id:"DEU",label:"Germany"},{id:"DJI",label:"Djibouti"},{id:"DMA",label:"Dominica"},{id:"DNK",label:"Denmark"},{id:"DOM",label:"Dominican Republic"},{id:"DZA",label:"Algeria"},{id:"ECU",label:"Ecuador"},{id:"EGY",label:"Egypt"},{id:"ERI",label:"Eritrea"},{id:"ESH",label:"Western Sahara"},{id:"ESP",label:"Spain"},{id:"EST",label:"Estonia"},{id:"ETH",label:"Ethiopia"},{id:"FIN",label:"Finland"},{id:"FJI",label:"Fiji"},{id:"FLK",label:"Falkland Islands"},{id:"FRA",label:"France"},{id:"FRO",label:"Faroe Islands"},{id:"FSM",label:"Micronesia"},{id:"GAB",label:"Gabon"},{id:"GBR",label:"United Kingdom"},{id:"GEO",label:"Georgia"},{id:"GGY",label:"Guernsey"},{id:"GHA",label:"Ghana"},{id:"GIB",label:"Gibraltar"},{id:"GIN",label:"Guinea"},{id:"GLP",label:"Guadeloupe"},{id:"GMB",label:"Gambia"},{id:"GNB",label:"Guinea-Bissau"},{id:"GNQ",label:"Equatorial Guinea"},{id:"GRC",label:"Greece"},{id:"GRD",label:"Grenada"},{id:"GRL",label:"Greenland"},{id:"GTM",label:"Guatemala"},{id:"GUF",label:"French Guiana"},{id:"GUM",label:"Guam"},{id:"GUY",label:"Guyana"},{id:"HKG",label:"Hong Kong"},{id:"HMD",label:"Heard Island and McDonald Islands"},{id:"HND",label:"Honduras"},{id:"HRV",label:"Croatia"},{id:"HTI",label:"Haiti"},{id:"HUN",label:"Hungary"},{id:"IDN",label:"Indonesia"},{id:"IMN",label:"Isle of Man"},{id:"IND",label:"India"},{id:"IOT",label:"British Indian Ocean Territory"},{id:"IRL",label:"Ireland"},{id:"IRN",label:"Iran"},{id:"IRQ",label:"Iraq"},{id:"ISL",label:"Iceland"},{id:"ISR",label:"Israel"},{id:"ITA",label:"Italy"},{id:"JAM",label:"Jamaica"},{id:"JEY",label:"Jersey"},{id:"JOR",label:"Jordan"},{id:"JPN",label:"Japan"},{id:"KAZ",label:"Kazakhstan"},{id:"KEN",label:"Kenya"},{id:"KGZ",label:"Kyrgyzstan"},{id:"KHM",label:"Cambodia"},{id:"KIR",label:"Kiribati"},{id:"KNA",label:"Saint Kitts and Nevis"},{id:"KOR",label:"South Korea"},{id:"UNK",label:"Kosovo"},{id:"KWT",label:"Kuwait"},{id:"LAO",label:"Laos"},{id:"LBN",label:"Lebanon"},{id:"LBR",label:"Liberia"},{id:"LBY",label:"Libya"},{id:"LCA",label:"Saint Lucia"},{id:"LIE",label:"Liechtenstein"},{id:"LKA",label:"Sri Lanka"},{id:"LSO",label:"Lesotho"},{id:"LTU",label:"Lithuania"},{id:"LUX",label:"Luxembourg"},{id:"LVA",label:"Latvia"},{id:"MAC",label:"Macau"},{id:"MAF",label:"Saint Martin"},{id:"MAR",label:"Morocco"},{id:"MCO",label:"Monaco"},{id:"MDA",label:"Moldova"},{id:"MDG",label:"Madagascar"},{id:"MDV",label:"Maldives"},{id:"MEX",label:"Mexico"},{id:"MHL",label:"Marshall Islands"},{id:"MKD",label:"Macedonia"},{id:"MLI",label:"Mali"},{id:"MLT",label:"Malta"},{id:"MMR",label:"Myanmar"},{id:"MNE",label:"Montenegro"},{id:"MNG",label:"Mongolia"},{id:"MNP",label:"Northern Mariana Islands"},{id:"MOZ",label:"Mozambique"},{id:"MRT",label:"Mauritania"},{id:"MSR",label:"Montserrat"},{id:"MTQ",label:"Martinique"},{id:"MUS",label:"Mauritius"},{id:"MWI",label:"Malawi"},{id:"MYS",label:"Malaysia"},{id:"MYT",label:"Mayotte"},{id:"NAM",label:"Namibia"},{id:"NCL",label:"New Caledonia"},{id:"NER",label:"Niger"},{id:"NFK",label:"Norfolk Island"},{id:"NGA",label:"Nigeria"},{id:"NIC",label:"Nicaragua"},{id:"NIU",label:"Niue"},{id:"NLD",label:"Netherlands"},{id:"NOR",label:"Norway"},{id:"NPL",label:"Nepal"},{id:"NRU",label:"Nauru"},{id:"NZL",label:"New Zealand"},{id:"OMN",label:"Oman"},{id:"PAK",label:"Pakistan"},{id:"PAN",label:"Panama"},{id:"PCN",label:"Pitcairn Islands"},{id:"PER",label:"Peru"},{id:"PHL",label:"Philippines"},{id:"PLW",label:"Palau"},{id:"PNG",label:"Papua New Guinea"},{id:"POL",label:"Poland"},{id:"PRI",label:"Puerto Rico"},{id:"PRK",label:"North Korea"},{id:"PRT",label:"Portugal"},{id:"PRY",label:"Paraguay"},{id:"PSE",label:"Palestine"},{id:"PYF",label:"French Polynesia"},{id:"QAT",label:"Qatar"},{id:"REU",label:"R\xe9union"},{id:"ROU",label:"Romania"},{id:"RUS",label:"Russia"},{id:"RWA",label:"Rwanda"},{id:"SAU",label:"Saudi Arabia"},{id:"SDN",label:"Sudan"},{id:"SEN",label:"Senegal"},{id:"SGP",label:"Singapore"},{id:"SGS",label:"South Georgia"},{id:"SJM",label:"Svalbard and Jan Mayen"},{id:"SLB",label:"Solomon Islands"},{id:"SLE",label:"Sierra Leone"},{id:"SLV",label:"El Salvador"},{id:"SMR",label:"San Marino"},{id:"SOM",label:"Somalia"},{id:"SPM",label:"Saint Pierre and Miquelon"},{id:"SRB",label:"Serbia"},{id:"SSD",label:"South Sudan"},{id:"STP",label:"S\xe3o Tom\xe9 and Pr\xedncipe"},{id:"SUR",label:"Suriname"},{id:"SVK",label:"Slovakia"},{id:"SVN",label:"Slovenia"},{id:"SWE",label:"Sweden"},{id:"SWZ",label:"Eswatini"},{id:"SXM",label:"Sint Maarten"},{id:"SYC",label:"Seychelles"},{id:"SYR",label:"Syria"},{id:"TCA",label:"Turks and Caicos Islands"},{id:"TCD",label:"Chad"},{id:"TGO",label:"Togo"},{id:"THA",label:"Thailand"},{id:"TJK",label:"Tajikistan"},{id:"TKL",label:"Tokelau"},{id:"TKM",label:"Turkmenistan"},{id:"TLS",label:"Timor-Leste"},{id:"TON",label:"Tonga"},{id:"TTO",label:"Trinidad and Tobago"},{id:"TUN",label:"Tunisia"},{id:"TUR",label:"Turkey"},{id:"TUV",label:"Tuvalu"},{id:"TWN",label:"Taiwan"},{id:"TZA",label:"Tanzania"},{id:"UGA",label:"Uganda"},{id:"UKR",label:"Ukraine"},{id:"UMI",label:"United States Minor Outlying Islands"},{id:"URY",label:"Uruguay"},{id:"USA",label:"United States"},{id:"UZB",label:"Uzbekistan"},{id:"VAT",label:"Vatican City"},{id:"VCT",label:"Saint Vincent and the Grenadines"},{id:"VEN",label:"Venezuela"},{id:"VGB",label:"British Virgin Islands"},{id:"VIR",label:"United States Virgin Islands"},{id:"VNM",label:"Vietnam"},{id:"VUT",label:"Vanuatu"},{id:"WLF",label:"Wallis and Futuna"},{id:"WSM",label:"Samoa"},{id:"YEM",label:"Yemen"},{id:"ZAF",label:"South Africa"},{id:"ZMB",label:"Zambia"},{id:"ZWE",label:"Zimbabwe"}].map(function(e){return Object(P.a)({},e,{type:z.flag})}),be=Array.from(Array(500).keys()).map(function(e){return{id:e.toString(),label:"Port ".concat(e),type:z.port}}),ve=de.map(function(e){return Object(P.a)({},e,{type:z.after})}),Se=de.map(function(e){return Object(P.a)({},e,{type:z.before})});Se.push(Object(P.a)({},me,{type:z.before}));var Oe=[].concat(Object(p.a)(ye),Object(p.a)(ge),Object(p.a)(be),Object(p.a)(ve),Object(p.a)(Se)),Ie=function(){var e=Object(n.useMemo)(function(){var e=w.a.parse(window.location.search,{ignoreQueryPrefix:!0});return e&&e.search?e.search:[]},[]),t=Object(n.useState)(e),r=Object(f.a)(t,2),i=r[0],o=r[1],s=Object(n.useCallback)(function(e){o(e);var t=w.a.stringify({search:e},{addQueryPrefix:!0}),r=window.location.origin+window.location.pathname+t;window.history.replaceState(window.history.state,"",r)},[]),u=Object(n.useMemo)(function(){return U(i||[])},[i]),c=function(e){o([].concat(Object(p.a)(i),[e]))},l=function(e){o(i.filter(function(t){return t!==e}))},h=function(e){return i.filter(function(t){return t.type===e})};return a.a.createElement("div",{className:M.a.app},a.a.createElement(ne,{staticOptions:Oe,selectedItems:i,onChange:s}),a.a.createElement("div",null,a.a.createElement("button",{onClick:function(){o([])}},"Remove selection")),a.a.createElement("div",null,a.a.createElement(pe,{options:ge,selectedItems:h("flag"),onSelectedItem:c,onRemoveItem:l}),a.a.createElement(pe,{options:ye,selectedItems:h("rfmo"),onSelectedItem:c,onRemoveItem:l})),a.a.createElement("div",{className:M.a.selectionContainer},a.a.createElement("h2",null,"Current filter selection by"),null!==u?a.a.createElement("ul",{className:M.a.selectionList},Object.keys(z).map(function(e){return a.a.createElement("li",{key:e},a.a.createElement("strong",null,(t=e).charAt(0).toUpperCase()+t.slice(1)),":"," ",void 0!==u[e]?u[e].values.map(function(t,r){return a.a.createElement("span",{key:t.id},e===z.flag&&a.a.createElement(E,{iso:t.id}),t.label,"(",t.id,")",r===u[e].values.length-1?"":",")}):a.a.createElement("span",null,"no filter"));var t})):a.a.createElement("span",null,"none")))},Ee=r(216),Te=r(212),we=r(94),Ae=r.n(we),Me=(r(327),r(122)),Pe=r.n(Me),Le=Pe()(new Date(2017,0,1)),xe=Pe()(new Date(2017,11,31)),Ce=function(){var e={rfmo:{duration:[1,100,"day"]},event:{duration:[10,300,"hour"],interval:[0,25,"day"]}},t={};return Object.keys(e).forEach(function(r){for(var n=e[r],a=n.duration[1]-n.duration[0],i=n.interval?n.interval[1]-n.interval[0]:null,o=[],s=0;;){var u=o.length?o[o.length-1]:null,c=n.duration[0]+Math.random()*a,l=u?u.end.clone():Le.clone();if(n.interval){var p=n.interval[0]+Math.random()*i;l=l.add(p,n.interval[2])}var f=l.add(c,n.duration[2]),h={id:s,start:l,end:f};if(f.isAfter(xe)){h.end=xe.clone(),o.push(h);break}o.push(h),s++}t[r]=o}),t.event=t.event.map(function(e){return Object(P.a)({},e,{encounteredVessel:Math.random()>.5?null:"other:".concat(e.id)})}),t}(),Re=!1,je=function(e){var t=e.events,r=e.rfmos,i=Object(n.useRef)(new Map).current,o=Object(n.useState)(null),s=Object(f.a)(o,2),u=s[0],c=s[1],l=Object(n.useCallback)(function(){Re=!1;var e=document.documentElement.clientHeight,t=window.innerHeight||0,r=60+Math.max(e,t)/2,n=Number.POSITIVE_INFINITY,a=null;i.forEach(function(e,t){e.classList.toggle("selected",!1);var i=e.getBoundingClientRect().top,o=Math.abs(r-i);o<n&&(a=t,n=o)}),c(a)},[i]),p=Object(n.useCallback)(function(){!1===Re&&(Re=!0,window.requestAnimationFrame(l))},[l]);Object(n.useEffect)(function(){return console.log("useEffect:adding scroll listener on mount"),window.addEventListener("scroll",p,!0),function(){window.removeEventListener("scroll",p,!0)}},[p]);var h=Object(n.useMemo)(function(){return function(e,t){var r=Object(Ee.a)().domain([Le.toDate(),xe.toDate()]).range([0,1]),n=function(e){return r(e)},a=function(e){return"".concat(100*e,"%")},i=function(e){return e.map(function(e){var t=e.start.toDate(),r=e.end.toDate(),i=n(t),o=n(r),s=o-i,u=i+s/2;return Object(P.a)({},e,{startNormalized:i,endNormalized:o,startCoord:a(i),endCoord:a(o),middleNormalized:u,middleCoord:a(u),height:a(s)})})};return{events:i(e),rfmos:i(t)}}(t,r)},[t,r]),d=Object(n.useMemo)(function(){return function(e,t){var r=e.events.find(function(e){return e.id===t}),n=r?r.middleCoord:0,a=void 0===r?null:e.rfmos.find(function(e){return r.middleNormalized>e.startNormalized&&r.middleNormalized<e.endNormalized});return{y:n,currentRfmoId:a?a.id:null,currentEvent:r}}(h,u)},[h,u]),_=Object(n.useState)(null),m=Object(f.a)(_,2),y=m[0],g=m[1],b=Object(n.useRef)(Object(Te.debounce)(function(e){console.log(e.encounteredVessel),setTimeout(function(){return g(e.encounteredVessel)},200)},1e3));return Object(n.useEffect)(function(){console.log("useEffect:selected event changed - load encountered vessel on debounce"),g(null),b.current.cancel(),console.log(d.currentEvent),null!==u&&null!==d.currentEvent.encounteredVessel&&b.current(d.currentEvent)},[u,d]),console.log(y),a.a.createElement(n.Fragment,null,a.a.createElement("div",{className:"top"},"top"),a.a.createElement("div",{className:"map"},"map"),a.a.createElement("div",{className:"page"},a.a.createElement("div",{className:"profile"},a.a.createElement("img",{alt:"dummy",src:"http://placekitten.com/".concat(Math.floor(100+200*Math.random()),"/").concat(Math.floor(100+200*Math.random()))}),"vessel profile",a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null)),a.a.createElement("div",{className:"timeline"},a.a.createElement("svg",null,a.a.createElement("g",{className:"eventsColumn"},h.events.map(function(e){return a.a.createElement("rect",{x:0,y:e.startCoord,key:e.id,width:10,height:e.height,className:Ae()({highlighted:e.id===u})})})),a.a.createElement("g",{className:"rfmosColumn"},h.rfmos.map(function(e){return a.a.createElement("rect",{x:0,y:e.startCoord,key:e.id,width:10,height:e.height,className:Ae()({highlighted:e.id===d.currentRfmoId})})})),a.a.createElement("line",{x1:"0%",x2:"100%",style:{transform:"translateY(".concat(d.y,")")}}))),a.a.createElement("div",{className:"detail"},h.events.map(function(e){return a.a.createElement("div",{ref:function(t){return null===t?i.delete(e.id):i.set(e.id,t)},className:Ae()("event",{highlighted:e.id===u}),key:e.id},"Event ",e.id,a.a.createElement("br",null),null!==e.encounteredVessel&&a.a.createElement("div",null,"I'm an encounter!"),e.start.format("DD/MM/YYYY HH:mm"),a.a.createElement("br",null),e.end.format("DD/MM/YYYY HH:mm"),a.a.createElement("br",null),e.id===u&&null!==y&&a.a.createElement("div",{className:"encounteredVessel"},y))}))))},ke=Ce,De=function(){var e=Object(n.useState)(!0),t=Object(f.a)(e,2),r=t[0];t[1];return a.a.createElement(n.Fragment,null,a.a.createElement(je,{events:ke.event,rfmos:ke.rfmo,visible:r}))};var Ne=r(10),Fe=r(77),Be=r(38),Ue=r(4),Ve=r(72),ze=r(59),He=(r(153),r(58)),Ge=function(e,t,r){var n=e%360/parseFloat(360)*6,a=100===t?1:t%100/parseFloat(100),i=100===r?1:r%100/parseFloat(100),o=Math.floor(n),s=n-o,u=i*(1-a),c=i*(1-s*a),l=i*(1-(1-s)*a),p=o%6,f=[i,c,u,u,l,i][p],h=[l,i,i,c,u,u][p],d=[u,u,l,i,i,c][p];return{r:Math.round(255*f),g:Math.round(255*h),b:Math.round(255*d)}},qe=function(e){return Ge(e,50,100)},Ke=function(e){var t=qe(e);return"rgb(".concat(t.r,", ").concat(t.g,", ").concat(t.b,")")},$e=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},Ye=function(e){return 12*e},We=function(e){return e%360},Ze={version:8,glyphs:"https://raw.githubusercontent.com/GlobalFishingWatch/map-gl-glyphs/master/_output/{fontstack}/{range}.pbf?raw=true",sprite:"https://raw.githubusercontent.com/GlobalFishingWatch/map-gl-sprites/master/out/sprites",metadata:{"mapbox:groups":{"basemap-background":{name:"basemap-background"},static:{name:"static"},temporal:{name:"temporal"},tracks:{name:"tracks"},"basemap-foreground":{name:"basemap-foreground"}},"gfw:basemap-layers":[{id:"satellite",label:"Satellite"},{id:"north-star",label:"North Star"},{id:"labels",isOption:!0},{id:"graticules",isOption:!0},{id:"bathymetry",isOption:!0}],"gfw:styles":{selected:{fill:{"fill-color":["rgba($REFLAYER_COLOR_RGB, 0.5)","rgba(0,0,0,0)"]},circle:{"circle-stroke-width":[2,.5],"circle-stroke-color":["rgba(0,0,0,0)","rgba(0,0,0,0)"],"circle-radius":[15,0]}},highlighted:{circle:{"circle-stroke-color":["#fff","#000"]}}}},sources:{6:{metadata:{"gfw:carto-sql":"select * from kkp_regions","gfw:popups":[{id:"nama"},{id:"POLYGON_LAYERS_AREA"}]},type:"vector"},satellite:{tiles:["https://gtiles-dot-world-fishing-827.appspot.com/v1/tileset/sat/tile?x={x}&y={y}&z={z}"],type:"raster",tileSize:256,attribution:"Map data \xa92018 Google, \xa92018 NASA, INEGI, TerraMetrics \xb7 <a href='https://www.google.com/intl/en-GB_US/help/terms_maps.html'>Terms of Use</a><br>"},"north-star":{tiles:["https://gtiles-dot-world-fishing-827.appspot.com/v1/tileset/ns/tile?x={x}&y={y}&z={z}"],type:"raster",tileSize:256},labels:{tiles:["https://gtiles-dot-world-fishing-827.appspot.com/v1/tileset/nslabels/tile?x={x}&y={y}&z={z}"],type:"raster",tileSize:256},graticules:{metadata:{"gfw:carto-sql":"select * from graticules where scalerank=4"},type:"vector"},bathymetry:{metadata:{"gfw:carto-sql":"SELECT * FROM bathymetry order by depth"},type:"vector"},mpant:{metadata:{"gfw:carto-sql":"select * FROM wdpa_no_take_mpas","gfw:popups":[{id:"name"},{id:"wdpaid",label:"WDPA ID"},{id:"iucn_cat",label:"IUCN Category"},{id:"desig_eng",label:"Designation"},{id:"rep_area"},{id:"no_take"},{id:"status"},{id:"status_yr"},{id:"gov_type"},{id:"mang_auth"},{id:"verif"},{id:"iso3"}]},type:"vector"},mparu:{metadata:{"gfw:carto-sql":"SELECT * FROM wdpa_restricted_use_mpas","gfw:popups":[{id:"name"},{id:"wdpaid",label:"WDPA ID"},{id:"iucn_cat",label:"IUCN Category"},{id:"desig_eng",label:"Designation"},{id:"rep_area"},{id:"no_take"},{id:"status"},{id:"status_yr"},{id:"gov_type"},{id:"mang_auth"},{id:"verif"},{id:"iso3"}]},type:"vector"},eez:{metadata:{"gfw:carto-sql":"SELECT cartodb_id, the_geom, the_geom_webmercator, geoname as name, 'eez:' || mrgid as region_id, geoname as reporting_name, 'eez:' || mrgid as reporting_id FROM eez","gfw:popups":[{id:"name"}]},type:"vector",attribution:"EEZs: marineregions.org"},highseas:{metadata:{"gfw:carto-sql":"SELECT *, lower(regionid) as region_id FROM highseas","gfw:popups":[{id:"regionid"},{id:"POLYGON_LAYERS_AREA"}]},type:"vector"},protectedplanet:{metadata:{"gfw:carto-sql":"SELECT * from protectedplanet","gfw:popups":[{id:"name"},{id:"wdpaid",label:"WDPA ID"},{id:"iucn_cat",label:"IUCN Category"},{id:"desig_eng",label:"Designation"},{id:"rep_area"},{id:"no_take"},{id:"status"},{id:"status_yr"},{id:"gov_type"},{id:"mang_auth"},{id:"verif"},{id:"iso3"}]},type:"vector",attribution:"MPAs: www.protectedplanet.net"},rfmo:{metadata:{"gfw:carto-sql":"SELECT the_geom, the_geom_webmercator, cartodb_id, 'rfmo:' || rfb as reporting_id, 'rfmo:' || rfb as region_id, rfb as reporting_name, rfb FROM rfmo","gfw:popups":[{id:"rfb"},{id:"POLYGON_LAYERS_AREA"}]},type:"vector"},falklands_conservation:{metadata:{"gfw:carto-sql":"SELECT * FROM falklands_conservation","gfw:popups":[{id:"full_name"},{id:"zone"},{id:"area_sqkm"}]},type:"vector"},encounters_ais:{type:"vector",tiles:["https://api-dot-skytruth-pelagos-production.appspot.com/v2/tilesets/gfw-task-673-encounters-v3/{z},{x},{y}"]},events_fishing:{type:"vector",tiles:["https://events-dot-world-fishing-827.appspot.com/datasets/indonesia/events/fishing/tiles/{z},{x},{y}"]},events_encounter:{type:"vector",tiles:["https://events-dot-world-fishing-827.appspot.com/datasets/indonesia/events/encounter/tiles/{z},{x},{y}"],metadata:{"gfw:popups":[{id:"event_id"}]}},events_gap:{type:"vector",tiles:["https://events-dot-world-fishing-827.appspot.com/datasets/indonesia/events/gap/tiles/{z},{x},{y}"],metadata:{"gfw:popups":[{id:"event_id"}]}},events_port:{type:"vector",tiles:["https://events-dot-world-fishing-827.appspot.com/datasets/indonesia/events/port/tiles/{z},{x},{y}"],metadata:{"gfw:popups":[{id:"event_id"}]}},events_encounter_vessel:{type:"geojson",cluster:!0,clusterMaxZoom:10,data:{type:"FeatureCollection",features:[]}},events_gap_vessel:{type:"geojson",cluster:!0,clusterMaxZoom:10,data:{type:"FeatureCollection",features:[]}},events_port_vessel:{type:"geojson",cluster:!0,clusterMaxZoom:10,data:{type:"FeatureCollection",features:[]}}},layers:[{id:"background",metadata:{"mapbox:group":"basemap-background"},type:"background",layout:{visibility:"visible"},paint:{"background-color":"#001436"}},{id:"satellite",metadata:{"mapbox:group":"basemap-background"},type:"raster",source:"satellite",layout:{visibility:"visible"}},{id:"north-star",metadata:{"mapbox:group":"basemap-background"},type:"raster",source:"north-star"},{id:"bathymetry",metadata:{"mapbox:group":"basemap-background"},type:"fill",source:"bathymetry","source-layer":"bathymetry",paint:{"fill-color":["step",["get","depth"],"#1e346c",1e3,"#1a2f63",2e3,"#142655",3e3,"#101f4a",4e3,"#0d1b43",5e3,"#0a163b",6e3,"#061132",7e3,"#030d2a",8e3,"#01081e"],"fill-outline-color":"hsla(0, 0%, 100%, 0)","fill-opacity":["interpolate",["linear"],["zoom"],3,0,4,1]}},{id:"mpant",metadata:{"mapbox:group":"static"},type:"fill",source:"mpant","source-layer":"mpant"},{id:"mpant-labels",metadata:{"gfw:isLabel":!0,"mapbox:group":"static"},type:"symbol",source:"mpant","source-layer":"mpant",layout:{"text-field":"{name}","text-font":["Roboto Mono Light"],"text-size":10}},{id:"mparu",metadata:{"mapbox:group":"static"},type:"fill",source:"mparu","source-layer":"mparu"},{id:"mparu-labels",metadata:{"gfw:isLabel":!0,"mapbox:group":"static"},type:"symbol",source:"mparu","source-layer":"mparu",layout:{"text-field":"{name}","text-font":["Roboto Mono Light"],"text-size":10}},{id:"eez",metadata:{"mapbox:group":"static"},type:"fill",source:"eez","source-layer":"eez"},{id:"eez-labels",metadata:{"gfw:isLabel":!0,"mapbox:group":"static"},type:"symbol",source:"eez","source-layer":"eez",layout:{"text-field":"{name}","text-font":["Roboto Mono Light"],"text-size":10}},{id:"highseas",metadata:{"mapbox:group":"static"},type:"fill",source:"highseas","source-layer":"highseas"},{id:"highseas-labels",metadata:{"gfw:isLabel":!0,"mapbox:group":"static"},type:"symbol",source:"highseas","source-layer":"highseas",layout:{"text-field":"{regionid}","text-font":["Roboto Mono Light"],"text-size":10}},{id:"rfmo",metadata:{"mapbox:group":"static"},type:"fill",source:"rfmo","source-layer":"rfmo"},{id:"rfmo-labels",metadata:{"gfw:isLabel":!0,"mapbox:group":"static"},type:"symbol",source:"rfmo","source-layer":"rfmo",layout:{"text-field":"{reporting_name}","text-font":["Roboto Mono Light"],"text-size":10}},{id:"6",metadata:{"mapbox:group":"static"},type:"fill",source:"6","source-layer":"6"},{id:"6-labels",metadata:{"gfw:isLabel":!0,"mapbox:group":"static"},type:"symbol",source:"6","source-layer":"6",layout:{"text-field":"{nama}","text-font":["Roboto Mono Light"],"text-size":10}},{id:"protectedplanet",metadata:{"mapbox:group":"static"},type:"fill",source:"protectedplanet","source-layer":"protectedplanet"},{id:"protectedplanet-labels",metadata:{"gfw:isLabel":!0,"mapbox:group":"static"},type:"symbol",source:"protectedplanet","source-layer":"protectedplanet",layout:{"text-field":"{name}","text-font":["Roboto Mono Light"],"text-size":10}},{id:"falklands_conservation",metadata:{"mapbox:group":"static"},type:"fill",source:"falklands_conservation","source-layer":"falklands_conservation"},{id:"falklands_conservation-labels",metadata:{"gfw:isLabel":!0,"mapbox:group":"static"},type:"symbol",source:"falklands_conservation","source-layer":"falklands_conservation",layout:{"text-field":"{full_name}","text-font":["Roboto Mono Light"],"text-size":10}},{id:"events_fishing",metadata:{"gfw:temporal":!0,"mapbox:group":"temporal"},type:"circle",source:"events_fishing","source-layer":"default",paint:{"circle-radius":3,"circle-color":"#FE81EB","circle-stroke-width":.5,"circle-stroke-color":"#000000"}},{id:"events_encounter",metadata:{"gfw:temporal":!0,"mapbox:group":"temporal"},type:"circle",source:"events_encounter","source-layer":"default",paint:{"circle-radius":3,"circle-color":"#E5647D","circle-stroke-width":.5,"circle-stroke-color":"#000000"}},{id:"encounters_ais",type:"circle",source:"encounters_ais","source-layer":"points",metadata:{"gfw:temporal":!0,"gfw:temporalField":"timeIndex","mapbox:group":"temporal"},paint:{"circle-color":"#e5647d","circle-radius":3,"circle-opacity":.9}},{id:"encounters_ais_outline",type:"circle",source:"encounters_ais","source-layer":"points",metadata:{"gfw:temporal":!0,"gfw:temporalField":"timeIndex","gfw:mainColorPaintProperty":"circle-stroke-color","mapbox:group":"temporal"},paint:{"circle-color":"hsla(0, 0%, 0%, 0)","circle-stroke-color":"#e5647d","circle-stroke-width":1,"circle-radius":6}},{id:"events_gap",type:"circle",source:"events_gap","source-layer":"default",metadata:{"gfw:temporal":!0,"mapbox:group":"temporal"},paint:{"circle-radius":3,"circle-color":"#FFE7A0","circle-stroke-width":.5,"circle-stroke-color":"#000000"}},{id:"events_port",type:"circle",source:"events_port","source-layer":"default",metadata:{"gfw:temporal":!0,"mapbox:group":"temporal"},paint:{"circle-radius":3,"circle-color":"#44A1B9","circle-stroke-width":.5,"circle-stroke-color":"#000000"}},{id:"events_encounter_vessel",source:"events_encounter_vessel",type:"symbol",metadata:{"mapbox:group":"temporal","gfw:styles":{highlighted:{"icon-image":["encounter_highlight","encounter"]}}},layout:{"icon-image":"encounter","icon-allow-overlap":!0}},{id:"events_encounter_vessel_number",source:"events_encounter_vessel",type:"symbol",metadata:{"mapbox:group":"temporal"},filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["Roboto Medium"],"text-size":12,"text-anchor":"bottom-left","text-offset":[.8,-.2]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":2}},{id:"events_gap_vessel",source:"events_gap_vessel",type:"symbol",metadata:{"mapbox:group":"temporal","gfw:styles":{highlighted:{"icon-image":["gap_highlight","gap"]}}},layout:{"icon-image":"gap","icon-allow-overlap":!0}},{id:"events_gap_vessel_number",source:"events_gap_vessel",type:"symbol",metadata:{"mapbox:group":"temporal"},filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["Roboto Medium"],"text-size":12,"text-anchor":"bottom-left","text-offset":[.8,-.2]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":2}},{id:"events_port_vessel",source:"events_port_vessel",type:"symbol",metadata:{"mapbox:group":"temporal","gfw:styles":{highlighted:{"icon-image":["port_highlight","port"]}}},layout:{"icon-image":"port","icon-allow-overlap":!0}},{id:"events_port_vessel_number",source:"events_port_vessel",type:"symbol",metadata:{"mapbox:group":"temporal"},filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["Roboto Medium"],"text-size":12,"text-anchor":"bottom-left","text-offset":[.8,-.2]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":2}},{id:"graticules-lines",metadata:{"mapbox:group":"basemap-foreground"},type:"line",source:"graticules","source-layer":"graticules",filter:["==","$type","LineString"],paint:{"line-color":"#174084","line-opacity":{base:1,stops:[[0,.7],[8,.7],[9,.2]]},"line-width":.5}},{id:"graticules-labels",metadata:{"mapbox:group":"basemap-foreground"},type:"symbol",source:"graticules","source-layer":"graticules",filter:["==","$type","LineString"],layout:{"text-field":"{degrees}\xba","text-font":["Roboto Medium Italic"],"symbol-placement":"line","symbol-spacing":{base:1,stops:[[3,500],[8,1e3]]},"text-size":{base:1,stops:[[3,7],[7,12]]},"text-letter-spacing":.2},paint:{"text-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-translate":[-1,1],"text-halo-color":"hsla(0, 0%, 68%, 0.49)","text-opacity":{base:1,stops:[[0,1],[8,1],[9,0]]}}},{id:"labels",metadata:{"mapbox:group":"basemap-foreground"},type:"raster",source:"labels"}]},Xe=r(73),Je={id:S.string.isRequired,url:S.string,data:S.object,color:S.string,type:S.oneOf(["geojson",void 0]),layerTemporalExtents:S.arrayOf(S.arrayOf(S.number)),fitBoundsOnLoad:S.bool},Qe={id:S.string.isRequired,tilesetId:S.string,subtype:S.string,visible:S.bool,hue:S.number,opacity:S.number,filters:S.arrayOf(S.shape({hue:S.number,filterValues:S.object})),header:S.shape({endpoints:S.object,isPBF:S.bool,colsByName:S.object,temporalExtents:S.arrayOf(S.arrayOf(S.number)),temporalExtentsLess:S.bool}).isRequired,interactive:S.bool},et={id:S.string,visible:S.bool},tt={id:S.string.isRequired,visible:S.bool,selected:S.bool,selectedFeatures:S.shape({field:S.string,values:S.arrayOf(S.string)}),highlighted:S.bool,higlightedFeatures:S.shape({field:S.string,values:S.arrayOf(S.string)}),opacity:S.number,color:S.string,showLabels:S.bool,interactive:S.bool,filters:S.arrayOf(S.arrayOf(S.string)),isCustom:S.bool,subtype:S.oneOf([void 0,"geojson","raster"]),url:S.string,data:S.object,gl:S.object},rt={content:S.node,latitude:S.number.isRequired,longitude:S.number.isRequired},nt={zoom:S.number,center:S.arrayOf(S.number)};function at(e,t){return e===t}var it=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var t=arguments.length,n=Array(t),a=0;a<t;a++)n[a]=arguments[a];var i=0,o=n.pop(),s=function(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every(function(e){return"function"==typeof e})){var r=t.map(function(e){return typeof e}).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+r+"]")}return t}(n),u=e.apply(void 0,[function(){return i++,o.apply(null,arguments)}].concat(r)),c=e(function(){for(var e=[],t=s.length,r=0;r<t;r++)e.push(s[r].apply(null,arguments));return u.apply(null,e)});return c.resultFunc=o,c.dependencies=s,c.recomputations=function(){return i},c.resetRecomputations=function(){return i=0},c}}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:at,r=null,n=null;return function(){return function(e,t,r){if(null===t||null===r||t.length!==r.length)return!1;for(var n=t.length,a=0;a<n;a++)if(!e(t[a],r[a]))return!1;return!0}(t,r,arguments)||(n=e.apply(null,arguments)),r=arguments,n}}),ot=5,st=1<<ot,ut=st-1,ct={};function lt(e){e&&(e.value=!0)}function pt(){}function ft(e){return void 0===e.size&&(e.size=e.__iterate(dt)),e.size}function ht(e,t){if("number"!=typeof t){var r=t>>>0;if(""+r!==t||4294967295===r)return NaN;t=r}return t<0?ft(e)+t:t}function dt(){return!0}function _t(e,t,r){return(0===e&&!bt(e)||void 0!==r&&e<=-r)&&(void 0===t||void 0!==r&&t>=r)}function mt(e,t){return gt(e,t,0)}function yt(e,t){return gt(e,t,t)}function gt(e,t,r){return void 0===e?r:bt(e)?t===1/0?t:0|Math.max(0,t+e):void 0===t||t===e?e:0|Math.min(t,e)}function bt(e){return e<0||0===e&&1/e==-1/0}var vt="@@__IMMUTABLE_ITERABLE__@@";function St(e){return Boolean(e&&e[vt])}var Ot="@@__IMMUTABLE_KEYED__@@";function It(e){return Boolean(e&&e[Ot])}var Et="@@__IMMUTABLE_INDEXED__@@";function Tt(e){return Boolean(e&&e[Et])}function wt(e){return It(e)||Tt(e)}var At=function(e){return St(e)?e:Qt(e)},Mt=function(e){function t(e){return It(e)?e:er(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(At),Pt=function(e){function t(e){return Tt(e)?e:tr(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(At),Lt=function(e){function t(e){return St(e)&&!wt(e)?e:rr(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(At);At.Keyed=Mt,At.Indexed=Pt,At.Set=Lt;var xt="@@__IMMUTABLE_SEQ__@@";function Ct(e){return Boolean(e&&e[xt])}var Rt="@@__IMMUTABLE_RECORD__@@";function jt(e){return Boolean(e&&e[Rt])}function kt(e){return St(e)||jt(e)}var Dt="@@__IMMUTABLE_ORDERED__@@";function Nt(e){return Boolean(e&&e[Dt])}var Ft=0,Bt=1,Ut=2,Vt="function"==typeof Symbol&&Symbol.iterator,zt="@@iterator",Ht=Vt||zt,Gt=function(e){this.next=e};function qt(e,t,r,n){var a=0===e?t:1===e?r:[t,r];return n?n.value=a:n={value:a,done:!1},n}function Kt(){return{value:void 0,done:!0}}function $t(e){return!!Zt(e)}function Yt(e){return e&&"function"==typeof e.next}function Wt(e){var t=Zt(e);return t&&t.call(e)}function Zt(e){var t=e&&(Vt&&e[Vt]||e[zt]);if("function"==typeof t)return t}Gt.prototype.toString=function(){return"[Iterator]"},Gt.KEYS=Ft,Gt.VALUES=Bt,Gt.ENTRIES=Ut,Gt.prototype.inspect=Gt.prototype.toSource=function(){return this.toString()},Gt.prototype[Ht]=function(){return this};var Xt=Object.prototype.hasOwnProperty;function Jt(e){return!(!Array.isArray(e)&&"string"!=typeof e)||e&&"object"==typeof e&&Number.isInteger(e.length)&&e.length>=0&&(0===e.length?1===Object.keys(e).length:e.hasOwnProperty(e.length-1))}var Qt=function(e){function t(e){return null==e?sr():kt(e)?e.toSeq():function(e){var t=lr(e);if(t)return t;if("object"==typeof e)return new ar(e);throw new TypeError("Expected Array or collection object of values, or keyed object: "+e)}(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq {","}")},t.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},t.prototype.__iterate=function(e,t){var r=this._cache;if(r){for(var n=r.length,a=0;a!==n;){var i=r[t?n-++a:a++];if(!1===e(i[1],i[0],this))break}return a}return this.__iterateUncached(e,t)},t.prototype.__iterator=function(e,t){var r=this._cache;if(r){var n=r.length,a=0;return new Gt(function(){if(a===n)return{value:void 0,done:!0};var i=r[t?n-++a:a++];return qt(e,i[0],i[1])})}return this.__iteratorUncached(e,t)},t}(At),er=function(e){function t(e){return null==e?sr().toKeyedSeq():St(e)?It(e)?e.toSeq():e.fromEntrySeq():jt(e)?e.toSeq():ur(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toKeyedSeq=function(){return this},t}(Qt),tr=function(e){function t(e){return null==e?sr():St(e)?It(e)?e.entrySeq():e.toIndexedSeq():jt(e)?e.toSeq().entrySeq():cr(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toIndexedSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq [","]")},t}(Qt),rr=function(e){function t(e){return(St(e)&&!wt(e)?e:tr(e)).toSetSeq()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toSetSeq=function(){return this},t}(Qt);Qt.isSeq=Ct,Qt.Keyed=er,Qt.Set=rr,Qt.Indexed=tr,Qt.prototype[xt]=!0;var nr=function(e){function t(e){this._array=e,this.size=e.length}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e,t){return this.has(e)?this._array[ht(this,e)]:t},t.prototype.__iterate=function(e,t){for(var r=this._array,n=r.length,a=0;a!==n;){var i=t?n-++a:a++;if(!1===e(r[i],i,this))break}return a},t.prototype.__iterator=function(e,t){var r=this._array,n=r.length,a=0;return new Gt(function(){if(a===n)return{value:void 0,done:!0};var i=t?n-++a:a++;return qt(e,i,r[i])})},t}(tr),ar=function(e){function t(e){var t=Object.keys(e);this._object=e,this._keys=t,this.size=t.length}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e,t){return void 0===t||this.has(e)?this._object[e]:t},t.prototype.has=function(e){return Xt.call(this._object,e)},t.prototype.__iterate=function(e,t){for(var r=this._object,n=this._keys,a=n.length,i=0;i!==a;){var o=n[t?a-++i:i++];if(!1===e(r[o],o,this))break}return i},t.prototype.__iterator=function(e,t){var r=this._object,n=this._keys,a=n.length,i=0;return new Gt(function(){if(i===a)return{value:void 0,done:!0};var o=n[t?a-++i:i++];return qt(e,o,r[o])})},t}(er);ar.prototype[Dt]=!0;var ir,or=function(e){function t(e){this._collection=e,this.size=e.length||e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.__iterateUncached=function(e,t){if(t)return this.cacheResult().__iterate(e,t);var r=Wt(this._collection),n=0;if(Yt(r))for(var a;!(a=r.next()).done&&!1!==e(a.value,n++,this););return n},t.prototype.__iteratorUncached=function(e,t){if(t)return this.cacheResult().__iterator(e,t);var r=Wt(this._collection);if(!Yt(r))return new Gt(Kt);var n=0;return new Gt(function(){var t=r.next();return t.done?t:qt(e,n++,t.value)})},t}(tr);function sr(){return ir||(ir=new nr([]))}function ur(e){var t=Array.isArray(e)?new nr(e):$t(e)?new or(e):void 0;if(t)return t.fromEntrySeq();if("object"==typeof e)return new ar(e);throw new TypeError("Expected Array or collection object of [k, v] entries, or keyed object: "+e)}function cr(e){var t=lr(e);if(t)return t;throw new TypeError("Expected Array or collection object of values: "+e)}function lr(e){return Jt(e)?new nr(e):$t(e)?new or(e):void 0}var pr="@@__IMMUTABLE_MAP__@@";function fr(e){return Boolean(e&&e[pr])}function hr(e){return fr(e)&&Nt(e)}function dr(e){return Boolean(e&&"function"==typeof e.equals&&"function"==typeof e.hashCode)}function _r(e,t){if(e===t||e!=e&&t!=t)return!0;if(!e||!t)return!1;if("function"==typeof e.valueOf&&"function"==typeof t.valueOf){if((e=e.valueOf())===(t=t.valueOf())||e!=e&&t!=t)return!0;if(!e||!t)return!1}return!!(dr(e)&&dr(t)&&e.equals(t))}var mr="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(e,t){var r=65535&(e|=0),n=65535&(t|=0);return r*n+((e>>>16)*n+r*(t>>>16)<<16>>>0)|0};function yr(e){return e>>>1&1073741824|3221225471&e}var gr=Object.prototype.valueOf;function br(e){switch(typeof e){case"boolean":return e?1108378657:1108378656;case"number":return function(e){if(e!=e||e===1/0)return 0;var t=0|e;for(t!==e&&(t^=4294967295*e);e>4294967295;)t^=e/=4294967295;return yr(t)}(e);case"string":return e.length>Ar?function(e){var t=Lr[e];return void 0===t&&(t=vr(e),Pr===Mr&&(Pr=0,Lr={}),Pr++,Lr[e]=t),t}(e):vr(e);case"object":case"function":return null===e?1108378658:"function"==typeof e.hashCode?yr(e.hashCode(e)):(e.valueOf!==gr&&"function"==typeof e.valueOf&&(e=e.valueOf(e)),function(e){var t;if(Er&&void 0!==(t=Sr.get(e)))return t;if(void 0!==(t=e[wr]))return t;if(!Ir){if(void 0!==(t=e.propertyIsEnumerable&&e.propertyIsEnumerable[wr]))return t;if(void 0!==(t=function(e){if(e&&e.nodeType>0)switch(e.nodeType){case 1:return e.uniqueID;case 9:return e.documentElement&&e.documentElement.uniqueID}}(e)))return t}if(t=++Tr,1073741824&Tr&&(Tr=0),Er)Sr.set(e,t);else{if(void 0!==Or&&!1===Or(e))throw new Error("Non-extensible objects are not allowed as keys.");if(Ir)Object.defineProperty(e,wr,{enumerable:!1,configurable:!1,writable:!1,value:t});else if(void 0!==e.propertyIsEnumerable&&e.propertyIsEnumerable===e.constructor.prototype.propertyIsEnumerable)e.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},e.propertyIsEnumerable[wr]=t;else{if(void 0===e.nodeType)throw new Error("Unable to set a non-enumerable property on object.");e[wr]=t}}return t}(e));case"undefined":return 1108378659;default:if("function"==typeof e.toString)return vr(e.toString());throw new Error("Value type "+typeof e+" cannot be hashed.")}}function vr(e){for(var t=0,r=0;r<e.length;r++)t=31*t+e.charCodeAt(r)|0;return yr(t)}var Sr,Or=Object.isExtensible,Ir=function(){try{return Object.defineProperty({},"@",{}),!0}catch(e){return!1}}(),Er="function"==typeof WeakMap;Er&&(Sr=new WeakMap);var Tr=0,wr="__immutablehash__";"function"==typeof Symbol&&(wr=Symbol(wr));var Ar=16,Mr=255,Pr=0,Lr={},xr=function(e){function t(e,t){this._iter=e,this._useKeys=t,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e,t){return this._iter.get(e,t)},t.prototype.has=function(e){return this._iter.has(e)},t.prototype.valueSeq=function(){return this._iter.valueSeq()},t.prototype.reverse=function(){var e=this,t=Nr(this,!0);return this._useKeys||(t.valueSeq=function(){return e._iter.toSeq().reverse()}),t},t.prototype.map=function(e,t){var r=this,n=Dr(this,e,t);return this._useKeys||(n.valueSeq=function(){return r._iter.toSeq().map(e,t)}),n},t.prototype.__iterate=function(e,t){var r=this;return this._iter.__iterate(function(t,n){return e(t,n,r)},t)},t.prototype.__iterator=function(e,t){return this._iter.__iterator(e,t)},t}(er);xr.prototype[Dt]=!0;var Cr=function(e){function t(e){this._iter=e,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.includes=function(e){return this._iter.includes(e)},t.prototype.__iterate=function(e,t){var r=this,n=0;return t&&ft(this),this._iter.__iterate(function(a){return e(a,t?r.size-++n:n++,r)},t)},t.prototype.__iterator=function(e,t){var r=this,n=this._iter.__iterator(Bt,t),a=0;return t&&ft(this),new Gt(function(){var i=n.next();return i.done?i:qt(e,t?r.size-++a:a++,i.value,i)})},t}(tr),Rr=function(e){function t(e){this._iter=e,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.has=function(e){return this._iter.includes(e)},t.prototype.__iterate=function(e,t){var r=this;return this._iter.__iterate(function(t){return e(t,t,r)},t)},t.prototype.__iterator=function(e,t){var r=this._iter.__iterator(Bt,t);return new Gt(function(){var t=r.next();return t.done?t:qt(e,t.value,t.value,t)})},t}(rr),jr=function(e){function t(e){this._iter=e,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.entrySeq=function(){return this._iter.toSeq()},t.prototype.__iterate=function(e,t){var r=this;return this._iter.__iterate(function(t){if(t){$r(t);var n=St(t);return e(n?t.get(1):t[1],n?t.get(0):t[0],r)}},t)},t.prototype.__iterator=function(e,t){var r=this._iter.__iterator(Bt,t);return new Gt(function(){for(;;){var t=r.next();if(t.done)return t;var n=t.value;if(n){$r(n);var a=St(n);return qt(e,a?n.get(0):n[0],a?n.get(1):n[1],t)}}})},t}(er);function kr(e){var t=Wr(e);return t._iter=e,t.size=e.size,t.flip=function(){return e},t.reverse=function(){var t=e.reverse.apply(this);return t.flip=function(){return e.reverse()},t},t.has=function(t){return e.includes(t)},t.includes=function(t){return e.has(t)},t.cacheResult=Zr,t.__iterateUncached=function(t,r){var n=this;return e.__iterate(function(e,r){return!1!==t(r,e,n)},r)},t.__iteratorUncached=function(t,r){if(t===Ut){var n=e.__iterator(t,r);return new Gt(function(){var e=n.next();if(!e.done){var t=e.value[0];e.value[0]=e.value[1],e.value[1]=t}return e})}return e.__iterator(t===Bt?Ft:Bt,r)},t}function Dr(e,t,r){var n=Wr(e);return n.size=e.size,n.has=function(t){return e.has(t)},n.get=function(n,a){var i=e.get(n,ct);return i===ct?a:t.call(r,i,n,e)},n.__iterateUncached=function(n,a){var i=this;return e.__iterate(function(e,a,o){return!1!==n(t.call(r,e,a,o),a,i)},a)},n.__iteratorUncached=function(n,a){var i=e.__iterator(Ut,a);return new Gt(function(){var a=i.next();if(a.done)return a;var o=a.value,s=o[0];return qt(n,s,t.call(r,o[1],s,e),a)})},n}function Nr(e,t){var r=this,n=Wr(e);return n._iter=e,n.size=e.size,n.reverse=function(){return e},e.flip&&(n.flip=function(){var t=kr(e);return t.reverse=function(){return e.flip()},t}),n.get=function(r,n){return e.get(t?r:-1-r,n)},n.has=function(r){return e.has(t?r:-1-r)},n.includes=function(t){return e.includes(t)},n.cacheResult=Zr,n.__iterate=function(r,n){var a=this,i=0;return n&&ft(e),e.__iterate(function(e,o){return r(e,t?o:n?a.size-++i:i++,a)},!n)},n.__iterator=function(n,a){var i=0;a&&ft(e);var o=e.__iterator(Ut,!a);return new Gt(function(){var e=o.next();if(e.done)return e;var s=e.value;return qt(n,t?s[0]:a?r.size-++i:i++,s[1],e)})},n}function Fr(e,t,r,n){var a=Wr(e);return n&&(a.has=function(n){var a=e.get(n,ct);return a!==ct&&!!t.call(r,a,n,e)},a.get=function(n,a){var i=e.get(n,ct);return i!==ct&&t.call(r,i,n,e)?i:a}),a.__iterateUncached=function(a,i){var o=this,s=0;return e.__iterate(function(e,i,u){if(t.call(r,e,i,u))return s++,a(e,n?i:s-1,o)},i),s},a.__iteratorUncached=function(a,i){var o=e.__iterator(Ut,i),s=0;return new Gt(function(){for(;;){var i=o.next();if(i.done)return i;var u=i.value,c=u[0],l=u[1];if(t.call(r,l,c,e))return qt(a,n?c:s++,l,i)}})},a}function Br(e,t,r,n){var a=e.size;if(_t(t,r,a))return e;var i=mt(t,a),o=yt(r,a);if(i!=i||o!=o)return Br(e.toSeq().cacheResult(),t,r,n);var s,u=o-i;u==u&&(s=u<0?0:u);var c=Wr(e);return c.size=0===s?s:e.size&&s||void 0,!n&&Ct(e)&&s>=0&&(c.get=function(t,r){return(t=ht(this,t))>=0&&t<s?e.get(t+i,r):r}),c.__iterateUncached=function(t,r){var a=this;if(0===s)return 0;if(r)return this.cacheResult().__iterate(t,r);var o=0,u=!0,c=0;return e.__iterate(function(e,r){if(!u||!(u=o++<i))return c++,!1!==t(e,n?r:c-1,a)&&c!==s}),c},c.__iteratorUncached=function(t,r){if(0!==s&&r)return this.cacheResult().__iterator(t,r);if(0===s)return new Gt(Kt);var a=e.__iterator(t,r),o=0,u=0;return new Gt(function(){for(;o++<i;)a.next();if(++u>s)return{value:void 0,done:!0};var e=a.next();return n||t===Bt||e.done?e:qt(t,u-1,t===Ft?void 0:e.value[1],e)})},c}function Ur(e,t,r,n){var a=Wr(e);return a.__iterateUncached=function(a,i){var o=this;if(i)return this.cacheResult().__iterate(a,i);var s=!0,u=0;return e.__iterate(function(e,i,c){if(!s||!(s=t.call(r,e,i,c)))return u++,a(e,n?i:u-1,o)}),u},a.__iteratorUncached=function(a,i){var o=this;if(i)return this.cacheResult().__iterator(a,i);var s=e.__iterator(Ut,i),u=!0,c=0;return new Gt(function(){var e,i,l;do{if((e=s.next()).done)return n||a===Bt?e:qt(a,c++,a===Ft?void 0:e.value[1],e);var p=e.value;i=p[0],l=p[1],u&&(u=t.call(r,l,i,o))}while(u);return a===Ut?e:qt(a,i,l,e)})},a}function Vr(e,t,r){var n=Wr(e);return n.__iterateUncached=function(a,i){if(i)return this.cacheResult().__iterate(a,i);var o=0,s=!1;return function e(u,c){u.__iterate(function(i,u){return(!t||c<t)&&St(i)?e(i,c+1):(o++,!1===a(i,r?u:o-1,n)&&(s=!0)),!s},i)}(e,0),o},n.__iteratorUncached=function(n,a){if(a)return this.cacheResult().__iterator(n,a);var i=e.__iterator(n,a),o=[],s=0;return new Gt(function(){for(;i;){var e=i.next();if(!1===e.done){var u=e.value;if(n===Ut&&(u=u[1]),t&&!(o.length<t)||!St(u))return r?e:qt(n,s++,u,e);o.push(i),i=u.__iterator(n,a)}else i=o.pop()}return{value:void 0,done:!0}})},n}function zr(e,t,r){t||(t=Xr);var n=It(e),a=0,i=e.toSeq().map(function(t,n){return[n,t,a++,r?r(t,n,e):t]}).valueSeq().toArray();return i.sort(function(e,r){return t(e[3],r[3])||e[2]-r[2]}).forEach(n?function(e,t){i[t].length=2}:function(e,t){i[t]=e[1]}),n?er(i):Tt(e)?tr(i):rr(i)}function Hr(e,t,r){if(t||(t=Xr),r){var n=e.toSeq().map(function(t,n){return[t,r(t,n,e)]}).reduce(function(e,r){return Gr(t,e[1],r[1])?r:e});return n&&n[0]}return e.reduce(function(e,r){return Gr(t,e,r)?r:e})}function Gr(e,t,r){var n=e(r,t);return 0===n&&r!==t&&(null==r||r!=r)||n>0}function qr(e,t,r,n){var a=Wr(e),i=new nr(r).map(function(e){return e.size});return a.size=n?i.max():i.min(),a.__iterate=function(e,t){for(var r,n=this.__iterator(Bt,t),a=0;!(r=n.next()).done&&!1!==e(r.value,a++,this););return a},a.__iteratorUncached=function(e,a){var i=r.map(function(e){return e=At(e),Wt(a?e.reverse():e)}),o=0,s=!1;return new Gt(function(){var r;return s||(r=i.map(function(e){return e.next()}),s=n?r.every(function(e){return e.done}):r.some(function(e){return e.done})),s?{value:void 0,done:!0}:qt(e,o++,t.apply(null,r.map(function(e){return e.value})))})},a}function Kr(e,t){return e===t?e:Ct(e)?t:e.constructor(t)}function $r(e){if(e!==Object(e))throw new TypeError("Expected [K, V] tuple: "+e)}function Yr(e){return It(e)?Mt:Tt(e)?Pt:Lt}function Wr(e){return Object.create((It(e)?er:Tt(e)?tr:rr).prototype)}function Zr(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):Qt.prototype.cacheResult.call(this)}function Xr(e,t){return void 0===e&&void 0===t?0:void 0===e?1:void 0===t?-1:e>t?1:e<t?-1:0}function Jr(e,t){t=t||0;for(var r=Math.max(0,e.length-t),n=new Array(r),a=0;a<r;a++)n[a]=e[a+t];return n}function Qr(e,t){if(!e)throw new Error(t)}function en(e){Qr(e!==1/0,"Cannot perform this action with an infinite size.")}function tn(e){if(Jt(e)&&"string"!=typeof e)return e;if(Nt(e))return e.toArray();throw new TypeError("Invalid keyPath: expected Ordered Collection or Array: "+e)}function rn(e){return e&&("function"!=typeof e.constructor||"Object"===e.constructor.name)}function nn(e){return"object"==typeof e&&(kt(e)||Array.isArray(e)||rn(e))}function an(e){try{return"string"==typeof e?JSON.stringify(e):String(e)}catch(t){return JSON.stringify(e)}}function on(e,t,r){return kt(e)?e.get(t,r):function(e,t){return kt(e)?e.has(t):nn(e)&&Xt.call(e,t)}(e,t)?"function"==typeof e.get?e.get(t):e[t]:r}function sn(e){if(Array.isArray(e))return Jr(e);var t={};for(var r in e)Xt.call(e,r)&&(t[r]=e[r]);return t}function un(e,t,r,n){n||(n=r,r=void 0);var a=function e(t,r,n,a,i,o){var s=r===ct;if(a===n.length){var u=s?i:r,c=o(u);return c===u?r:c}if(!s&&!nn(r))throw new TypeError("Cannot update within non-data-structure value in path ["+n.slice(0,a).map(an)+"]: "+r);var l=n[a],p=s?ct:on(r,l,ct),f=e(p===ct?t:kt(p),p,n,a+1,i,o);return f===p?r:f===ct?function(e,t){if(!nn(e))throw new TypeError("Cannot update non-data-structure value: "+e);if(kt(e)){if(!e.remove)throw new TypeError("Cannot update immutable value without .remove() method: "+e);return e.remove(t)}if(!Xt.call(e,t))return e;var r=sn(e);return Array.isArray(r)?r.splice(t,1):delete r[t],r}(r,l):function(e,t,r){if(!nn(e))throw new TypeError("Cannot update non-data-structure value: "+e);if(kt(e)){if(!e.set)throw new TypeError("Cannot update immutable value without .set() method: "+e);return e.set(t,r)}if(Xt.call(e,t)&&r===e[t])return e;var n=sn(e);return n[t]=r,n}(s?t?Bn():{}:r,l,f)}(kt(e),e,tn(t),0,r,n);return a===ct?r:a}function cn(e,t){return function(e,t,r){return un(e,t,ct,function(){return r})}(this,e,t)}function ln(e){return function(e,t){return un(e,t,function(){return ct})}(this,e)}function pn(e,t,r,n){return un(e,[t],r,n)}function fn(e,t,r){return 1===arguments.length?e(this):pn(this,e,t,r)}function hn(e,t,r){return un(this,e,t,r)}function dn(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return mn(this,e)}function _n(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];if("function"!=typeof e)throw new TypeError("Invalid merger function: "+e);return mn(this,t,e)}function mn(e,t,r){for(var n=[],a=0;a<t.length;a++){var i=Mt(t[a]);0!==i.size&&n.push(i)}return 0===n.length?e:0!==e.toSeq().size||e.__ownerID||1!==n.length?e.withMutations(function(e){for(var t=r?function(t,n){pn(e,n,ct,function(e){return e===ct?t:r(e,t,n)})}:function(t,r){e.set(r,t)},a=0;a<n.length;a++)n[a].forEach(t)}):e.constructor(n[0])}function yn(e,t,r){return gn(e,t,function(e){return function t(r,n,a){return nn(r)&&nn(n)?gn(r,[n],t):e?e(r,n,a):n}}(r))}function gn(e,t,r){if(!nn(e))throw new TypeError("Cannot merge into non-data-structure value: "+e);if(kt(e))return"function"==typeof r&&e.mergeWith?e.mergeWith.apply(e,[r].concat(t)):e.merge?e.merge.apply(e,t):e.concat.apply(e,t);for(var n=Array.isArray(e),a=e,i=n?Pt:Mt,o=n?function(t){a===e&&(a=sn(a)),a.push(t)}:function(t,n){var i=Xt.call(a,n),o=i&&r?r(a[n],t,n):t;i&&o===a[n]||(a===e&&(a=sn(a)),a[n]=o)},s=0;s<t.length;s++)i(t[s]).forEach(o);return a}function bn(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return yn(this,e)}function vn(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return yn(this,t,e)}function Sn(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return un(this,e,Bn(),function(e){return gn(e,t)})}function On(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return un(this,e,Bn(),function(e){return yn(e,t)})}function In(e){var t=this.asMutable();return e(t),t.wasAltered()?t.__ensureOwner(this.__ownerID):this}function En(){return this.__ownerID?this:this.__ensureOwner(new pt)}function Tn(){return this.__ensureOwner()}function wn(){return this.__altered}Cr.prototype.cacheResult=xr.prototype.cacheResult=Rr.prototype.cacheResult=jr.prototype.cacheResult=Zr;var An=function(e){function t(t){return null==t?Bn():fr(t)&&!Nt(t)?t:Bn().withMutations(function(r){var n=e(t);en(n.size),n.forEach(function(e,t){return r.set(t,e)})})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return Bn().withMutations(function(t){for(var r=0;r<e.length;r+=2){if(r+1>=e.length)throw new Error("Missing value for key: "+e[r]);t.set(e[r],e[r+1])}})},t.prototype.toString=function(){return this.__toString("Map {","}")},t.prototype.get=function(e,t){return this._root?this._root.get(0,void 0,e,t):t},t.prototype.set=function(e,t){return Un(this,e,t)},t.prototype.remove=function(e){return Un(this,e,ct)},t.prototype.deleteAll=function(e){var t=At(e);return 0===t.size?this:this.withMutations(function(e){t.forEach(function(t){return e.remove(t)})})},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):Bn()},t.prototype.sort=function(e){return pa(zr(this,e))},t.prototype.sortBy=function(e,t){return pa(zr(this,t,e))},t.prototype.map=function(e,t){return this.withMutations(function(r){r.forEach(function(n,a){r.set(a,e.call(t,n,a,r))})})},t.prototype.__iterator=function(e,t){return new kn(this,e,t)},t.prototype.__iterate=function(e,t){var r=this,n=0;return this._root&&this._root.iterate(function(t){return n++,e(t[1],t[0],r)},t),n},t.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?Fn(this.size,this._root,e,this.__hash):0===this.size?Bn():(this.__ownerID=e,this.__altered=!1,this)},t}(Mt);An.isMap=fr;var Mn=An.prototype;Mn[pr]=!0,Mn.delete=Mn.remove,Mn.removeAll=Mn.deleteAll,Mn.setIn=cn,Mn.removeIn=Mn.deleteIn=ln,Mn.update=fn,Mn.updateIn=hn,Mn.merge=Mn.concat=dn,Mn.mergeWith=_n,Mn.mergeDeep=bn,Mn.mergeDeepWith=vn,Mn.mergeIn=Sn,Mn.mergeDeepIn=On,Mn.withMutations=In,Mn.wasAltered=wn,Mn.asImmutable=Tn,Mn["@@transducer/init"]=Mn.asMutable=En,Mn["@@transducer/step"]=function(e,t){return e.set(t[0],t[1])},Mn["@@transducer/result"]=function(e){return e.asImmutable()};var Pn=function(e,t){this.ownerID=e,this.entries=t};Pn.prototype.get=function(e,t,r,n){for(var a=this.entries,i=0,o=a.length;i<o;i++)if(_r(r,a[i][0]))return a[i][1];return n},Pn.prototype.update=function(e,t,r,n,a,i,o){for(var s=a===ct,u=this.entries,c=0,l=u.length;c<l&&!_r(n,u[c][0]);c++);var p=c<l;if(p?u[c][1]===a:s)return this;if(lt(o),(s||!p)&&lt(i),!s||1!==u.length){if(!p&&!s&&u.length>=Kn)return function(e,t,r,n){e||(e=new pt);for(var a=new Rn(e,br(r),[r,n]),i=0;i<t.length;i++){var o=t[i];a=a.update(e,0,void 0,o[0],o[1])}return a}(e,u,n,a);var f=e&&e===this.ownerID,h=f?u:Jr(u);return p?s?c===l-1?h.pop():h[c]=h.pop():h[c]=[n,a]:h.push([n,a]),f?(this.entries=h,this):new Pn(e,h)}};var Ln=function(e,t,r){this.ownerID=e,this.bitmap=t,this.nodes=r};Ln.prototype.get=function(e,t,r,n){void 0===t&&(t=br(r));var a=1<<((0===e?t:t>>>e)&ut),i=this.bitmap;return 0==(i&a)?n:this.nodes[Gn(i&a-1)].get(e+ot,t,r,n)},Ln.prototype.update=function(e,t,r,n,a,i,o){void 0===r&&(r=br(n));var s=(0===t?r:r>>>t)&ut,u=1<<s,c=this.bitmap,l=0!=(c&u);if(!l&&a===ct)return this;var p=Gn(c&u-1),f=this.nodes,h=l?f[p]:void 0,d=Vn(h,e,t+ot,r,n,a,i,o);if(d===h)return this;if(!l&&d&&f.length>=$n)return function(e,t,r,n,a){for(var i=0,o=new Array(st),s=0;0!==r;s++,r>>>=1)o[s]=1&r?t[i++]:void 0;return o[n]=a,new xn(e,i+1,o)}(e,f,c,s,d);if(l&&!d&&2===f.length&&zn(f[1^p]))return f[1^p];if(l&&d&&1===f.length&&zn(d))return d;var _=e&&e===this.ownerID,m=l?d?c:c^u:c|u,y=l?d?qn(f,p,d,_):function(e,t,r){var n=e.length-1;if(r&&t===n)return e.pop(),e;for(var a=new Array(n),i=0,o=0;o<n;o++)o===t&&(i=1),a[o]=e[o+i];return a}(f,p,_):function(e,t,r,n){var a=e.length+1;if(n&&t+1===a)return e[t]=r,e;for(var i=new Array(a),o=0,s=0;s<a;s++)s===t?(i[s]=r,o=-1):i[s]=e[s+o];return i}(f,p,d,_);return _?(this.bitmap=m,this.nodes=y,this):new Ln(e,m,y)};var xn=function(e,t,r){this.ownerID=e,this.count=t,this.nodes=r};xn.prototype.get=function(e,t,r,n){void 0===t&&(t=br(r));var a=(0===e?t:t>>>e)&ut,i=this.nodes[a];return i?i.get(e+ot,t,r,n):n},xn.prototype.update=function(e,t,r,n,a,i,o){void 0===r&&(r=br(n));var s=(0===t?r:r>>>t)&ut,u=a===ct,c=this.nodes,l=c[s];if(u&&!l)return this;var p=Vn(l,e,t+ot,r,n,a,i,o);if(p===l)return this;var f=this.count;if(l){if(!p&&--f<Yn)return function(e,t,r,n){for(var a=0,i=0,o=new Array(f),s=0,u=1,c=t.length;s<c;s++,u<<=1){var l=t[s];void 0!==l&&s!==n&&(a|=u,o[i++]=l)}return new Ln(e,a,o)}(e,c,0,s)}else f++;var h=e&&e===this.ownerID,d=qn(c,s,p,h);return h?(this.count=f,this.nodes=d,this):new xn(e,f,d)};var Cn=function(e,t,r){this.ownerID=e,this.keyHash=t,this.entries=r};Cn.prototype.get=function(e,t,r,n){for(var a=this.entries,i=0,o=a.length;i<o;i++)if(_r(r,a[i][0]))return a[i][1];return n},Cn.prototype.update=function(e,t,r,n,a,i,o){void 0===r&&(r=br(n));var s=a===ct;if(r!==this.keyHash)return s?this:(lt(o),lt(i),Hn(this,e,t,r,[n,a]));for(var u=this.entries,c=0,l=u.length;c<l&&!_r(n,u[c][0]);c++);var p=c<l;if(p?u[c][1]===a:s)return this;if(lt(o),(s||!p)&&lt(i),s&&2===l)return new Rn(e,this.keyHash,u[1^c]);var f=e&&e===this.ownerID,h=f?u:Jr(u);return p?s?c===l-1?h.pop():h[c]=h.pop():h[c]=[n,a]:h.push([n,a]),f?(this.entries=h,this):new Cn(e,this.keyHash,h)};var Rn=function(e,t,r){this.ownerID=e,this.keyHash=t,this.entry=r};Rn.prototype.get=function(e,t,r,n){return _r(r,this.entry[0])?this.entry[1]:n},Rn.prototype.update=function(e,t,r,n,a,i,o){var s=a===ct,u=_r(n,this.entry[0]);return(u?a===this.entry[1]:s)?this:(lt(o),s?void lt(i):u?e&&e===this.ownerID?(this.entry[1]=a,this):new Rn(e,this.keyHash,[n,a]):(lt(i),Hn(this,e,t,br(n),[n,a])))},Pn.prototype.iterate=Cn.prototype.iterate=function(e,t){for(var r=this.entries,n=0,a=r.length-1;n<=a;n++)if(!1===e(r[t?a-n:n]))return!1},Ln.prototype.iterate=xn.prototype.iterate=function(e,t){for(var r=this.nodes,n=0,a=r.length-1;n<=a;n++){var i=r[t?a-n:n];if(i&&!1===i.iterate(e,t))return!1}},Rn.prototype.iterate=function(e,t){return e(this.entry)};var jn,kn=function(e){function t(e,t,r){this._type=t,this._reverse=r,this._stack=e._root&&Nn(e._root)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){for(var e=this._type,t=this._stack;t;){var r=t.node,n=t.index++,a=void 0;if(r.entry){if(0===n)return Dn(e,r.entry)}else if(r.entries){if(n<=(a=r.entries.length-1))return Dn(e,r.entries[this._reverse?a-n:n])}else if(n<=(a=r.nodes.length-1)){var i=r.nodes[this._reverse?a-n:n];if(i){if(i.entry)return Dn(e,i.entry);t=this._stack=Nn(i,t)}continue}t=this._stack=this._stack.__prev}return{value:void 0,done:!0}},t}(Gt);function Dn(e,t){return qt(e,t[0],t[1])}function Nn(e,t){return{node:e,index:0,__prev:t}}function Fn(e,t,r,n){var a=Object.create(Mn);return a.size=e,a._root=t,a.__ownerID=r,a.__hash=n,a.__altered=!1,a}function Bn(){return jn||(jn=Fn(0))}function Un(e,t,r){var n,a;if(e._root){var i={value:!1},o={value:!1};if(n=Vn(e._root,e.__ownerID,0,void 0,t,r,i,o),!o.value)return e;a=e.size+(i.value?r===ct?-1:1:0)}else{if(r===ct)return e;a=1,n=new Pn(e.__ownerID,[[t,r]])}return e.__ownerID?(e.size=a,e._root=n,e.__hash=void 0,e.__altered=!0,e):n?Fn(a,n):Bn()}function Vn(e,t,r,n,a,i,o,s){return e?e.update(t,r,n,a,i,o,s):i===ct?e:(lt(s),lt(o),new Rn(t,n,[a,i]))}function zn(e){return e.constructor===Rn||e.constructor===Cn}function Hn(e,t,r,n,a){if(e.keyHash===n)return new Cn(t,n,[e.entry,a]);var i,o=(0===r?e.keyHash:e.keyHash>>>r)&ut,s=(0===r?n:n>>>r)&ut,u=o===s?[Hn(e,t,r+ot,n,a)]:(i=new Rn(t,n,a),o<s?[e,i]:[i,e]);return new Ln(t,1<<o|1<<s,u)}function Gn(e){return e=(e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135,127&(e+=e>>8)+(e>>16)}function qn(e,t,r,n){var a=n?e:Jr(e);return a[t]=r,a}var Kn=st/4,$n=st/2,Yn=st/4,Wn="@@__IMMUTABLE_LIST__@@";function Zn(e){return Boolean(e&&e[Wn])}var Xn=function(e){function t(t){var r=aa();if(null==t)return r;if(Zn(t))return t;var n=e(t),a=n.size;return 0===a?r:(en(a),a>0&&a<st?na(0,a,ot,null,new Qn(n.toArray())):r.withMutations(function(e){e.setSize(a),n.forEach(function(t,r){return e.set(r,t)})}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("List [","]")},t.prototype.get=function(e,t){if((e=ht(this,e))>=0&&e<this.size){var r=sa(this,e+=this._origin);return r&&r.array[e&ut]}return t},t.prototype.set=function(e,t){return function(e,t,r){if((t=ht(e,t))!=t)return e;if(t>=e.size||t<0)return e.withMutations(function(e){t<0?ua(e,t).set(0,r):ua(e,0,t+1).set(t,r)});t+=e._origin;var n=e._tail,a=e._root,i={value:!1};return t>=ca(e._capacity)?n=ia(n,e.__ownerID,0,t,r,i):a=ia(a,e.__ownerID,e._level,t,r,i),i.value?e.__ownerID?(e._root=a,e._tail=n,e.__hash=void 0,e.__altered=!0,e):na(e._origin,e._capacity,e._level,a,n):e}(this,e,t)},t.prototype.remove=function(e){return this.has(e)?0===e?this.shift():e===this.size-1?this.pop():this.splice(e,1):this},t.prototype.insert=function(e,t){return this.splice(e,0,t)},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=ot,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):aa()},t.prototype.push=function(){var e=arguments,t=this.size;return this.withMutations(function(r){ua(r,0,t+e.length);for(var n=0;n<e.length;n++)r.set(t+n,e[n])})},t.prototype.pop=function(){return ua(this,0,-1)},t.prototype.unshift=function(){var e=arguments;return this.withMutations(function(t){ua(t,-e.length);for(var r=0;r<e.length;r++)t.set(r,e[r])})},t.prototype.shift=function(){return ua(this,1)},t.prototype.concat=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++){var a=t[n],i=e("string"!=typeof a&&$t(a)?a:[a]);0!==i.size&&r.push(i)}return 0===r.length?this:0!==this.size||this.__ownerID||1!==r.length?this.withMutations(function(e){r.forEach(function(t){return t.forEach(function(t){return e.push(t)})})}):this.constructor(r[0])},t.prototype.setSize=function(e){return ua(this,0,e)},t.prototype.map=function(e,t){var r=this;return this.withMutations(function(n){for(var a=0;a<r.size;a++)n.set(a,e.call(t,n.get(a),a,n))})},t.prototype.slice=function(e,t){var r=this.size;return _t(e,t,r)?this:ua(this,mt(e,r),yt(t,r))},t.prototype.__iterator=function(e,t){var r=t?this.size:0,n=ra(this,t);return new Gt(function(){var a=n();return a===ta?{value:void 0,done:!0}:qt(e,t?--r:r++,a)})},t.prototype.__iterate=function(e,t){for(var r,n=t?this.size:0,a=ra(this,t);(r=a())!==ta&&!1!==e(r,t?--n:n++,this););return n},t.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?na(this._origin,this._capacity,this._level,this._root,this._tail,e,this.__hash):0===this.size?aa():(this.__ownerID=e,this.__altered=!1,this)},t}(Pt);Xn.isList=Zn;var Jn=Xn.prototype;Jn[Wn]=!0,Jn.delete=Jn.remove,Jn.merge=Jn.concat,Jn.setIn=cn,Jn.deleteIn=Jn.removeIn=ln,Jn.update=fn,Jn.updateIn=hn,Jn.mergeIn=Sn,Jn.mergeDeepIn=On,Jn.withMutations=In,Jn.wasAltered=wn,Jn.asImmutable=Tn,Jn["@@transducer/init"]=Jn.asMutable=En,Jn["@@transducer/step"]=function(e,t){return e.push(t)},Jn["@@transducer/result"]=function(e){return e.asImmutable()};var Qn=function(e,t){this.array=e,this.ownerID=t};Qn.prototype.removeBefore=function(e,t,r){if(r===t?1<<t:0===this.array.length)return this;var n=r>>>t&ut;if(n>=this.array.length)return new Qn([],e);var a,i=0===n;if(t>0){var o=this.array[n];if((a=o&&o.removeBefore(e,t-ot,r))===o&&i)return this}if(i&&!a)return this;var s=oa(this,e);if(!i)for(var u=0;u<n;u++)s.array[u]=void 0;return a&&(s.array[n]=a),s},Qn.prototype.removeAfter=function(e,t,r){if(r===(t?1<<t:0)||0===this.array.length)return this;var n,a=r-1>>>t&ut;if(a>=this.array.length)return this;if(t>0){var i=this.array[a];if((n=i&&i.removeAfter(e,t-ot,r))===i&&a===this.array.length-1)return this}var o=oa(this,e);return o.array.splice(a+1),n&&(o.array[a]=n),o};var ea,ta={};function ra(e,t){var r=e._origin,n=e._capacity,a=ca(n),i=e._tail;return function e(o,s,u){return 0===s?function(e,o){var s=o===a?i&&i.array:e&&e.array,u=o>r?0:r-o,c=n-o;return c>st&&(c=st),function(){if(u===c)return ta;var e=t?--c:u++;return s&&s[e]}}(o,u):function(a,i,o){var s,u=a&&a.array,c=o>r?0:r-o>>i,l=1+(n-o>>i);return l>st&&(l=st),function(){for(;;){if(s){var r=s();if(r!==ta)return r;s=null}if(c===l)return ta;var n=t?--l:c++;s=e(u&&u[n],i-ot,o+(n<<i))}}}(o,s,u)}(e._root,e._level,0)}function na(e,t,r,n,a,i,o){var s=Object.create(Jn);return s.size=t-e,s._origin=e,s._capacity=t,s._level=r,s._root=n,s._tail=a,s.__ownerID=i,s.__hash=o,s.__altered=!1,s}function aa(){return ea||(ea=na(0,0,ot))}function ia(e,t,r,n,a,i){var o,s=n>>>r&ut,u=e&&s<e.array.length;if(!u&&void 0===a)return e;if(r>0){var c=e&&e.array[s],l=ia(c,t,r-ot,n,a,i);return l===c?e:((o=oa(e,t)).array[s]=l,o)}return u&&e.array[s]===a?e:(i&&lt(i),o=oa(e,t),void 0===a&&s===o.array.length-1?o.array.pop():o.array[s]=a,o)}function oa(e,t){return t&&e&&t===e.ownerID?e:new Qn(e?e.array.slice():[],t)}function sa(e,t){if(t>=ca(e._capacity))return e._tail;if(t<1<<e._level+ot){for(var r=e._root,n=e._level;r&&n>0;)r=r.array[t>>>n&ut],n-=ot;return r}}function ua(e,t,r){void 0!==t&&(t|=0),void 0!==r&&(r|=0);var n=e.__ownerID||new pt,a=e._origin,i=e._capacity,o=a+t,s=void 0===r?i:r<0?i+r:a+r;if(o===a&&s===i)return e;if(o>=s)return e.clear();for(var u=e._level,c=e._root,l=0;o+l<0;)c=new Qn(c&&c.array.length?[void 0,c]:[],n),l+=1<<(u+=ot);l&&(o+=l,a+=l,s+=l,i+=l);for(var p=ca(i),f=ca(s);f>=1<<u+ot;)c=new Qn(c&&c.array.length?[c]:[],n),u+=ot;var h=e._tail,d=f<p?sa(e,s-1):f>p?new Qn([],n):h;if(h&&f>p&&o<i&&h.array.length){for(var _=c=oa(c,n),m=u;m>ot;m-=ot){var y=p>>>m&ut;_=_.array[y]=oa(_.array[y],n)}_.array[p>>>ot&ut]=h}if(s<i&&(d=d&&d.removeAfter(n,0,s)),o>=f)o-=f,s-=f,u=ot,c=null,d=d&&d.removeBefore(n,0,o);else if(o>a||f<p){for(l=0;c;){var g=o>>>u&ut;if(g!==f>>>u&ut)break;g&&(l+=(1<<u)*g),u-=ot,c=c.array[g]}c&&o>a&&(c=c.removeBefore(n,u,o-l)),c&&f<p&&(c=c.removeAfter(n,u,f-l)),l&&(o-=l,s-=l)}return e.__ownerID?(e.size=s-o,e._origin=o,e._capacity=s,e._level=u,e._root=c,e._tail=d,e.__hash=void 0,e.__altered=!0,e):na(o,s,u,c,d)}function ca(e){return e<st?0:e-1>>>ot<<ot}var la,pa=function(e){function t(e){return null==e?ha():hr(e)?e:ha().withMutations(function(t){var r=Mt(e);en(r.size),r.forEach(function(e,r){return t.set(r,e)})})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("OrderedMap {","}")},t.prototype.get=function(e,t){var r=this._map.get(e);return void 0!==r?this._list.get(r)[1]:t},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):ha()},t.prototype.set=function(e,t){return da(this,e,t)},t.prototype.remove=function(e){return da(this,e,ct)},t.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},t.prototype.__iterate=function(e,t){var r=this;return this._list.__iterate(function(t){return t&&e(t[1],t[0],r)},t)},t.prototype.__iterator=function(e,t){return this._list.fromEntrySeq().__iterator(e,t)},t.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map.__ensureOwner(e),r=this._list.__ensureOwner(e);return e?fa(t,r,e,this.__hash):0===this.size?ha():(this.__ownerID=e,this._map=t,this._list=r,this)},t}(An);function fa(e,t,r,n){var a=Object.create(pa.prototype);return a.size=e?e.size:0,a._map=e,a._list=t,a.__ownerID=r,a.__hash=n,a}function ha(){return la||(la=fa(Bn(),aa()))}function da(e,t,r){var n,a,i=e._map,o=e._list,s=i.get(t),u=void 0!==s;if(r===ct){if(!u)return e;o.size>=st&&o.size>=2*i.size?(n=(a=o.filter(function(e,t){return void 0!==e&&s!==t})).toKeyedSeq().map(function(e){return e[0]}).flip().toMap(),e.__ownerID&&(n.__ownerID=a.__ownerID=e.__ownerID)):(n=i.remove(t),a=s===o.size-1?o.pop():o.set(s,void 0))}else if(u){if(r===o.get(s)[1])return e;n=i,a=o.set(s,[t,r])}else n=i.set(t,o.size),a=o.set(o.size,[t,r]);return e.__ownerID?(e.size=n.size,e._map=n,e._list=a,e.__hash=void 0,e):fa(n,a)}pa.isOrderedMap=hr,pa.prototype[Dt]=!0,pa.prototype.delete=pa.prototype.remove;var _a="@@__IMMUTABLE_STACK__@@";function ma(e){return Boolean(e&&e[_a])}var ya=function(e){function t(e){return null==e?Sa():ma(e)?e:Sa().pushAll(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("Stack [","]")},t.prototype.get=function(e,t){var r=this._head;for(e=ht(this,e);r&&e--;)r=r.next;return r?r.value:t},t.prototype.peek=function(){return this._head&&this._head.value},t.prototype.push=function(){var e=arguments;if(0===arguments.length)return this;for(var t=this.size+arguments.length,r=this._head,n=arguments.length-1;n>=0;n--)r={value:e[n],next:r};return this.__ownerID?(this.size=t,this._head=r,this.__hash=void 0,this.__altered=!0,this):va(t,r)},t.prototype.pushAll=function(t){if(0===(t=e(t)).size)return this;if(0===this.size&&ma(t))return t;en(t.size);var r=this.size,n=this._head;return t.__iterate(function(e){r++,n={value:e,next:n}},!0),this.__ownerID?(this.size=r,this._head=n,this.__hash=void 0,this.__altered=!0,this):va(r,n)},t.prototype.pop=function(){return this.slice(1)},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):Sa()},t.prototype.slice=function(t,r){if(_t(t,r,this.size))return this;var n=mt(t,this.size);if(yt(r,this.size)!==this.size)return e.prototype.slice.call(this,t,r);for(var a=this.size-n,i=this._head;n--;)i=i.next;return this.__ownerID?(this.size=a,this._head=i,this.__hash=void 0,this.__altered=!0,this):va(a,i)},t.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?va(this.size,this._head,e,this.__hash):0===this.size?Sa():(this.__ownerID=e,this.__altered=!1,this)},t.prototype.__iterate=function(e,t){var r=this;if(t)return new nr(this.toArray()).__iterate(function(t,n){return e(t,n,r)},t);for(var n=0,a=this._head;a&&!1!==e(a.value,n++,this);)a=a.next;return n},t.prototype.__iterator=function(e,t){if(t)return new nr(this.toArray()).__iterator(e,t);var r=0,n=this._head;return new Gt(function(){if(n){var t=n.value;return n=n.next,qt(e,r++,t)}return{value:void 0,done:!0}})},t}(Pt);ya.isStack=ma;var ga,ba=ya.prototype;function va(e,t,r,n){var a=Object.create(ba);return a.size=e,a._head=t,a.__ownerID=r,a.__hash=n,a.__altered=!1,a}function Sa(){return ga||(ga=va(0))}ba[_a]=!0,ba.shift=ba.pop,ba.unshift=ba.push,ba.unshiftAll=ba.pushAll,ba.withMutations=In,ba.wasAltered=wn,ba.asImmutable=Tn,ba["@@transducer/init"]=ba.asMutable=En,ba["@@transducer/step"]=function(e,t){return e.unshift(t)},ba["@@transducer/result"]=function(e){return e.asImmutable()};var Oa="@@__IMMUTABLE_SET__@@";function Ia(e){return Boolean(e&&e[Oa])}function Ea(e){return Ia(e)&&Nt(e)}function Ta(e,t){if(e===t)return!0;if(!St(t)||void 0!==e.size&&void 0!==t.size&&e.size!==t.size||void 0!==e.__hash&&void 0!==t.__hash&&e.__hash!==t.__hash||It(e)!==It(t)||Tt(e)!==Tt(t)||Nt(e)!==Nt(t))return!1;if(0===e.size&&0===t.size)return!0;var r=!wt(e);if(Nt(e)){var n=e.entries();return t.every(function(e,t){var a=n.next().value;return a&&_r(a[1],e)&&(r||_r(a[0],t))})&&n.next().done}var a=!1;if(void 0===e.size)if(void 0===t.size)"function"==typeof e.cacheResult&&e.cacheResult();else{a=!0;var i=e;e=t,t=i}var o=!0,s=t.__iterate(function(t,n){if(r?!e.has(t):a?!_r(t,e.get(n,ct)):!_r(e.get(n,ct),t))return o=!1,!1});return o&&e.size===s}function wa(e,t){var r=function(r){e.prototype[r]=t[r]};return Object.keys(t).forEach(r),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach(r),e}function Aa(e){if(!e||"object"!=typeof e)return e;if(!St(e)){if(!nn(e))return e;e=Qt(e)}if(It(e)){var t={};return e.__iterate(function(e,r){t[r]=Aa(e)}),t}var r=[];return e.__iterate(function(e){r.push(Aa(e))}),r}var Ma=function(e){function t(t){return null==t?Ra():Ia(t)&&!Nt(t)?t:Ra().withMutations(function(r){var n=e(t);en(n.size),n.forEach(function(e){return r.add(e)})})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(e){return this(Mt(e).keySeq())},t.intersect=function(e){return(e=At(e).toArray()).length?La.intersect.apply(t(e.pop()),e):Ra()},t.union=function(e){return(e=At(e).toArray()).length?La.union.apply(t(e.pop()),e):Ra()},t.prototype.toString=function(){return this.__toString("Set {","}")},t.prototype.has=function(e){return this._map.has(e)},t.prototype.add=function(e){return xa(this,this._map.set(e,e))},t.prototype.remove=function(e){return xa(this,this._map.remove(e))},t.prototype.clear=function(){return xa(this,this._map.clear())},t.prototype.map=function(e,t){var r=this,n=[],a=[];return this.forEach(function(i){var o=e.call(t,i,i,r);o!==i&&(n.push(i),a.push(o))}),this.withMutations(function(e){n.forEach(function(t){return e.remove(t)}),a.forEach(function(t){return e.add(t)})})},t.prototype.union=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return 0===(t=t.filter(function(e){return 0!==e.size})).length?this:0!==this.size||this.__ownerID||1!==t.length?this.withMutations(function(r){for(var n=0;n<t.length;n++)e(t[n]).forEach(function(e){return r.add(e)})}):this.constructor(t[0])},t.prototype.intersect=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];if(0===t.length)return this;t=t.map(function(t){return e(t)});var n=[];return this.forEach(function(e){t.every(function(t){return t.includes(e)})||n.push(e)}),this.withMutations(function(e){n.forEach(function(t){e.remove(t)})})},t.prototype.subtract=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];if(0===t.length)return this;t=t.map(function(t){return e(t)});var n=[];return this.forEach(function(e){t.some(function(t){return t.includes(e)})&&n.push(e)}),this.withMutations(function(e){n.forEach(function(t){e.remove(t)})})},t.prototype.sort=function(e){return Za(zr(this,e))},t.prototype.sortBy=function(e,t){return Za(zr(this,t,e))},t.prototype.wasAltered=function(){return this._map.wasAltered()},t.prototype.__iterate=function(e,t){var r=this;return this._map.__iterate(function(t){return e(t,t,r)},t)},t.prototype.__iterator=function(e,t){return this._map.__iterator(e,t)},t.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map.__ensureOwner(e);return e?this.__make(t,e):0===this.size?this.__empty():(this.__ownerID=e,this._map=t,this)},t}(Lt);Ma.isSet=Ia;var Pa,La=Ma.prototype;function xa(e,t){return e.__ownerID?(e.size=t.size,e._map=t,e):t===e._map?e:0===t.size?e.__empty():e.__make(t)}function Ca(e,t){var r=Object.create(La);return r.size=e?e.size:0,r._map=e,r.__ownerID=t,r}function Ra(){return Pa||(Pa=Ca(Bn()))}La[Oa]=!0,La.delete=La.remove,La.merge=La.concat=La.union,La.withMutations=In,La.asImmutable=Tn,La["@@transducer/init"]=La.asMutable=En,La["@@transducer/step"]=function(e,t){return e.add(t)},La["@@transducer/result"]=function(e){return e.asImmutable()},La.__empty=Ra,La.__make=Ca;var ja,ka=function(e){function t(e,r,n){if(!(this instanceof t))return new t(e,r,n);if(Qr(0!==n,"Cannot step a Range by 0"),e=e||0,void 0===r&&(r=1/0),n=void 0===n?1:Math.abs(n),r<e&&(n=-n),this._start=e,this._end=r,this._step=n,this.size=Math.max(0,Math.ceil((r-e)/n-1)+1),0===this.size){if(ja)return ja;ja=this}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(1!==this._step?" by "+this._step:"")+" ]"},t.prototype.get=function(e,t){return this.has(e)?this._start+ht(this,e)*this._step:t},t.prototype.includes=function(e){var t=(e-this._start)/this._step;return t>=0&&t<this.size&&t===Math.floor(t)},t.prototype.slice=function(e,r){return _t(e,r,this.size)?this:(e=mt(e,this.size),(r=yt(r,this.size))<=e?new t(0,0):new t(this.get(e,this._end),this.get(r,this._end),this._step))},t.prototype.indexOf=function(e){var t=e-this._start;if(t%this._step==0){var r=t/this._step;if(r>=0&&r<this.size)return r}return-1},t.prototype.lastIndexOf=function(e){return this.indexOf(e)},t.prototype.__iterate=function(e,t){for(var r=this.size,n=this._step,a=t?this._start+(r-1)*n:this._start,i=0;i!==r&&!1!==e(a,t?r-++i:i++,this);)a+=t?-n:n;return i},t.prototype.__iterator=function(e,t){var r=this.size,n=this._step,a=t?this._start+(r-1)*n:this._start,i=0;return new Gt(function(){if(i===r)return{value:void 0,done:!0};var o=a;return a+=t?-n:n,qt(e,t?r-++i:i++,o)})},t.prototype.equals=function(e){return e instanceof t?this._start===e._start&&this._end===e._end&&this._step===e._step:Ta(this,e)},t}(tr);function Da(e,t,r){for(var n=tn(t),a=0;a!==n.length;)if((e=on(e,n[a++],ct))===ct)return r;return e}function Na(e,t){return Da(this,e,t)}function Fa(){en(this.size);var e={};return this.__iterate(function(t,r){e[r]=t}),e}At.isIterable=St,At.isKeyed=It,At.isIndexed=Tt,At.isAssociative=wt,At.isOrdered=Nt,At.Iterator=Gt,wa(At,{toArray:function(){en(this.size);var e=new Array(this.size||0),t=It(this),r=0;return this.__iterate(function(n,a){e[r++]=t?[a,n]:n}),e},toIndexedSeq:function(){return new Cr(this)},toJS:function(){return Aa(this)},toKeyedSeq:function(){return new xr(this,!0)},toMap:function(){return An(this.toKeyedSeq())},toObject:Fa,toOrderedMap:function(){return pa(this.toKeyedSeq())},toOrderedSet:function(){return Za(It(this)?this.valueSeq():this)},toSet:function(){return Ma(It(this)?this.valueSeq():this)},toSetSeq:function(){return new Rr(this)},toSeq:function(){return Tt(this)?this.toIndexedSeq():It(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return ya(It(this)?this.valueSeq():this)},toList:function(){return Xn(It(this)?this.valueSeq():this)},toString:function(){return"[Collection]"},__toString:function(e,t){return 0===this.size?e+t:e+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+t},concat:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return Kr(this,function(e,t){var r=It(e),n=[e].concat(t).map(function(e){return St(e)?r&&(e=Mt(e)):e=r?ur(e):cr(Array.isArray(e)?e:[e]),e}).filter(function(e){return 0!==e.size});if(0===n.length)return e;if(1===n.length){var a=n[0];if(a===e||r&&It(a)||Tt(e)&&Tt(a))return a}var i=new nr(n);return r?i=i.toKeyedSeq():Tt(e)||(i=i.toSetSeq()),(i=i.flatten(!0)).size=n.reduce(function(e,t){if(void 0!==e){var r=t.size;if(void 0!==r)return e+r}},0),i}(this,e))},includes:function(e){return this.some(function(t){return _r(t,e)})},entries:function(){return this.__iterator(Ut)},every:function(e,t){en(this.size);var r=!0;return this.__iterate(function(n,a,i){if(!e.call(t,n,a,i))return r=!1,!1}),r},filter:function(e,t){return Kr(this,Fr(this,e,t,!0))},find:function(e,t,r){var n=this.findEntry(e,t);return n?n[1]:r},forEach:function(e,t){return en(this.size),this.__iterate(t?e.bind(t):e)},join:function(e){en(this.size),e=void 0!==e?""+e:",";var t="",r=!0;return this.__iterate(function(n){r?r=!1:t+=e,t+=null!=n?n.toString():""}),t},keys:function(){return this.__iterator(Ft)},map:function(e,t){return Kr(this,Dr(this,e,t))},reduce:function(e,t,r){return za(this,e,t,r,arguments.length<2,!1)},reduceRight:function(e,t,r){return za(this,e,t,r,arguments.length<2,!0)},reverse:function(){return Kr(this,Nr(this,!0))},slice:function(e,t){return Kr(this,Br(this,e,t,!0))},some:function(e,t){return!this.every(qa(e),t)},sort:function(e){return Kr(this,zr(this,e))},values:function(){return this.__iterator(Bt)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some(function(){return!0})},count:function(e,t){return ft(e?this.toSeq().filter(e,t):this)},countBy:function(e,t){return function(e,t,r){var n=An().asMutable();return e.__iterate(function(a,i){n.update(t.call(r,a,i,e),0,function(e){return e+1})}),n.asImmutable()}(this,e,t)},equals:function(e){return Ta(this,e)},entrySeq:function(){var e=this;if(e._cache)return new nr(e._cache);var t=e.toSeq().map(Ga).toIndexedSeq();return t.fromEntrySeq=function(){return e.toSeq()},t},filterNot:function(e,t){return this.filter(qa(e),t)},findEntry:function(e,t,r){var n=r;return this.__iterate(function(r,a,i){if(e.call(t,r,a,i))return n=[a,r],!1}),n},findKey:function(e,t){var r=this.findEntry(e,t);return r&&r[0]},findLast:function(e,t,r){return this.toKeyedSeq().reverse().find(e,t,r)},findLastEntry:function(e,t,r){return this.toKeyedSeq().reverse().findEntry(e,t,r)},findLastKey:function(e,t){return this.toKeyedSeq().reverse().findKey(e,t)},first:function(e){return this.find(dt,null,e)},flatMap:function(e,t){return Kr(this,function(e,t,r){var n=Yr(e);return e.toSeq().map(function(a,i){return n(t.call(r,a,i,e))}).flatten(!0)}(this,e,t))},flatten:function(e){return Kr(this,Vr(this,e,!0))},fromEntrySeq:function(){return new jr(this)},get:function(e,t){return this.find(function(t,r){return _r(r,e)},void 0,t)},getIn:Na,groupBy:function(e,t){return function(e,t,r){var n=It(e),a=(Nt(e)?pa():An()).asMutable();e.__iterate(function(i,o){a.update(t.call(r,i,o,e),function(e){return(e=e||[]).push(n?[o,i]:i),e})});var i=Yr(e);return a.map(function(t){return Kr(e,i(t))}).asImmutable()}(this,e,t)},has:function(e){return this.get(e,ct)!==ct},hasIn:function(e){return Da(this,e,ct)!==ct},isSubset:function(e){return e="function"==typeof e.includes?e:At(e),this.every(function(t){return e.includes(t)})},isSuperset:function(e){return(e="function"==typeof e.isSubset?e:At(e)).isSubset(this)},keyOf:function(e){return this.findKey(function(t){return _r(t,e)})},keySeq:function(){return this.toSeq().map(Ha).toIndexedSeq()},last:function(e){return this.toSeq().reverse().first(e)},lastKeyOf:function(e){return this.toKeyedSeq().reverse().keyOf(e)},max:function(e){return Hr(this,e)},maxBy:function(e,t){return Hr(this,t,e)},min:function(e){return Hr(this,e?Ka(e):Ya)},minBy:function(e,t){return Hr(this,t?Ka(t):Ya,e)},rest:function(){return this.slice(1)},skip:function(e){return 0===e?this:this.slice(Math.max(0,e))},skipLast:function(e){return 0===e?this:this.slice(0,-Math.max(0,e))},skipWhile:function(e,t){return Kr(this,Ur(this,e,t,!0))},skipUntil:function(e,t){return this.skipWhile(qa(e),t)},sortBy:function(e,t){return Kr(this,zr(this,t,e))},take:function(e){return this.slice(0,Math.max(0,e))},takeLast:function(e){return this.slice(-Math.max(0,e))},takeWhile:function(e,t){return Kr(this,function(e,t,r){var n=Wr(e);return n.__iterateUncached=function(n,a){var i=this;if(a)return this.cacheResult().__iterate(n,a);var o=0;return e.__iterate(function(e,a,s){return t.call(r,e,a,s)&&++o&&n(e,a,i)}),o},n.__iteratorUncached=function(n,a){var i=this;if(a)return this.cacheResult().__iterator(n,a);var o=e.__iterator(Ut,a),s=!0;return new Gt(function(){if(!s)return{value:void 0,done:!0};var e=o.next();if(e.done)return e;var a=e.value,u=a[0],c=a[1];return t.call(r,c,u,i)?n===Ut?e:qt(n,u,c,e):(s=!1,{value:void 0,done:!0})})},n}(this,e,t))},takeUntil:function(e,t){return this.takeWhile(qa(e),t)},update:function(e){return e(this)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=function(e){if(e.size===1/0)return 0;var t=Nt(e),r=It(e),n=t?1:0;return function(e,t){return t=mr(t,3432918353),t=mr(t<<15|t>>>-15,461845907),t=mr(t<<13|t>>>-13,5),t=mr((t=(t+3864292196|0)^e)^t>>>16,2246822507),yr((t=mr(t^t>>>13,3266489909))^t>>>16)}(e.__iterate(r?t?function(e,t){n=31*n+Wa(br(e),br(t))|0}:function(e,t){n=n+Wa(br(e),br(t))|0}:t?function(e){n=31*n+br(e)|0}:function(e){n=n+br(e)|0}),n)}(this))}});var Ba=At.prototype;Ba[vt]=!0,Ba[Ht]=Ba.values,Ba.toJSON=Ba.toArray,Ba.__toStringMapper=an,Ba.inspect=Ba.toSource=function(){return this.toString()},Ba.chain=Ba.flatMap,Ba.contains=Ba.includes,wa(Mt,{flip:function(){return Kr(this,kr(this))},mapEntries:function(e,t){var r=this,n=0;return Kr(this,this.toSeq().map(function(a,i){return e.call(t,[i,a],n++,r)}).fromEntrySeq())},mapKeys:function(e,t){var r=this;return Kr(this,this.toSeq().flip().map(function(n,a){return e.call(t,n,a,r)}).flip())}});var Ua=Mt.prototype;Ua[Ot]=!0,Ua[Ht]=Ba.entries,Ua.toJSON=Fa,Ua.__toStringMapper=function(e,t){return an(t)+": "+an(e)},wa(Pt,{toKeyedSeq:function(){return new xr(this,!1)},filter:function(e,t){return Kr(this,Fr(this,e,t,!1))},findIndex:function(e,t){var r=this.findEntry(e,t);return r?r[0]:-1},indexOf:function(e){var t=this.keyOf(e);return void 0===t?-1:t},lastIndexOf:function(e){var t=this.lastKeyOf(e);return void 0===t?-1:t},reverse:function(){return Kr(this,Nr(this,!1))},slice:function(e,t){return Kr(this,Br(this,e,t,!1))},splice:function(e,t){var r=arguments.length;if(t=Math.max(t||0,0),0===r||2===r&&!t)return this;e=mt(e,e<0?this.count():this.size);var n=this.slice(0,e);return Kr(this,1===r?n:n.concat(Jr(arguments,2),this.slice(e+t)))},findLastIndex:function(e,t){var r=this.findLastEntry(e,t);return r?r[0]:-1},first:function(e){return this.get(0,e)},flatten:function(e){return Kr(this,Vr(this,e,!1))},get:function(e,t){return(e=ht(this,e))<0||this.size===1/0||void 0!==this.size&&e>this.size?t:this.find(function(t,r){return r===e},void 0,t)},has:function(e){return(e=ht(this,e))>=0&&(void 0!==this.size?this.size===1/0||e<this.size:-1!==this.indexOf(e))},interpose:function(e){return Kr(this,function(e,t){var r=Wr(e);return r.size=e.size&&2*e.size-1,r.__iterateUncached=function(r,n){var a=this,i=0;return e.__iterate(function(e){return(!i||!1!==r(t,i++,a))&&!1!==r(e,i++,a)},n),i},r.__iteratorUncached=function(r,n){var a,i=e.__iterator(Bt,n),o=0;return new Gt(function(){return(!a||o%2)&&(a=i.next()).done?a:o%2?qt(r,o++,t):qt(r,o++,a.value,a)})},r}(this,e))},interleave:function(){var e=[this].concat(Jr(arguments)),t=qr(this.toSeq(),tr.of,e),r=t.flatten(!0);return t.size&&(r.size=t.size*e.length),Kr(this,r)},keySeq:function(){return ka(0,this.size)},last:function(e){return this.get(-1,e)},skipWhile:function(e,t){return Kr(this,Ur(this,e,t,!1))},zip:function(){return Kr(this,qr(this,$a,[this].concat(Jr(arguments))))},zipAll:function(){return Kr(this,qr(this,$a,[this].concat(Jr(arguments)),!0))},zipWith:function(e){var t=Jr(arguments);return t[0]=this,Kr(this,qr(this,e,t))}});var Va=Pt.prototype;function za(e,t,r,n,a,i){return en(e.size),e.__iterate(function(e,i,o){a?(a=!1,r=e):r=t.call(n,r,e,i,o)},i),r}function Ha(e,t){return t}function Ga(e,t){return[t,e]}function qa(e){return function(){return!e.apply(this,arguments)}}function Ka(e){return function(){return-e.apply(this,arguments)}}function $a(){return Jr(arguments)}function Ya(e,t){return e<t?1:e>t?-1:0}function Wa(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}Va[Et]=!0,Va[Dt]=!0,wa(Lt,{get:function(e,t){return this.has(e)?e:t},includes:function(e){return this.has(e)},keySeq:function(){return this.valueSeq()}}),Lt.prototype.has=Ba.includes,Lt.prototype.contains=Lt.prototype.includes,wa(er,Mt.prototype),wa(tr,Pt.prototype),wa(rr,Lt.prototype);var Za=function(e){function t(e){return null==e?ei():Ea(e)?e:ei().withMutations(function(t){var r=Lt(e);en(r.size),r.forEach(function(e){return t.add(e)})})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(e){return this(Mt(e).keySeq())},t.prototype.toString=function(){return this.__toString("OrderedSet {","}")},t}(Ma);Za.isOrderedSet=Ea;var Xa,Ja=Za.prototype;function Qa(e,t){var r=Object.create(Ja);return r.size=e?e.size:0,r._map=e,r.__ownerID=t,r}function ei(){return Xa||(Xa=Qa(ha()))}Ja[Dt]=!0,Ja.zip=Va.zip,Ja.zipWith=Va.zipWith,Ja.__empty=ei,Ja.__make=Qa;var ti=function(e,t){var r,n=function n(i){var o=this;if(i instanceof n)return i;if(!(this instanceof n))return new n(i);if(!r){r=!0;var s=Object.keys(e),u=a._indices={};a._name=t,a._keys=s,a._defaultValues=e;for(var c=0;c<s.length;c++){var l=s[c];u[l]=c,a[l]?"object"==typeof console&&console.warn&&console.warn("Cannot define "+ai(this)+' with property "'+l+'" since that property name is part of the Record API.'):oi(a,l)}}this.__ownerID=void 0,this._values=Xn().withMutations(function(e){e.setSize(o._keys.length),Mt(i).forEach(function(t,r){e.set(o._indices[r],t===o._defaultValues[r]?void 0:t)})})},a=n.prototype=Object.create(ri);return a.constructor=n,t&&(n.displayName=t),n};ti.prototype.toString=function(){for(var e,t=ai(this)+" { ",r=this._keys,n=0,a=r.length;n!==a;n++)t+=(n?", ":"")+(e=r[n])+": "+an(this.get(e));return t+" }"},ti.prototype.equals=function(e){return this===e||e&&this._keys===e._keys&&ii(this).equals(ii(e))},ti.prototype.hashCode=function(){return ii(this).hashCode()},ti.prototype.has=function(e){return this._indices.hasOwnProperty(e)},ti.prototype.get=function(e,t){if(!this.has(e))return t;var r=this._indices[e],n=this._values.get(r);return void 0===n?this._defaultValues[e]:n},ti.prototype.set=function(e,t){if(this.has(e)){var r=this._values.set(this._indices[e],t===this._defaultValues[e]?void 0:t);if(r!==this._values&&!this.__ownerID)return ni(this,r)}return this},ti.prototype.remove=function(e){return this.set(e)},ti.prototype.clear=function(){var e=this._values.clear().setSize(this._keys.length);return this.__ownerID?this:ni(this,e)},ti.prototype.wasAltered=function(){return this._values.wasAltered()},ti.prototype.toSeq=function(){return ii(this)},ti.prototype.toJS=function(){return Aa(this)},ti.prototype.entries=function(){return this.__iterator(Ut)},ti.prototype.__iterator=function(e,t){return ii(this).__iterator(e,t)},ti.prototype.__iterate=function(e,t){return ii(this).__iterate(e,t)},ti.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._values.__ensureOwner(e);return e?ni(this,t,e):(this.__ownerID=e,this._values=t,this)},ti.isRecord=jt,ti.getDescriptiveName=ai;var ri=ti.prototype;function ni(e,t,r){var n=Object.create(Object.getPrototypeOf(e));return n._values=t,n.__ownerID=r,n}function ai(e){return e.constructor.displayName||e.constructor.name||"Record"}function ii(e){return ur(e._keys.map(function(t){return[t,e.get(t)]}))}function oi(e,t){try{Object.defineProperty(e,t,{get:function(){return this.get(t)},set:function(e){Qr(this.__ownerID,"Cannot set on an immutable record."),this.set(t,e)}})}catch(e){}}function si(e,t){return function e(t,r,n,a,i,o){var s=Array.isArray(n)?tr:rn(n)?er:null;if(s){if(~t.indexOf(n))throw new TypeError("Cannot convert circular structure to Immutable");t.push(n),i&&""!==a&&i.push(a);var u=r.call(o,a,s(n).map(function(a,o){return e(t,r,a,o,i,n)}),i&&i.slice());return t.pop(),i&&i.pop(),u}return n}([],t||ui,e,"",t&&t.length>2?[]:void 0,{"":e})}function ui(e,t){return It(t)?t.toMap():t.toList()}function ci(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}ri[Rt]=!0,ri.delete=ri.remove,ri.deleteIn=ri.removeIn=ln,ri.getIn=Na,ri.hasIn=Ba.hasIn,ri.merge=dn,ri.mergeWith=_n,ri.mergeIn=Sn,ri.mergeDeep=bn,ri.mergeDeepWith=vn,ri.mergeDeepIn=On,ri.setIn=cn,ri.update=fn,ri.updateIn=hn,ri.withMutations=In,ri.asMutable=En,ri.asImmutable=Tn,ri[Ht]=ri.entries,ri.toJSON=ri.toObject=Ba.toObject,ri.inspect=ri.toSource=function(){return this.toString()},Math.PI,Math.PI;var li=function(e){return e.map.module.temporalExtent},pi=function(e){return e.map.module.highlightTemporalExtent},fi=it(function(e){return e.map.tracks.data},function(e){return e.filter(function(e){return"geojson"===e.type})}),hi=it(fi,function(e){return e.filter(function(e){return void 0!==e.data})}),di=function(e,t){return{sources:Object(h.l)({},e.sources,t.sources),layers:[].concat(Object(h.m)(e.layers),Object(h.m)(t.layers))}},_i=function(e,t){var r=t.start,n=t.end;if(!e||!e.features)return null;var a=e.features.reduce(function(e,t){if(t.properties.coordinateProperties.times&&t.properties.coordinateProperties.times.length>0){var a=t.geometry.coordinates.reduce(function(e,a,i){var o=t.properties.coordinateProperties.times[i];return o>=r&&o<=n&&(e.coordinates.push(a),e.times.push(o)),e},{coordinates:[],times:[]});if(!a.coordinates.length)return e;var i=Object(h.l)({},t,{geometry:Object(h.l)({},t.geometry,{coordinates:a.coordinates}),properties:Object(h.l)({},t.properties,{coordinateProperties:{times:a.times}})});e.push(i)}return e},[]);return Object(h.l)({},e,{features:a})},mi=it([li,hi],function(e,t){var r=e&&e.length>0,n=t&&t.length>0;if(!r||!n)return null;var a={start:e[0].getTime(),end:e[1].getTime()};return t.reduce(function(e,t){if(!t.data)return e;var r="".concat(t.id,"Track"),n={sources:Object(h.i)({},r,{type:"geojson",data:_i(t.data,a)}),layers:[{id:"".concat(t.id,"Lines"),source:r,type:"line",paint:{"line-width":1,"line-color":t.color}},{id:"".concat(t.id,"Points"),source:r,type:"circle",filter:["match",["geometry-type"],["","Point"],!0,!1],paint:{"circle-radius":4,"circle-color":t.color}}]};return di(e,n)},{sources:{},layers:[]})}),yi=it([pi,hi],function(e,t){var r=e&&e.length>0,n=t&&t.length>0;if(!r||!n)return null;var a={start:e[0].getTime(),end:e[1].getTime()};return t.reduce(function(e,t){if(!t.data)return e;var r="".concat(t.id,"HighlightedTrack"),n={sources:Object(h.i)({},r,{type:"geojson",data:_i(t.data,a)}),layers:[{id:"".concat(t.id,"HighlightedLines"),source:r,type:"line",paint:{"line-width":1,"line-color":"#fff"}}]};return di(e,n)},{sources:{},layers:[]})}),gi=it([mi,yi],function(e,t){return t?di(e,t):e}),bi=Object(h.a)(function(e,t){function r(e,t,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function n(e,t,n){return void 0===n&&(n={}),r({type:"Point",coordinates:e},t,n)}function a(e,t,n){void 0===n&&(n={});for(var a=0,i=e;a<i.length;a++){var o=i[a];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return r({type:"Polygon",coordinates:e},t,n)}function i(e,t,n){if(void 0===n&&(n={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return r({type:"LineString",coordinates:e},t,n)}function o(e,t){void 0===t&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function s(e,t,n){return void 0===n&&(n={}),r({type:"MultiLineString",coordinates:e},t,n)}function u(e,t,n){return void 0===n&&(n={}),r({type:"MultiPoint",coordinates:e},t,n)}function c(e,t,n){return void 0===n&&(n={}),r({type:"MultiPolygon",coordinates:e},t,n)}function l(e,r){void 0===r&&(r="kilometers");var n=t.factors[r];if(!n)throw new Error(r+" units is invalid");return e*n}function p(e,r){void 0===r&&(r="kilometers");var n=t.factors[r];if(!n)throw new Error(r+" units is invalid");return e/n}function f(e){return e%(2*Math.PI)*180/Math.PI}function h(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)&&!/^\s*$/.test(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=6371008.8,t.factors={centimeters:100*t.earthRadius,centimetres:100*t.earthRadius,degrees:t.earthRadius/111325,feet:3.28084*t.earthRadius,inches:39.37*t.earthRadius,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:1e3*t.earthRadius,millimetres:1e3*t.earthRadius,nauticalmiles:t.earthRadius/1852,radians:1,yards:t.earthRadius/1.0936},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1/1.0936},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:3.86e-7,millimeters:1e6,millimetres:1e6,yards:1.195990046},t.feature=r,t.geometry=function(e,t,r){switch(void 0===r&&(r={}),e){case"Point":return n(t).geometry;case"LineString":return i(t).geometry;case"Polygon":return a(t).geometry;case"MultiPoint":return u(t).geometry;case"MultiLineString":return s(t).geometry;case"MultiPolygon":return c(t).geometry;default:throw new Error(e+" is invalid")}},t.point=n,t.points=function(e,t,r){return void 0===r&&(r={}),o(e.map(function(e){return n(e,t)}),r)},t.polygon=a,t.polygons=function(e,t,r){return void 0===r&&(r={}),o(e.map(function(e){return a(e,t)}),r)},t.lineString=i,t.lineStrings=function(e,t,r){return void 0===r&&(r={}),o(e.map(function(e){return i(e,t)}),r)},t.featureCollection=o,t.multiLineString=s,t.multiPoint=u,t.multiPolygon=c,t.geometryCollection=function(e,t,n){return void 0===n&&(n={}),r({type:"GeometryCollection",geometries:e},t,n)},t.round=function(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,t||0);return Math.round(e*r)/r},t.radiansToLength=l,t.lengthToRadians=p,t.lengthToDegrees=function(e,t){return f(p(e,t))},t.bearingToAzimuth=function(e){var t=e%360;return t<0&&(t+=360),t},t.radiansToDegrees=f,t.degreesToRadians=function(e){return e%360*Math.PI/180},t.convertLength=function(e,t,r){if(void 0===t&&(t="kilometers"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("length must be a positive number");return l(p(e,t),r)},t.convertArea=function(e,r,n){if(void 0===r&&(r="meters"),void 0===n&&(n="kilometers"),!(e>=0))throw new Error("area must be a positive number");var a=t.areaFactors[r];if(!a)throw new Error("invalid original units");var i=t.areaFactors[n];if(!i)throw new Error("invalid final units");return e/a*i},t.isNumber=h,t.isObject=function(e){return!!e&&e.constructor===Object},t.validateBBox=function(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(e){if(!h(e))throw new Error("bbox must only contain numbers")})},t.validateId=function(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")},t.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},t.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},t.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},t.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},t.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},t.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},t.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}});Object(h.b)(bi),bi.earthRadius,bi.factors,bi.unitsFactors,bi.areaFactors,bi.feature,bi.geometry,bi.point,bi.points,bi.polygon,bi.polygons,bi.lineString,bi.lineStrings,bi.featureCollection,bi.multiLineString,bi.multiPoint,bi.multiPolygon,bi.geometryCollection,bi.round,bi.radiansToLength,bi.lengthToRadians,bi.lengthToDegrees,bi.bearingToAzimuth,bi.radiansToDegrees,bi.degreesToRadians,bi.convertLength,bi.convertArea,bi.isNumber,bi.isObject,bi.validateBBox,bi.validateId,bi.radians2degrees,bi.degrees2radians,bi.distanceToDegrees,bi.distanceToRadians,bi.radiansToDistance,bi.bearingToAngle,bi.convertDistance;var vi=Object(h.a)(function(e,t){function r(e,t,n){if(null!==e)for(var a,i,o,s,u,c,l,p,f=0,h=0,d=e.type,_="FeatureCollection"===d,m="Feature"===d,y=_?e.features.length:1,g=0;g<y;g++){u=(p=!!(l=_?e.features[g].geometry:m?e.geometry:e)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var b=0;b<u;b++){var v=0,S=0;if(null!==(s=p?l.geometries[b]:l)){c=s.coordinates;var O=s.type;switch(f=!n||"Polygon"!==O&&"MultiPolygon"!==O?0:1,O){case null:break;case"Point":if(!1===t(c,h,g,v,S))return!1;h++,v++;break;case"LineString":case"MultiPoint":for(a=0;a<c.length;a++){if(!1===t(c[a],h,g,v,S))return!1;h++,"MultiPoint"===O&&v++}"LineString"===O&&v++;break;case"Polygon":case"MultiLineString":for(a=0;a<c.length;a++){for(i=0;i<c[a].length-f;i++){if(!1===t(c[a][i],h,g,v,S))return!1;h++}"MultiLineString"===O&&v++,"Polygon"===O&&S++}"Polygon"===O&&v++;break;case"MultiPolygon":for(a=0;a<c.length;a++){for(S=0,i=0;i<c[a].length;i++){for(o=0;o<c[a][i].length-f;o++){if(!1===t(c[a][i][o],h,g,v,S))return!1;h++}S++}v++}break;case"GeometryCollection":for(a=0;a<s.geometries.length;a++)if(!1===r(s.geometries[a],t,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function n(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length&&!1!==t(e.features[r].properties,r);r++);break;case"Feature":t(e.properties,0)}}function a(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length&&!1!==t(e.features[r],r);r++);}function i(e,t){var r,n,a,i,o,s,u,c,l,p,f=0,h="FeatureCollection"===e.type,d="Feature"===e.type,_=h?e.features.length:1;for(r=0;r<_;r++){for(s=h?e.features[r].geometry:d?e.geometry:e,c=h?e.features[r].properties:d?e.properties:{},l=h?e.features[r].bbox:d?e.bbox:void 0,p=h?e.features[r].id:d?e.id:void 0,o=(u=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,a=0;a<o;a++)if(null!==(i=u?s.geometries[a]:s))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(i,f,c,l,p))return!1;break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(!1===t(i.geometries[n],f,c,l,p))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,f,c,l,p))return!1;f++}}function o(e,t){i(e,function(e,r,n,a,i){var o,s=null===e?null:e.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==t(bi.feature(e,n,{bbox:a,id:i}),r,0)&&void 0}switch(s){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var u=0;u<e.coordinates.length;u++){var c={type:o,coordinates:e.coordinates[u]};if(!1===t(bi.feature(c,n),r,u))return!1}})}function s(e,t){o(e,function(e,n,a){var i=0;if(e.geometry){var o=e.geometry.type;if("Point"!==o&&"MultiPoint"!==o){var s,u=0,c=0,l=0;return!1!==r(e,function(r,o,p,f,h){if(void 0===s||n>u||f>c||h>l)return s=r,u=n,c=f,l=h,void(i=0);var d=bi.lineString([s,r],e.properties);if(!1===t(d,n,a,h,i))return!1;i++,s=r})&&void 0}}})}function u(e,t){if(!e)throw new Error("geojson is required");o(e,function(e,r,n){if(null!==e.geometry){var a=e.geometry.type,i=e.geometry.coordinates;switch(a){case"LineString":if(!1===t(e,r,n,0,0))return!1;break;case"Polygon":for(var o=0;o<i.length;o++)if(!1===t(bi.lineString(i[o],e.properties),r,n,o))return!1}}})}Object.defineProperty(t,"__esModule",{value:!0}),t.coordEach=r,t.coordReduce=function(e,t,n,a){var i=n;return r(e,function(e,r,a,o,s){i=0===r&&void 0===n?e:t(i,e,r,a,o,s)},a),i},t.propEach=n,t.propReduce=function(e,t,r){var a=r;return n(e,function(e,n){a=0===n&&void 0===r?e:t(a,e,n)}),a},t.featureEach=a,t.featureReduce=function(e,t,r){var n=r;return a(e,function(e,a){n=0===a&&void 0===r?e:t(n,e,a)}),n},t.coordAll=function(e){var t=[];return r(e,function(e){t.push(e)}),t},t.geomEach=i,t.geomReduce=function(e,t,r){var n=r;return i(e,function(e,a,i,o,s){n=0===a&&void 0===r?e:t(n,e,a,i,o,s)}),n},t.flattenEach=o,t.flattenReduce=function(e,t,r){var n=r;return o(e,function(e,a,i){n=0===a&&0===i&&void 0===r?e:t(n,e,a,i)}),n},t.segmentEach=s,t.segmentReduce=function(e,t,r){var n=r,a=!1;return s(e,function(e,i,o,s,u){n=!1===a&&void 0===r?e:t(n,e,i,o,s,u),a=!0}),n},t.lineEach=u,t.lineReduce=function(e,t,r){var n=r;return u(e,function(e,a,i,o){n=0===a&&void 0===r?e:t(n,e,a,i,o)}),n},t.findSegment=function(e,t){if(t=t||{},!bi.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,a=t.multiFeatureIndex||0,i=t.geometryIndex||0,o=t.segmentIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),s=s||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":s=s||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=u.length+o-1),bi.lineString([u[o],u[o+1]],s,t);case"Polygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o-1),bi.lineString([u[i][o],u[i][o+1]],s,t);case"MultiLineString":return a<0&&(a=u.length+a),o<0&&(o=u[a].length+o-1),bi.lineString([u[a][o],u[a][o+1]],s,t);case"MultiPolygon":return a<0&&(a=u.length+a),i<0&&(i=u[a].length+i),o<0&&(o=u[a][i].length-o-1),bi.lineString([u[a][i][o],u[a][i][o+1]],s,t)}throw new Error("geojson is invalid")},t.findPoint=function(e,t){if(t=t||{},!bi.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,a=t.multiFeatureIndex||0,i=t.geometryIndex||0,o=t.coordIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),s=s||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":s=s||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":return bi.point(u,s,t);case"MultiPoint":return a<0&&(a=u.length+a),bi.point(u[a],s,t);case"LineString":return o<0&&(o=u.length+o),bi.point(u[o],s,t);case"Polygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o),bi.point(u[i][o],s,t);case"MultiLineString":return a<0&&(a=u.length+a),o<0&&(o=u[a].length+o),bi.point(u[a][o],s,t);case"MultiPolygon":return a<0&&(a=u.length+a),i<0&&(i=u[a].length+i),o<0&&(o=u[a][i].length-o),bi.point(u[a][i][o],s,t)}throw new Error("geojson is invalid")}});Object(h.b)(vi),vi.coordEach,vi.coordReduce,vi.propEach,vi.propReduce,vi.featureEach,vi.featureReduce,vi.coordAll,vi.geomEach,vi.geomReduce,vi.flattenEach,vi.flattenReduce,vi.segmentEach,vi.segmentReduce,vi.lineEach,vi.lineReduce,vi.findSegment,vi.findPoint;var Si=Object(h.b)(Object(h.a)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=6378137;function n(e){var t=0;if(e&&e.length>0){t+=Math.abs(a(e[0]));for(var r=1;r<e.length;r++)t-=Math.abs(a(e[r]))}return t}function a(e){var t,n,a,o,s,u,c=0,l=e.length;if(l>2){for(u=0;u<l;u++)u===l-2?(a=l-2,o=l-1,s=0):u===l-1?(a=l-1,o=0,s=1):(a=u,o=u+1,s=u+2),t=e[a],n=e[o],c+=(i(e[s][0])-i(t[0]))*Math.sin(i(n[1]));c=c*r*r/2}return c}function i(e){return e*Math.PI/180}t.default=function(e){return vi.geomReduce(e,function(e,t){return e+function(e){var t,r=0;switch(e.type){case"Polygon":return n(e.coordinates);case"MultiPolygon":for(t=0;t<e.coordinates.length;t++)r+=n(e.coordinates[t]);return r;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(t)},0)}})),Oi="SET_MAP_CURSOR",Ii=function(e,t,r){var n=t.style.mapStyle.toJS().sources[e];return void 0===n&&console.warn("Couldnt find source when looking for fields of layer",e),"geojson"!==n.type?void 0===n.metadata||void 0===n.metadata["gfw:popups"]?null:n.metadata["gfw:popups"]:0===Object.keys(r.properties).length?null:Object.keys(r.properties).map(function(e){return{id:e}})},Ei=function(e){return void 0!==e.layer.metadata&&e.layer.metadata["gfw:id"]||e.layer.source},Ti=function(e){if(void 0!==e&&e.length)for(var t=0;t<e.length;t++){var r=e[t],n=Ei(r);if(void 0!==n)return{feature:r,staticLayerId:n}}},wi=function(){function e(t,r,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object(h.d)(this,e),this.stage=new PIXI.particles.ParticleContainer(Ue.eb,{scale:!0,alpha:!0,position:!0,uvs:!0}),!1===a&&(this.stage.blendMode=PIXI.BLEND_MODES.SCREEN),this.spritesPool=[];var i=new PIXI.Rectangle(0,0,2*Ue.fb,2*Ue.fb);this.mainVesselTexture=new PIXI.Texture(t,i),this._setTextureFrame(r,n),this.clearSpriteProps()}return Object(h.g)(e,[{key:"clearSpriteProps",value:function(){this.spritesProps={x:new Float32Array(Ue.eb),y:new Float32Array(Ue.eb),a:new Float32Array(Ue.eb),s:new Float32Array(Ue.eb)},this.spritesPropsCount=0}},{key:"pushSpriteProps",value:function(e,t,r,n){this.spritesProps.x[this.spritesPropsCount]=e,this.spritesProps.y[this.spritesPropsCount]=t,this.spritesProps.a[this.spritesPropsCount]=r,this.spritesProps.s[this.spritesPropsCount]=n,this.spritesPropsCount++}},{key:"setRenderingStyleIndex",value:function(e){this._setTextureFrame(e)}},{key:"destroy",value:function(){this.spritesPool=null,this.stage.destroy({children:!0})}},{key:"_setTextureFrame",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.mainVesselTexture.frame.clone();if(null!==e&&(r.x=2*Ue.fb*e+e),null!==t){var n=function(e){return Math.round(e/360*30)}(t);30===n&&(n=0),r.y=n*Ue.fb*2,n>0&&(r.y+=n)}this.mainVesselTexture.frame=r,this.mainVesselTexture.update()}},{key:"render",value:function(){var e=this.spritesPropsCount;this.resizeSpritesPool();for(var t=0;t<e;t++){var r=this.stage.children[t],n=this.spritesProps.s[t];r.setTransform(this.spritesProps.x[t],this.spritesProps.y[t],n,n),r.alpha=this.spritesProps.a[t]}for(var a=this.stage.children.length,i=e;i<a;i++)this.stage.children[i].x=-100}},{key:"resizeSpritesPool",value:function(){var e=this.spritesPropsCount-this.stage.children.length;if(e<-4999)for(var t=Math.min(100,-e),r=0;r<t;r++)this.stage.removeChildAt(0);if(e>0){var n=Math.max(5e3,e);this._addSprites(n)}}},{key:"_addSprites",value:function(e){for(var t=0;t<e;t++){var r=new PIXI.Sprite(this.mainVesselTexture);r.anchor.x=.5,r.anchor.y=.5,r.x=-100,this.stage.addChild(r)}}}]),e}(),Ai=function(e,t,r){return[1/1.5*(r[0]*e+r[4]*t+r[12]),1/1.5*(r[5]*t+r[13])]},Mi=function(e){function t(){return Object(h.d)(this,t),Object(h.e)(this,Object(h.f)(t).apply(this,arguments))}return Object(h.c)(t,e),Object(h.g)(t,[{key:"componentDidMount",value:function(){this._build()}},{key:"componentWillUnmount",value:function(){this._destroy()}},{key:"componentDidUpdate",value:function(){this._redraw()}},{key:"componentWillReceiveProps",value:function(e){e.useRadialGradientStyle!==this.props.useRadialGradientStyle&&this.setBrushZoomRenderingStyle(e.useRadialGradientStyle)}},{key:"_build",value:function(){var e=this.props,t=e.layer,r=e.rootStage,n=e.useRadialGradientStyle,a=e.customRenderingStyle;this.subLayers={},this.renderingStyle=t.header&&t.header.rendering?t.header.rendering:a,this.setBrushRenderingStyle(this.renderingStyle.style),this.setBrushZoomRenderingStyle(n),this.stage=new He.Container,r.addChild(this.stage)}},{key:"setBrushRenderingStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue.gb.NORMAL;this.brushRenderingStyle="string"==typeof e?Ue.gb[e.toUpperCase()]:e,this._setBrushRenderingStyleIndex()}},{key:"setBrushZoomRenderingStyle",value:function(e){this.brushZoomRenderingStyle=!0===e?Ue.hb.RADIAL_GRADIENT:Ue.hb.CIRCLE,this._setBrushRenderingStyleIndex()}},{key:"_setBrushRenderingStyleIndex",value:function(){var e=this,t=this.brushRenderingStyle===Ue.gb.NORMAL?this.brushZoomRenderingStyle:0,r=this.brushRenderingStyle+t;r!==this.renderingStyleIndex&&(this.renderingStyleIndex=r,Object.values(this.subLayers).forEach(function(t){t.setRenderingStyleIndex(e.renderingStyleIndex)}))}},{key:"_redraw",value:function(){var e=this,t=this.props,r=t.filters,n=t.baseTexture,a=t.layer;if(null!=a&&void 0!==a.tiles&&!1!==a.visible){this.stage.visible=!0,this.stage.alpha=a.opacity;for(var i=a.tiles,o=a.hue,s=void 0!==r&&r.length?r.filter(function(e){return!0!==e.pass}).map(function(e){return void 0===e.hue?"0":e.hue.toString()}):[o.toString()],u=Object.keys(this.subLayers),c=Object(Ue.ib)(s.concat(u)),l=0;l<c.length;l++){var p=c[l];-1!==s.indexOf(p)?(-1===u.indexOf(p)&&(this.subLayers[p]=this._createSublayer(n,this.renderingStyleIndex,p)),this.subLayers[p].clearSpriteProps()):(this._destroySubLayer(this.subLayers[p]),delete this.subLayers[p])}s.length&&(i.forEach(function(t){e._setSubLayersSpritePropsForTile({data:t.data,numFilters:r.length,defaultHue:o})}),s.forEach(function(t){e.subLayers[t].render()}))}else this.stage.visible=!1}},{key:"_setSubLayersSpritePropsForTile",value:function(e){var t=e.data,r=e.numFilters,n=e.defaultHue;if(t)for(var a=this.props,i=a.startIndex,o=a.endIndex,s=a.viewport,u=a.filters,c=a.viewportLeft,l=a.viewportRight,p=i;p<o;p++){var f=t[p];if(f)for(var d=0,_=f.worldX.length;d<_;d++){var m=void 0;void 0!==u&&u.length||(m=n);for(var y=0;y<r;y++){var g=u[y];if(Object(Ue.jb)(f,d,g.filterValues)){m=g.hue;break}}if(void 0!==m){var b=f.worldX[d];c>0&&b<c?b+=512:c<0&&b>l&&(b-=512);var v=b*s.scale,S=f.worldY[d]*s.scale,O=s.pixelProjectionMatrix,I=0===s.pitch?Ai(v,S,O):Object(Ue.kb)([v,S],O),E=Object(h.h)(I,2),T=E[0],w=E[1];T>-10&&T<s.width+10&&w>-10&&w<s.height+10&&this.subLayers[m].pushSpriteProps(T,w,f.opacity?f.opacity[d]:this.renderingStyle.defaultOpacity,f.radius?f.radius[d]:this.renderingStyle.defaultSize)}}}}},{key:"_createSublayer",value:function(e,t,r){var n=new wi(e,t,r,this.brushRenderingStyle===Ue.gb.BULLSEYE);return this.stage.addChild(n.stage),n}},{key:"_destroy",value:function(){Object.values(this.subLayers).forEach(this._destroySubLayer.bind(this)),this.stage.destroy({children:!0}),this.props.rootStage.removeChild(this.stage)}},{key:"_destroySubLayer",value:function(e){this.stage.removeChild(e.stage),e.destroy()}},{key:"render",value:function(){return null}}]),t}(_.a.Component);Mi.propTypes={layer:S.object,rootStage:S.object,viewport:S.object,startIndex:S.number,endIndex:S.number,filters:S.array,baseTexture:S.object,useRadialGradientStyle:S.bool,customRenderingStyle:S.object,viewportLeft:S.number,viewportRight:S.number};var Pi=function(e){function t(){return Object(h.d)(this,t),Object(h.e)(this,Object(h.f)(t).apply(this,arguments))}return Object(h.c)(t,e),Object(h.g)(t,[{key:"componentDidMount",value:function(){this._build()}},{key:"componentDidUpdate",value:function(){this._redraw()}},{key:"_build",value:function(){var e=this.props.rootStage;this.stage=new PIXI.Graphics,this.stage.nativeLines=!0,e.addChild(this.stage)}},{key:"clear",value:function(){this.stage.clear()}},{key:"_redraw",value:function(){var e=this,t=this.props,r=t.tracks,n=t.zoom,a=t.startIndex,i=t.endIndex,o=t.highlightTemporalExtentIndexes;if(this.clear(),r.length){var s=null===o?void 0:[Math.max(a,o[0]),Math.min(i,o[1])],u=s&&s[1]-s[0]>0?s:void 0,c=n>Ue.lb,l=1+.5*(n-Ue.lb),p=void 0!==u&&u[0]>0&&u[1]>0;r.forEach(function(t){e._drawTrack({data:t.data,startIndex:a,endIndex:i,drawFishingCircles:c,fishingCirclesRadius:l,color:"0x".concat(t.color.substr(1)),lineThickness:1,lineOpacity:1}),!0===p&&e._drawTrack({data:t.data,startIndex:o[0],endIndex:o[1],drawFishingCircles:c,fishingCirclesRadius:l,color:"0xFFFFFF",lineThickness:2,lineOpacity:1})})}}},{key:"_drawTrack",value:function(e){var t,r,n,a=this,i=e.data,o=e.startIndex,s=e.endIndex,u=e.drawFishingCircles,c=e.fishingCirclesRadius,l=e.color,p=e.lineThickness,f=e.lineOpacity,d=e.worldOffset,_=void 0===d?0:d,m=this.props.viewport,y=0,g={x:[],y:[]};this.stage.lineStyle(p,l,f);for(var b=!1,v=o;v<s;v++){var S=i[v];if(S)for(var O=0,I=S.series.length;O<I;O++){var E=S.series[O];y++;var T=S.worldX[O]+_,w=S.worldY[O],A=Object(Ue.kb)([T*m.scale,w*m.scale],m.pixelProjectionMatrix),M=Object(h.h)(A,2),P=M[0],L=M[1];if(t!==E&&this.stage.moveTo(P,L),r&&Math.abs(T-r)>256){0===_&&(b=!0);var x=n+(w-n)/2,C=T-r<0,R=_+(512-1e-6),j=C?_:R,k=Object(Ue.kb)([(C?R:_)*m.scale,x*m.scale],m.pixelProjectionMatrix),D=Object(h.h)(k,2),N=D[0],F=D[1];this.stage.lineTo(N,F);var B=Object(Ue.kb)([j*m.scale,x*m.scale],m.pixelProjectionMatrix),U=Object(h.h)(B,2),V=U[0],z=U[1];this.stage.moveTo(V,z)}this.stage.lineTo(P,L),u&&!0===S.hasFishing[O]&&(g.x.push(P),g.y.push(L)),r=T,n=w,t=E}}if(u){this.stage.lineStyle(0),this.stage.beginFill(l,1);for(var H=0,G=g.x.length;H<G;H++)this.stage.drawCircle(g.x[H],g.y[H],c);this.stage.endFill()}return!0===b&&[-512,512].forEach(function(e){a._drawTrack({worldOffset:e,data:i,startIndex:o,endIndex:s,drawFishingCircles:u,fishingCirclesRadius:c,color:l,lineThickness:p,lineOpacity:f})}),y}},{key:"render",value:function(){return null}}]),t}(_.a.Component);Pi.propTypes={zoom:S.number,rootStage:S.object,viewport:S.object,startIndex:S.number,endIndex:S.number,highlightTemporalExtentIndexes:S.array,tracks:S.array};var Li=function(e){function t(){var e,r;Object(h.d)(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=Object(h.e)(this,(e=Object(h.f)(t)).call.apply(e,[this].concat(a))),Object(h.i)(Object(h.j)(r),"state",{pixiReady:!1}),Object(h.i)(Object(h.j)(r),"onTouchStart",function(e){e.touches.length&&r.queryCoords(e.touches[0].clientX,e.touches[0].clientY)}),Object(h.i)(Object(h.j)(r),"onMouseMove",function(e){r.queryCoords(e.clientX,e.clientY)}),Object(h.i)(Object(h.j)(r),"_onTick",function(){!0===r.heatmapFadingIn&&r.heatmapStage.alpha<1&&r._heatmapFadeinStep()}),r}return Object(h.c)(t,ze.a),Object(h.g)(t,[{key:"componentDidMount",value:function(){this._build(),this.setState({pixiReady:!0})}},{key:"componentWillReceiveProps",value:function(e){this.props.exportNativeViewport(this._context.viewport),e.viewport.width===this.props.viewport.width&&e.viewport.height===this.props.viewport.height||this._updateViewportSize(e.viewport.width,e.viewport.height)}},{key:"_build",value:function(){var e=this.props.viewport,t=e.width,r=e.height;this.pixi=new He.Application({width:t,height:r,transparent:!0,antialias:!0}),this.renderer=this.pixi.renderer,this.canvas=this.pixi.view,this.canvas.style.position="absolute",this.container.appendChild(this.canvas),this.stage=this.pixi.stage;var n=function(e,t){var r=document.createElement("canvas"),n=r.getContext("2d"),a=2*e;r.width=3*a+2,r.height=31*a+31;for(var i=0;i<31;i++){var o=a*i+i,s=o+e,u=e,c=n.createRadialGradient(u,s,e*t,u,s,e),l=Ye(i),p=Ke(l);c.addColorStop(0,p);var f=Ge(We(l+30),80,100);c.addColorStop(1,"rgba(".concat(f.r,", ").concat(f.g,", ").concat(f.b,", 0)")),n.fillStyle=c,n.fillRect(0,o,a,a),u+=a+1,n.beginPath(),n.arc(u,s,e,0,2*Math.PI,!1),n.fillStyle=p,n.fill(),u+=a+1,n.beginPath(),n.arc(u,s,.4*e,0,2*Math.PI,!1),n.fillStyle=p,n.fill(),n.beginPath(),n.arc(u,s,.95*e,0,2*Math.PI,!1),n.lineWidth=1,n.strokeStyle=p,n.stroke()}return r}(Ue.fb,Ue.mb);this.baseTexture=He.Texture.fromCanvas(n),this.heatmapStage=new He.Container,this.stage.addChild(this.heatmapStage),this.pixi.ticker.add(this._onTick)}},{key:"_updateViewportSize",value:function(e,t){this.renderer.resize(e,t)}},{key:"toggleHeatmapDimming",value:function(e){void 0!==this.heatmapStage&&(!0===e&&(this.heatmapFadingIn=!1),this.heatmapStage.alpha=!0===e?Ue.nb:1)}},{key:"queryCoords",value:function(e,t){if(!this.props.heatmapLayers.every(function(e){return!0!==e.interactive})){var r=this._context.viewport,n=r.unproject([e,t]),a=Object(h.h)(n,2),i=a[0],o=a[1],s=i;s>180?s-=360:s<-180&&(s+=360);var u=Object(Ue.ob)([s,o],1),c=Object(h.h)(u,2),l=c[0],p=c[1],f=Ue.pb/r.scale;this.props.queryHeatmapVessels({longitude:s,latitude:o,worldX:l,worldY:p,toleranceRadiusInWorldUnits:f},this.props.temporalExtentIndexes)}}},{key:"_startHeatmapFadein",value:function(){this.heatmapFadingIn=!0,this.heatmapFadeinStartTimestamp=void 0}},{key:"_heatmapFadeinStep",value:function(){void 0===this.heatmapFadeinStartTimestamp&&(this.heatmapFadeinStartTimestamp=Date.now());var e=(Date.now()-this.heatmapFadeinStartTimestamp)/1e3,t=this.heatmapStage.alpha+(1-this.heatmapStage.alpha)*e;t>=1&&(t=1,this.heatmapFadingIn=!1),this.heatmapStage.alpha=t}},{key:"_getHighlightData",value:function(e,t,r){var n=Ue.qb,a={id:"__HIGHLIGHT__",visible:!0,opacity:1,hue:Ue.qb},i=[];if(void 0!==e&&void 0!==e.layer&&void 0!==e.foundVessels&&!0!==e.isEmpty){var o=r.find(function(t){return t.id===e.layer.id});a=Object(h.l)({highlightLayerData:a},o),i=e.foundVessels.map(function(e){return{hue:n,filterValues:{series:[e.series]}}})}else if(null!==t){var s=r.find(function(e){return e.id===t.layer.id});a=Object(h.l)({highlightLayerData:a},s),i=[{hue:n,filterValues:{series:[t.seriesgroup]}}]}return{highlightLayerData:a,highlightFilters:i}}},{key:"_render",value:function(){var e=this,t=this.props,r=t.zoom,n=t.heatmapLayers,a=t.temporalExtentIndexes,i=t.highlightTemporalExtentIndexes,o=t.highlightedVessels,s=t.highlightedClickedVessel,u=t.tracks,c=t.leftWorldScaled,l=t.rightWorldScaled,p=this._context.viewport,f=this.state.pixiReady,h=a[0],m=a[1],y=r<Ue.rb;if(!0!==o.isEmpty&&this.toggleHeatmapDimming(!0),!0===o.isEmpty&&0===u.length&&this._startHeatmapFadein(),this.renderer){var g=this.renderer.gl.getError();0!==g&&console.log(g)}var b=this._getHighlightData(o,s,n),v=b.highlightLayerData,S=b.highlightFilters;return _.a.createElement("div",{ref:function(t){e.container=t},style:{position:"absolute"},onMouseMove:this.onMouseMove,onTouchStart:this.onTouchStart},!0===f&&_.a.createElement(d.Fragment,null,n.map(function(t){return _.a.createElement(Mi,{key:t.id,layer:t,filters:t.filters||[],viewport:p,startIndex:h,endIndex:m,baseTexture:e.baseTexture,rootStage:e.heatmapStage,useRadialGradientStyle:y,customRenderingStyle:{},viewportLeft:c,viewportRight:l})}),void 0!==this.stage&&_.a.createElement(Mi,{key:"highlighted",layer:v,filters:S,viewport:p,startIndex:h,endIndex:m,baseTexture:this.baseTexture,rootStage:this.heatmapStage,useRadialGradientStyle:y,customRenderingStyle:{defaultOpacity:1,defaultSize:1},viewportLeft:c,viewportRight:l}),void 0!==this.stage&&_.a.createElement(Pi,{tracks:u,viewport:p,zoom:r,startIndex:h,endIndex:m,highlightTemporalExtentIndexes:i,rootStage:this.stage})))}}]),t}();Li.propTypes={zoom:S.number,heatmapLayers:S.array,temporalExtentIndexes:S.array,highlightTemporalExtentIndexes:S.array,highlightedVessels:S.object,highlightedClickedVessel:S.object,tracks:S.array,queryHeatmapVessels:S.func,exportNativeViewport:S.func,leftWorldScaled:S.number,rightWorldScaled:S.number},Li.contextTypes={viewport:S.object};var xi=it([function(e){return e.map.heatmap.heatmapLayers}],function(e){return Object.keys(e).map(function(t){return Object(h.l)({},e[t])})}),Ci=it([function(e){return e.map.tracks.data}],function(e){return e.filter(function(e){return"geojson"!==e.type}).filter(function(e){return void 0!==e.data})}),Ri=it([li],function(e){var t=e[0].getTime(),r=Math.max(e[1].getTime(),e[0].getTime()+Ue.sb);return[Ue.tb.getOffsetedTimeAtPrecision(t),Ue.tb.getOffsetedTimeAtPrecision(r)]}),ji=it([pi],function(e){if(null==e||!e.length)return null;var t=e[0].getTime(),r=e[1].getTime();return[Ue.tb.getOffsetedTimeAtPrecision(t),Ue.tb.getOffsetedTimeAtPrecision(r)]}),ki=Object(Fe.b)(function(e){return{highlightedVessels:e.map.heatmap.highlightedVessels,highlightedClickedVessel:e.map.heatmap.highlightedClickedVessel,viewport:e.map.viewport.viewport,zoom:e.map.viewport.viewport.zoom,heatmapLayers:xi(e),tracks:Ci(e),leftWorldScaled:e.map.viewport.leftWorldScaled,rightWorldScaled:e.map.viewport.rightWorldScaled,temporalExtentIndexes:Ri(e),highlightTemporalExtentIndexes:ji(e)}},function(e,t){return{queryHeatmapVessels:function(t,r){e(Object(Ue.ub)(t,r))},exportNativeViewport:function(t){e(Object(Ue.vb)(t))}}})(Li);!function(e,t){void 0===t&&(t={});var r=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===r&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}(".map_map__-6udN {\n  bottom: 0;\n  height: 100%;\n  left: 0;\n  position: absolute;\n  right: 0;\n  top: 0;\n  width: 100%;\n  z-index: 5;\n}\n\n.mapboxgl-ctrl-logo {\n  display: none;\n}\n\n/* Popup */\n\n.mapboxgl-popup-content {\n  background: none !important;\n  padding: 0 !important;\n}\n\n.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip,\n.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip,\n.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip {\n  border-top-color: #2b4f93 !important;\n}\n\n.mapboxgl-popup-anchor-top .mapboxgl-popup-tip,\n.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip,\n.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip {\n  border-bottom-color: #2b4f93 !important;\n}\n\n.mapboxgl-popup-anchor-left .mapboxgl-popup-tip {\n  border-right-color: #2b4f93 !important;\n}\n\n.mapboxgl-popup-anchor-right .mapboxgl-popup-tip {\n  border-left-color: #2b4f93 !important;\n}\n\n.mapboxgl-popup-close-button {\n  z-index: 1;\n  right: -18px;\n  top: 2px;\n  background-color: #fff;\n  border-radius: 50%;\n  cursor: pointer;\n  display: inline-block;\n  height: 20px;\n  position: absolute;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  width: 20px;\n  color: #294480;\n  padding-bottom: 2px;\n  line-height: 0;\n  font-size: 16px;\n}\n\n.mapboxgl-popup-close-button:hover {\n  background-color: #fff;\n}\n\n.mapboxgl-popup-close-button:focus {\n  outline: none;\n}\n\n/* override Mapbox GL JS style to always show compact style */\n.mapboxgl-ctrl-attrib {\n  padding-top: 2px !important;\n  padding-bottom: 2px !important;\n  margin: 0 10px 10px 10px !important;\n  position: relative;\n  padding-right: 24px !important;\n  background-color: #fff !important;\n  border-radius: 3px 12px 12px 3px;\n  visibility: hidden;\n  z-index: 999;\n}\n\n.mapboxgl-ctrl-attrib:hover {\n  visibility: visible;\n}\n\n.mapboxgl-ctrl-attrib::after {\n  content: '';\n  cursor: pointer;\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg%20viewBox%3D%270%200%2020%2020%27%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%3E%0D%0A%09%3Cpath%20fill%3D%27%23333333%27%20fill-rule%3D%27evenodd%27%20d%3D%27M4%2C10a6%2C6%200%201%2C0%2012%2C0a6%2C6%200%201%2C0%20-12%2C0%20M9%2C7a1%2C1%200%201%2C0%202%2C0a1%2C1%200%201%2C0%20-2%2C0%20M9%2C10a1%2C1%200%201%2C1%202%2C0l0%2C3a1%2C1%200%201%2C1%20-2%2C0%27%20%2F%3E%0D%0A%3C%2Fsvg%3E');\n  background-color: rgba(255, 255, 255, 0.5);\n  width: 24px;\n  height: 24px;\n  box-sizing: border-box;\n  visibility: visible;\n  border-radius: 12px;\n}\n\n@media screen and (min-width: 768px) {\n  .mapboxgl-ctrl-attrib,\n  .mapboxgl-ctrl-attrib::after {\n    display: none; /* use attribution of the footer */\n  }\n}\n\n.map_googleLogo__foP96 {\n  position: absolute;\n  left: 5px;\n  bottom: 5px;\n  width: 66px;\n  height: 26px;\n  cursor: pointer;\n  background-image: url('https://maps.gstatic.com/mapfiles/api-3/images/google4_hdpi.png');\n  background-size: cover;\n}\n");var Di=function(e){var t=e.latitude,r=e.longitude,n=e.children,a=e.closeButton,i=e.onClose;return _.a.createElement(ze.c,{latitude:t,longitude:r,closeButton:a,onClose:i,anchor:"bottom",offsetTop:-10,tipSize:4,closeOnClick:!1},n)};Di.propTypes={latitude:S.number.isRequired,longitude:S.number.isRequired,children:S.node.isRequired,closeButton:S.bool.isRequired,onClose:S.func},Di.defaultProps={onClose:function(){}};var Ni=function(e){function t(e){var r;return Object(h.d)(this,t),r=Object(h.e)(this,Object(h.f)(t).call(this,e)),Object(h.i)(Object(h.j)(r),"_resize",function(){if(null!==r._mapContainerRef){var e=window.getComputedStyle(r._mapContainerRef),t=parseInt(e.width,10),n=parseInt(e.height,10)+1;t===r.props.viewport.width&&n===r.props.viewport.height||r.props.setViewport(Object(h.l)({},r.props.viewport,{width:t,height:n}))}else console.warn("Cant set viewport on a map that hasnt finished intanciating yet")}),Object(h.i)(Object(h.j)(r),"onViewportChange",function(e){r.props.setViewport(e)}),Object(h.i)(Object(h.j)(r),"onMapInteraction",function(e,t){var n="hover"===t?r.props.mapHover:r.props.mapClick;if(void 0!==r.glMap&&void 0!==e.features&&e.features.length){var a=e.features[0];if(!0===a.properties.cluster){var i=a.properties.cluster_id,o=a.source,s=r.glMap.getSource(o);return void s.getClusterExpansionZoom(i,function(t,r){s.getClusterLeaves(i,99,0,function(a,i){t||a||n(e.lngLat[1],e.lngLat[0],e.features,{zoom:r,children:i})})})}}n(e.lngLat[1],e.lngLat[0],e.features)}),Object(h.i)(Object(h.j)(r),"onHover",function(e){r.onMapInteraction(e,"hover")}),Object(h.i)(Object(h.j)(r),"onClick",function(e){r.onMapInteraction(e,"click")}),Object(h.i)(Object(h.j)(r),"getRef",function(e){null!==e&&(r.glMap=e.getMap())}),Object(h.i)(Object(h.j)(r),"getCursor",function(e){var t=e.isDragging,n=r.props.cursor;return null===n?t?"grabbing":"grab":n}),Object(h.i)(Object(h.j)(r),"transformRequest",function(e,t){var n=r.props.token;if(null!==n&&"Tile"===t&&e.match(Ue.wb))return{url:e,headers:{Authorization:"Bearer "+n}}}),r.state={mouseOver:!0},r._mapContainerRef=null,r}return Object(h.c)(t,e),Object(h.g)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this._resize),this._resize(),window.setTimeout(function(){return e._resize()},1),window.setTimeout(function(){return e._resize()},1e4)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resize)}},{key:"render",value:function(){var e=this,t=this.props,r=t.viewport,n=t.transitions,a=t.maxZoom,i=t.minZoom,o=t.transitionEnd,s=t.mapStyle,u=t.onClosePopup,c=t.clickPopup,l=t.hoverPopup,p=t.markers,f=t.interactiveLayerIds;return _.a.createElement("div",{id:"map",className:"map_map__-6udN",ref:function(t){e._mapContainerRef=t},onMouseLeave:function(){e.setState({mouseOver:!1})},onMouseEnter:function(){e.setState({mouseOver:!0})}},_.a.createElement(ze.d,Object(h.k)({},r,n,{ref:this.getRef,transformRequest:this.transformRequest,onTransitionEnd:o,onHover:this.onHover,onClick:this.onClick,getCursor:this.getCursor,mapStyle:s,maxZoom:a,minZoom:i,onViewportChange:this.onViewportChange,interactiveLayerIds:f}),_.a.createElement(ki,null),null!=c&&_.a.createElement(Di,{latitude:c.latitude,longitude:c.longitude,closeButton:!0,onClose:u},c.content),!0===this.state.mouseOver&&null!=l&&_.a.createElement(Di,{latitude:l.latitude,longitude:l.longitude,closeButton:!1},l.content),null!==p&&p.length&&p.map(function(e,t){return _.a.createElement(ze.b,{key:t,latitude:e.latitude,longitude:e.longitude},e.content)})),_.a.createElement("div",{className:"map_googleLogo__foP96"}))}}]),t}(_.a.Component);Ni.propTypes={token:S.string,transitions:S.object.isRequired,viewport:S.object.isRequired,mapStyle:S.object.isRequired,clickPopup:S.object,hoverPopup:S.object,maxZoom:S.number.isRequired,minZoom:S.number.isRequired,setViewport:S.func.isRequired,mapHover:S.func,mapClick:S.func,onClosePopup:S.func,transitionEnd:S.func,cursor:S.string,markers:S.array,interactiveLayerIds:S.arrayOf(S.string)},Ni.defaultProps={token:null,clickPopup:null,hoverPopup:null,mapHover:function(){},mapClick:function(){},onClosePopup:function(){},transitionEnd:function(){},cursor:null,markers:null,interactiveLayerIds:null};var Fi,Bi=it([function(e){return e.map.style.staticLayers}],function(e){return e.filter(function(e){return!0===e.interactive&&!0===e.visible}).map(function(e){return e.id})}),Ui=it([function(e){return e.map.style.mapStyle},gi],function(e,t){if(!t)return e;var r=e.toJS().layers.filter(function(e){return void 0!==e.metadata}).map(function(e){return e.metadata["mapbox:group"]}).lastIndexOf(Ue.xb)+1,n=e.mergeIn(["sources"],t.sources),a=e.get("layers");return t.layers.forEach(function(e,t){a=a.insert(r+t,si(e))}),n.set("layers",a)}),Vi={},zi={transitionDuration:300,transitionEasing:ci,transitionInterpolator:new Ve.a},Hi=Object(Fe.b)(function(e,t){return{viewport:e.map.viewport.viewport,transitions:!0===t.transitionsEnabled?zi:Vi,maxZoom:e.map.viewport.maxZoom,minZoom:e.map.viewport.minZoom,cursor:e.map.interaction.cursor,token:e.map.module.token,mapStyle:Ui(e),interactiveLayerIds:Bi(e)}},function(e){return{setViewport:function(t){e(Object(Ue.yb)(t))},mapHover:function(t,r,n,a){e(function(e,t,r,n){return function(a,i){var o=i().map,s=o.heatmap.highlightedVessels,u=s.layer,c=s.isEmpty,l=s.foundVessels,p=null,f={type:null};if(!0===c){var d=Ti(r);if(void 0!==d){f.type="static",f.cluster=n,f.layer={id:d.staticLayerId};var _=d.feature.properties;f.target={properties:_},p="pointer";var m=Ii(d.staticLayerId,o,d.feature);if(null!==m){var y=(m.find(function(e){return e.id&&"name"===e.id.toLowerCase()})||m.find(function(e){return e.id&&"id"===e.id.toLowerCase()})||m.find(function(e){return e.id&&null!==_[e.id]&&"null"!==_[e.id]&&void 0!==_[e.id]})).id,g=_[y];f.target.featureTitle=g}}}else if(!0!==c){var b=void 0===l||l.length>1;p=b?"zoom-in":"pointer",f.type="activity",f.layer=u,f.target={objects:l,isCluster:b}}p!==o.interaction.cursor&&a({type:Oi,payload:p}),o.module.onHover&&o.module.onHover(Object(h.l)({},f,{latitude:e,longitude:t}))}}(t,r,n,a))},mapClick:function(t,r,n,a){e(function(e,t,r,n){return function(a,i){var o=i().map;a(Object(Ue.C)());var s=o.heatmap.highlightedVessels,u=s.layer,c=s.isEmpty,l=s.clickableCluster,p=s.foundVessels,f={type:null};if(!0===c){var d=Ti(r);if(void 0!==d){var _,m=Ii(d.staticLayerId,o,d.feature),y=d.feature.properties;null!==m&&(_=m.map(function(e){var t,r=e.id||e,n=r===Ue.bb?(t=d.feature,(Math.pow(10,-6)*Si(t.geometry)).toLocaleString("en-US",{maximumFractionDigits:0})):y[r];return{title:e.label||e.id,isLink:e.isLink,value:n}})),f.type="static",f.cluster=n,f.layer={id:d.staticLayerId},f.target={fields:_,properties:y}}}else f.type="activity",f.layer=u,!0===l?(a(Object(Ue.cb)(e,t)),a(Object(Ue.db)()),f.target={isCluster:!0}):f.target=p[0];o.module.onClick&&o.module.onClick(Object(h.l)({},f,{latitude:e,longitude:t}))}}(t,r,n,a))},transitionEnd:function(){e(Object(Ue.zb)())},onClosePopup:function(){e(Object(Ue.b)())}}})(Ni),Gi=[{gl:"line",geoJSON:["LineString","MultiLineString"]},{gl:"fill",geoJSON:["Polygon","MultiPolygon"]},{gl:"circle",geoJSON:["Point","MultiPoint"]}],qi="INIT_MAP_STYLE",Ki="SET_MAP_STYLE",$i="MARK_CARTO_LAYERS_AS_INSTANCIATED",Yi="SET_STATIC_LAYERS",Wi="SET_BASEMAP_LAYERS",Zi=function(e){return{type:Ki,payload:e}},Xi=function(e,t,r){var n=e.toJS().layers,a=e,i=n.findIndex(function(e){return e.id===t}),o=n.find(function(e){return e.id===t});if(a=function(e,t,r){var n=!0===t.visible?"visible":"none";return e.setIn(["layers",r,"layout","visibility"],n)}(a,r,i),!0===r.isBasemap)return a;var s=Ze.layers.find(function(e){return e.id===t}),u=void 0===r.opacity?1:r.opacity;switch(o.type){case"fill":a=a.setIn(["layers",i,"paint","fill-opacity"],u).setIn(["layers",i,"paint","fill-outline-color"],r.color).setIn(["layers",i,"paint","fill-color"],Ue.e);break;case"line":a=a.setIn(["layers",i,"paint","line-opacity"],u).setIn(["layers",i,"paint","line-color"],r.color);break;case"symbol":if(o.metadata&&!0===o.metadata["gfw:isLabel"]){var c="visible"===a.getIn(["layers",i,"layout","visibility"])&&!0===r.showLabels?"visible":"none";if(a=a.setIn(["layers",i,"layout","visibility"],c),!0!==r.showLabels)break}a=a.setIn(["layers",i,"paint","text-opacity"],u),void 0!==r.color&&(a=a.setIn(["layers",i,"paint","text-color"],r.color));break;case"circle":var l=void 0!==s?s.paint:(r.gl.layers.find(function(e){return e.id===t})||{}).paint;if(a=a.setIn(["layers",i,"paint","circle-opacity"],u).setIn(["layers",i,"paint","circle-stroke-opacity"],u),l&&(l["circle-radius"]&&(a=a.setIn(["layers",i,"paint","circle-radius"],l["circle-radius"])),l["circle-stroke-color"]&&(a=a.setIn(["layers",i,"paint","circle-stroke-color"],l["circle-stroke-color"])),l["circle-stroke-width"]&&(a=a.setIn(["layers",i,"paint","circle-stroke-width"],l["circle-stroke-width"]))),void 0!==r.color){var p=o.metadata["gfw:mainColorPaintProperty"]||"circle-color";a=a.setIn(["layers",i,"paint",p],r.color)}break;case"raster":a=a.setIn(["layers",i,"paint","raster-opacity"],u)}return function(e,t,r,n){var a=e,i=e.toJS(),o=r.type,s=i.metadata["gfw:styles"],u=r.metadata;return["selected","highlighted"].forEach(function(e){var i=t["".concat(e,"Features")],c=null!=i&&i.values.length>0,l=t[e],p=s[e][o]||{},f=u&&u["gfw:styles"]&&u["gfw:styles"][e]||{},d=Object(h.l)({},p,f);Object.keys(d).length&&Object.keys(d).forEach(function(e){var o,s=d[e][0],u=d[e][1],p=["icon-size","icon-image"].includes(e)?"layout":"paint";if(!1===c&&!0!==l&&!1!==l){var f=Ze.layers.find(function(e){return e.id===r.id});o=void 0!==f?r.metadata&&r.metadata["gfw:mainColorPaintProperty"]===e?null:f[p][e]:null}else if(!0===l||!1===l)o=!0===l?s:u;else{var h="";if(null!==t.color&&void 0!==t.color){var _=$e(t.color);h="".concat(_.r,",").concat(_.g,",").concat(_.b)}o=["match",["get",i.field],i.values,"string"!=typeof s?s:s.replace("$REFLAYER_COLOR_RGB",h),"string"!=typeof u?u:u.replace("$REFLAYER_COLOR_RGB",h)]}null!=o&&(a=a.setIn(["layers",n,p,e],o))})}),a}(a,r,o,i)},Ji=function(e,t){return function(r,n){r({type:Yi,payload:e}),r({type:Wi,payload:t});var a=[].concat(Object(h.m)(e),Object(h.m)(t.map(function(e){return Object(h.l)({},e,{isBasemap:!0})}))),i=n().map.style.mapStyle.toJS().sources,o=a.filter(function(e){return void 0!==e.gl});o.length&&r(function(e){return function(t,r){var n=r().map.style.mapStyle;e.forEach(function(e){var t=e.id,r=e.gl,a=si(r.source);n=n.setIn(["sources",t],a);var i=[],o=n.get("layers").toJS().map(function(e){return e.id});r.layers.filter(function(e){return!o.includes(e.id)}).forEach(function(e){var r=Object(h.l)({},e,{source:t},"vector"===e.type&&{"source-layer":t});i.push(r)});var s=si(i);n=n.set("layers",n.get("layers").concat(s))}),t(Zi(n))}}(o));var s=a.filter(function(e){return!0===e.isCustom&&void 0===i[e.id]});s.length&&s.forEach(function(e){r(function(e,t,r,n){return function(a,i){var o=i().map.style.mapStyle,s=o.toJS();if(void 0===s.sources[t]){var u={type:e};e===Ue.c.geojson?u.data=n:e===Ue.c.raster&&(u.tiles=[r],u.tileSize=256),o=o.setIn(["sources",t],si(u))}if(void 0===s.layers.find(function(e){return e.id===t})){var c=e===Ue.c.geojson?function(e){var t=e.features.map(function(e){var t=e.geometry;return void 0===t?null:t.type}),r=Gi.map(function(e){var r=0;return t.forEach(function(t){e.geoJSON.indexOf(t)>-1&&r++}),{gl:e.gl,num:r}}),n="fill",a=0;return r.forEach(function(e){e.num>a&&(n=e.gl,a=e.num)}),n}(n):e,l=si({id:t,source:t,type:c,layout:{},paint:{}}),p=e===Ue.c.raster?s.layers.length-1-s.layers.filter(function(e){return"labels"!==e.id}).reverse().findIndex(function(e){return"raster"===e.type}):s.layers.length-1;o=o.set("layers",o.get("layers").splice(p,0,l))}a(Zi(o))}}(e.subtype,e.id,e.url,e.data))});var u=n().map.style,c=u.mapStyle,l=c.toJS(),p=l.layers,f=l.sources,d=[];e.forEach(function(e){var t=e.id;if(void 0!==i[t]&&(void 0!==e.data&&(c=c.setIn(["sources",t,"data"],si(e.data))),void 0!==e.url)){var r=i[t].tiles,n=void 0!==r&&r.length>0?Object(Ue.ib)([e.url].concat(Object(h.m)(r))):[e.url];c=c.setIn(["sources",t,"tiles"],si(n))}});for(var _=function(e){var t=p[e],r=t.source,n=f[r],i=void 0!==t.metadata&&t.metadata["gfw:id"]||r,o=a.find(function(e){return e.id===i});if(void 0===o)return t.type,"continue";var s=void 0!==n.metadata&&n.metadata["gfw:carto-sql"];if(!1!==s&&void 0!==s){var l=u.cartoLayersInstanciated.indexOf(r)>-1;return!0!==o.visible||l||d.find(function(e){return e.sourceId===r})||d.push({sourceId:r,sourceCartoSQL:s,refLayer:o}),"continue"}c=Xi(c,t.id,o)},m=0;m<p.length;m++)_(m);d.length&&r(function(e){return function(t,r){t({type:$i,payload:e.map(function(e){return e.sourceId})});var n=e.map(function(e){return r=(t=e).sourceId,n=t.sourceCartoSQL,a={layers:[{id:r,options:{sql:n}}]},i=encodeURIComponent(JSON.stringify(a)),o=Ue.f.replace("$MAPCONFIG",i),new Promise(function(e){fetch(o).then(function(e){return e.status>=400?(console.warn("loading of layer failed ".concat(r)),Promise.reject(),null):e.json()}).then(function(t){e({layergroupid:t.layergroupid,sourceId:r})}).catch(function(e){console.warn(e)})});var t,r,n,a,i,o});Promise.all(n.map(function(e){return e.catch(function(e){return e})})).then(function(n){var a=r().map.style.mapStyle,i=a.toJS();n.forEach(function(t){var r=Ue.d.replace("$LAYERGROUPID",t.layergroupid),n="".concat(t.sourceId,"-instanciated");a=a.setIn(["sources",n],si({type:"vector",tiles:[r]})),i.layers.forEach(function(r,i){if(r.source===t.sourceId){a=(a=a.setIn(["layers",i,"source"],n)).setIn(["layers",i,"metadata","gfw:id"],t.sourceId);var o=e.find(function(e){return e.refLayer.id===t.sourceId}).refLayer;a=Xi(a,r.id,o)}})}),t(Zi(a))}).catch(function(e){console.warn(e)})}}(d)),r(Zi(c))}},Qi=Object(h.b)(Object(h.a)(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=[1/0,1/0,-1/0,-1/0];return vi.coordEach(e,function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])}),t}})),eo="ADD_TRACK",to="UPDATE_TRACK",ro=function(e){var t=Qi(e);return{minLat:t[3],minLng:t[0],maxLat:t[1],maxLng:t[2]}},no=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return function(t,r){var n=r().map.tracks.data;e&&e.forEach(function(e){var r,a=e.id,i=n.find(function(e){return e.id===a});void 0===i?t((r=e,function(e,t){var n=r.id,a=r.url,i=r.type,o=r.fitBoundsOnLoad,s=r.layerTemporalExtents,u=r.color,c=r.data,l=t();if(!l.map.tracks.data.find(function(e){return e.id===n})){var p={id:n,url:a,type:i,color:u,fitBoundsOnLoad:o},f=void 0!==r.data&&null!==r.data,d=null!=a&&""!==a;if(f&&(p.data=c,p.geoBounds=ro(c)),e({type:eo,payload:p}),!f&&d){var _=Object(Ue.g)(e,l);if("geojson"!==i){var m=l.map.module.token,y=Object(Ue.h)(a,m,s,{seriesgroup:n});Promise.all(y.map(function(e){return e.catch(function(e){return e})})).then(function(t){var r=Object(Ue.i)(t);if(r.length){var a=Object(Ue.j)(r,["latitude","longitude","datetime","series","weight","sigma"]),i=Object(Ue.k)(a),o=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r={start:1/0,end:0},n={minLat:1/0,maxLat:-1/0,minLng:1/0,maxLng:-1/0},a=0,i=e.datetime.length;a<i;a++){var o=e.datetime[a];o<r.start?r.start=o:o>r.end&&(r.end=o);var s=e.latitude[a];s<n.minLat?n.minLat=s:s>n.maxLat&&(n.maxLat=s);var u=e.longitude[a];!0===t&&u<0&&(u+=360),u<n.minLng?n.minLng=u:u>n.maxLng&&(n.maxLng=u)}return n.maxLng-n.minLng>350&&!1===t?Object(h.i)(e,!0):{time:[r.start,r.end],geo:n}}(a);e({type:to,payload:{id:n,data:Object(Ue.l)(i),geoBounds:o.geo,timelineBounds:o.time}}),e(Object(Ue.m)(_))}})}else fetch(a).then(function(e){if(e.status>=400)throw new Error(e.statusText);return e.json()}).then(function(t){var r=function(e){var t={start:1/0,end:0};return e&&e.features&&e.features.forEach(function(e){e.properties.coordinateProperties.times&&e.properties.coordinateProperties.times.length>0&&e.properties.coordinateProperties.times.forEach(function(e){e<t.start?t.start=e:e>t.end&&(t.end=e)})}),{geojson:e,timelineBounds:[t.start,t.end]}}(t),a=r.geojson,i=r.timelineBounds,s=ro(t);e({type:to,payload:{id:n,data:a,geoBounds:s,timelineBounds:i}}),o&&Object(Ue.n)(n)}).catch(function(e){return console.warn(e)}).finally(function(){return e(Object(Ue.m)(_))})}}})):i.color!==e.color&&t({type:to,payload:{id:e.id,color:e.color}})}),n.forEach(function(r){e&&e.find(function(e){return e.id===r.id})||t({type:"REMOVE_TRACK",payload:{trackId:r.id}})})}},ao={loaders:null,token:void 0,temporalExtent:[new Date(1970),new Date],highlightTemporalExtent:null,onViewportChange:void 0,onHover:void 0,onClick:void 0,onLoadStart:void 0,onLoadComplete:void 0,onClosePopup:void 0,onAttributionsChange:void 0},io=(S.arrayOf(S.number),S.string,S.arrayOf(S.instanceOf(Date)),S.func,S.func,S.func,S.func,S.func,S.func,S.func,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ao,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ue.o:return Object(h.l)({},e,t.payload);case Ue.p:return Object(h.l)({},e,{temporalExtent:t.payload});case Ue.q:return Object(h.l)({},e,{highlightTemporalExtent:t.payload});case Ue.r:var r=null!==e.loaders?Object(h.m)(e.loaders):[];return r.push(t.payload),Object(h.l)({},e,{loaders:r});case Ue.s:var n=Object(h.m)(e.loaders),a=n.findIndex(function(e){return e===t.payload});return n.splice(a,1),Object(h.l)({},e,{loaders:n});default:return e}}),oo={data:[]},so=(S.arrayOf(S.exact(Object(h.l)({},Je,{data:S.object,timelineBounds:S.array,geoBounds:S.exact({minLat:S.number,minLng:S.number,maxLat:S.number,maxLng:S.number})}))),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oo,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case eo:var r=[].concat(Object(h.m)(e.data),[t.payload]);return Object(h.l)({},e,{data:r});case to:var n=t.payload,a=e.data.map(function(e){return e.id!==n.id?e:Object(h.l)({},e,n)});return Object(h.l)({},e,{data:a});case"REMOVE_TRACK":var i=t.payload.trackId,o=e.data.filter(function(e){return e.id!==i});return Object(h.l)({},e,{data:o});default:return e}}),uo={heatmapLayers:{},referenceTiles:[],highlightedVessels:{isEmpty:!0},highlightedClickedVessel:null},co={currentVisibleTiles:[],currentLoadedTiles:[],currentToLoadTileUids:[],currentToReleaseTileUids:[]},lo={transitionDuration:500,transitionInterpolator:new Xe.a,transitionEasing:ci},po={viewport:{latitude:0,longitude:0,zoom:3,bearing:0,pitch:0,width:1e3,height:800},maxZoom:Ue.R,minZoom:Ue.S,prevZoom:3,currentTransition:null},fo=Object(Ue.ib)(Object.keys(Ze.sources).map(function(e){return Ze.sources[e].attribution}).filter(function(e){return void 0!==e})),ho={mapStyle:si((Fi=Ze,Fi.layers.forEach(function(e){if(void 0===e.layout&&(e.layout={}),void 0===e.paint&&(e.paint={}),e.metadata&&!0===e.metadata["gfw:temporal"]){var t=void 0===e.metadata["gfw:temporalField"]?"timestamp":e.metadata["gfw:temporalField"];e.filter=["all",[">",t,0],["<",t,999999999999]]}"visible"!==e.layout.visibility&&(e.layout.visibility="none")}),Fi)),cartoLayersInstanciated:[],staticLayers:[],basemapLayers:[],attributions:fo},_o={cursor:"progress"},mo=Object(Be.c)({module:io,tracks:so,heatmap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:uo,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ue.t:return Object.assign({},e,{heatmapLayers:t.payload});case Ue.u:var r=e.heatmapLayers,n=r[t.payload.layerId].visibleTemporalExtentsIndices;return n=Object(Ue.ib)(n.concat(t.payload.indicesAdded)),r[t.payload.layerId].visibleTemporalExtentsIndices=n,Object.assign({},e,r);case Ue.v:var a=Object.assign({},e.heatmapLayers,Object(h.i)({},t.payload.id,Object(h.l)({tiles:[]},t.payload)));return Object.assign({},e,{heatmapLayers:a});case Ue.w:var i=t.payload,o=Object(h.l)({},e.heatmapLayers[i.id],i),s=Object(h.l)({},e.heatmapLayers,Object(h.i)({},i.id,o));return Object(h.l)({},e,{heatmapLayers:s});case Ue.x:var u=Object.assign({},e.heatmapLayers);return delete u[t.payload.layerId],Object.assign({},e,{heatmapLayers:u});case Ue.y:return Object.assign({},e,{referenceTiles:[].concat(Object(h.m)(e.referenceTiles),[t.payload])});case Ue.z:var c=t.payload.layerId,l=t.payload.tile,p=Object(h.l)({},e.heatmapLayers[c]),f=Object(h.m)(p.tiles),d=f.findIndex(function(e){return e.uid===l.uid});-1===d?f.push(l):f=[f.slice(0,d),l,f.slice(d+1)],p.tiles=f;var _=Object(h.l)({},e.heatmapLayers,Object(h.i)({},c,p));return Object(h.l)({},e,{heatmapLayers:_});case Ue.A:var m=t.payload,y=Object.keys(e.heatmapLayers),g=Object(h.l)({},e.heatmapLayers);y.forEach(function(e){var t=Object(h.l)({},g[e]);m.forEach(function(e){var r=t.tiles.findIndex(function(t){return t.uid===e});r>-1&&t.tiles.splice(r,1)})});var b=Object(h.m)(e.referenceTiles);return m.forEach(function(e){var t=b.findIndex(function(t){return t.uid===e});t>-1&&(b=[].concat(Object(h.m)(b.slice(0,t)),Object(h.m)(b.slice(t+1))))}),Object(h.l)({},e,{heatmapLayers:g,referenceTiles:b});case Ue.B:var v=Object(h.l)({},e.heatmapLayers);return Object(h.l)({},e,{heatmapLayers:v});case Ue.a:return Object.assign({},e,{highlightedVessels:t.payload});case Ue.D:return Object(h.l)({},e,{highlightedClickedVessel:t.payload});case Ue.E:return Object(h.l)({},e,{highlightedClickedVessel:null});default:return e}},heatmapTiles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:co,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ue.F:var r=[].concat(t.payload);return Object(h.l)({},e,{currentVisibleTiles:r});case Ue.G:var n=[].concat(t.payload);return Object(h.l)({},e,{currentLoadedTiles:n});case Ue.H:var a=Object(Ue.ib)(e.currentToLoadTileUids.concat(t.payload.tilesToLoadUids)),i=Object(Ue.ib)(e.currentToReleaseTileUids.concat(t.payload.tilesToReleaseUids)),o=a.filter(function(e){return-1===i.indexOf(e)});return Object(h.l)({},e,{currentToLoadTileUids:o,currentToReleaseTileUids:i});case Ue.I:var s=e.currentToLoadTileUids,u=t.payload,c=s.filter(function(e){return-1===u.indexOf(e)});return Object(h.l)({},e,{currentToLoadTileUids:c});case Ue.J:return Object(h.l)({},e,{currentToReleaseTileUids:[]});default:return e}},style:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ho,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case qi:var r=e.mapStyle.setIn(["glyphs"],t.payload.glyphsPath);return Object(h.l)({},e,{mapStyle:r});case Ki:return Object(h.l)({},e,{mapStyle:t.payload});case Yi:return Object(h.l)({},e,{staticLayers:t.payload});case Wi:return Object(h.l)({},e,{basemapLayers:t.payload});case $i:var n=[].concat(Object(h.m)(e.cartoLayersInstanciated),Object(h.m)(t.payload));return Object(h.l)({},e,{cartoLayersInstanciated:n});default:return e}},viewport:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:po,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ue.K:return Object(h.l)({},e,{viewport:t.payload,canZoomIn:t.payload.zoom<e.maxZoom,canZoomOut:t.payload.zoom>e.minZoom,prevZoom:e.viewport.zoom});case Ue.L:var r=Object(h.l)({},e.viewport,t.payload);return Object(h.l)({},e,{viewport:r,prevZoom:r.zoom});case Ue.M:var n=e.viewport.zoom,a=Math.min(e.maxZoom,t.payload.zoom||n+t.payload.increment),i=Object(h.l)({},e.viewport,lo,{zoom:a,latitude:null===t.payload.latitude?e.viewport.latitude:t.payload.latitude,longitude:null===t.payload.longitude?e.viewport.longitude:t.payload.longitude});return Object(h.l)({},e,{viewport:i,canZoomIn:a<e.maxZoom,canZoomOut:a>e.minZoom,prevZoom:e.viewport.zoom,currentTransition:Ue.N.ZOOM});case Ue.O:return Object(h.l)({},e,{mouseLatLong:t.payload});case Ue.P:return Object(h.l)({},e,{currentTransition:null});case Ue.Q:return Object(h.l)({},e,t.payload);default:return e}},interaction:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_o,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Oi:return Object(h.l)({},e,{cursor:t.payload});default:return e}}}),yo=Object(Be.c)({map:mo});Ue.T.replaceReducer(yo);var go=function(e,t,r){var n=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return Object(Ne.b)(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),Object(Ne.a)(e,t,{leading:n,maxWait:t,trailing:a})}(function(e){Ue.T.dispatch(function(e){return function(t,r){for(var n=r().map.style.mapStyle,a=n.toJS().layers,i=Math.round(e[0].getTime()/1e3),o=Math.round(e[1].getTime()/1e3),s=Ue.tb.getOffsetedTimeAtPrecision(e[0].getTime()),u=Ue.tb.getOffsetedTimeAtPrecision(e[1].getTime()),c=0;c<a.length;c++){var l=a[c];if(void 0!==l.metadata&&!0===l.metadata["gfw:temporal"]){var p=n.getIn(["layers",c,"filter"]).toJS();if(null===p)throw new Error("filter must be preset on style.json for temporal layer: ",l.id);var f=l.metadata&&"timeIndex"===l.metadata["gfw:temporalField"];p[1][2]=f?s:i,p[2][2]=f?u:o,n=n.setIn(["layers",c,"filter"],si(p))}}t(Zi(n))}}(e)),Ue.T.dispatch(Object(Ue.U)(e))},16),bo=function(e){Ue.T.dispatch(Object(Ue.ab)({latitude:e.center[0],longitude:e.center[1],zoom:e.zoom}))},vo=function(e){function t(){var e,r;Object(h.d)(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=Object(h.e)(this,(e=Object(h.f)(t)).call.apply(e,[this].concat(a))),Object(h.i)(Object(h.j)(r),"state",{initialized:!1,error:null,errorInfo:null}),r}return Object(h.c)(t,e),Object(h.g)(t,[{key:"componentDidCatch",value:function(e,t){console.log(e,t),this.setState({error:e,errorInfo:t})}},{key:"componentDidMount",value:function(){var e;void 0!==this.props.viewport&&bo(this.props.viewport),null!==this.props.glyphsPath&&Ue.T.dispatch((e={glyphsPath:this.props.glyphsPath},{type:qi,payload:{glyphsPath:e.glyphsPath}})),void 0!==this.props.onAttributionsChange&&this.props.onAttributionsChange(Ue.T.getState().map.style.attributions),Ue.T&&void 0===Ue.T.getState().map.module.token&&Ue.T.dispatch(Object(Ue.V)({token:this.props.token,onViewportChange:this.props.onViewportChange,onHover:this.props.onHover,onClick:this.props.onClick,onLoadStart:this.props.onLoadStart,onLoadComplete:this.props.onLoadComplete,onClosePopup:this.props.onClosePopup,onAttributionsChange:this.props.onAttributionsChange})),null!==this.props.highlightTemporalExtent&&this.props.highlightTemporalExtent.length&&Ue.T.dispatch(Object(Ue.W)(this.props.highlightTemporalExtent)),(null!==this.props.basemapLayers&&this.props.basemapLayers.length||null!==this.props.staticLayers&&this.props.staticLayers.length)&&Ue.T.dispatch(Ji(this.props.staticLayers||[],this.props.basemapLayers||[])),null!==this.props.tracks&&Ue.T.dispatch(no(this.props.tracks)),null!==this.props.temporalExtent&&this.props.temporalExtent.length&&go(this.props.temporalExtent),this.setState({initialized:!0}),null!==this.props.heatmapLayers&&Ue.T.dispatch(Object(Ue.X)(this.props.heatmapLayers,this.props.loadTemporalExtent))}},{key:"componentDidUpdate",value:function(e){this.props.tracks!==e.tracks&&Ue.T.dispatch(no(this.props.tracks)),this.props.heatmapLayers!==e.heatmapLayers&&Ue.T.dispatch(Object(Ue.X)(this.props.heatmapLayers,this.props.loadTemporalExtent)),(null!==this.props.basemapLayers&&this.props.basemapLayers.length||null!==this.props.staticLayers&&this.props.staticLayers.length)&&Ue.T.dispatch(Ji(this.props.staticLayers||[],this.props.basemapLayers||[])),null!==this.props.loadTemporalExtent&&this.props.loadTemporalExtent.length&&(null!==e.loadTemporalExtent&&e.loadTemporalExtent.length&&this.props.loadTemporalExtent[0].getTime()===e.loadTemporalExtent[0].getTime()&&this.props.loadTemporalExtent[1].getTime()===e.loadTemporalExtent[1].getTime()||Ue.T.dispatch(Object(Ue.Y)(this.props.loadTemporalExtent))),null!==this.props.temporalExtent&&this.props.temporalExtent.length&&(null!==e.temporalExtent&&e.temporalExtent.length&&this.props.temporalExtent[0].getTime()===e.temporalExtent[0].getTime()&&this.props.temporalExtent[1].getTime()===e.temporalExtent[1].getTime()||go(this.props.temporalExtent)),null!==this.props.highlightTemporalExtent&&this.props.highlightTemporalExtent.length?null!==e.highlightTemporalExtent&&e.highlightTemporalExtent.length&&this.props.highlightTemporalExtent[0].getTime()===e.highlightTemporalExtent[0].getTime()&&this.props.highlightTemporalExtent[1].getTime()===e.highlightTemporalExtent[1].getTime()||Ue.T.dispatch(Object(Ue.W)(this.props.highlightTemporalExtent)):this.props.highlightTemporalExtent!==e.highlightTemporalExtent&&Ue.T.dispatch(Object(Ue.W)(this.props.highlightTemporalExtent));var t=Ue.T.getState().map.viewport.viewport;void 0!==this.props.viewport&&null===Ue.T.getState().map.viewport.currentTransition&&(t.latitude===this.props.viewport.center[0]&&t.longitude===this.props.viewport.center[1]&&t.zoom===this.props.viewport.zoom||(1===Math.abs(t.zoom-this.props.viewport.zoom)?Ue.T.dispatch(Object(Ue.Z)(this.props.viewport.zoom)):bo(this.props.viewport)))}},{key:"render",value:function(){return null!==this.state.error?(console.log(this.state.error),_.a.createElement("div",null,_.a.createElement("h2",null,"Map component crashed!"),_.a.createElement("p",{className:"red"},this.state.error&&this.state.error.toString()),_.a.createElement("div",null,"Component Stack Error Details:"),_.a.createElement("p",{className:"red"},this.state.errorInfo.componentStack))):!0!==this.state.initialized?null:_.a.createElement(Fe.a,{store:Ue.T},_.a.createElement(Hi,this.props))}}]),t}(_.a.Component);vo.propTypes={token:S.string,transitionsEnabled:S.bool,viewport:S.shape(nt).isRequired,tracks:S.arrayOf(S.exact(Je)),heatmapLayers:S.arrayOf(S.shape(Qe)),temporalExtent:S.arrayOf(S.instanceOf(Date)),highlightTemporalExtent:S.arrayOf(S.instanceOf(Date)),loadTemporalExtent:S.arrayOf(S.instanceOf(Date)),basemapLayers:S.arrayOf(S.shape(et)),staticLayers:S.arrayOf(S.shape(tt)),hoverPopup:S.shape(rt),clickPopup:S.shape(rt),glyphsPath:S.string,onViewportChange:S.func,onLoadStart:S.func,onLoadComplete:S.func,onClick:S.func,onHover:S.func,onAttributionsChange:S.func,onClosePopup:S.func},vo.defaultProps={token:null,transitionsEnabled:!1,glyphsPath:null,highlightTemporalExtent:null,tracks:null,hoverPopup:null,clickPopup:null,heatmapLayers:null,temporalExtent:null,loadTemporalExtent:null,basemapLayers:null,staticLayers:null,onViewportChange:function(){},onLoadStart:function(){},onLoadComplete:function(){},onClick:function(){},onHover:function(){},onAttributionsChange:function(){},onClosePopup:function(){}};Ze.metadata["gfw:basemap-layers"];var So=r(54),Oo=r(126),Io=r(127),Eo=r(217),To=r(76),wo=r(125),Ao=r.n(wo),Mo={id:"Track example",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{id:"4801222-2017-09-05T04:50:00.000000Z",type:"track",coordinateProperties:{times:[15107889e5,15107925e5,15107961e5,15107997e5,15108033e5,15108069e5,15108105e5,15108141e5,15108177e5,15108213e5,15108249e5,15108285e5,15108321e5,151083588e4,151083948e4,15108429e5,15108465e5,15108537e5,15108573e5,15108645e5,15108681e5,15108717e5,15108753e5,15108789e5,15108825e5,15108861e5,15108897e5,15108933e5,15108969e5,15109005e5,15109041e5,15109077e5,15109113e5,15109149e5,15109185e5,15109221e5,15109257e5,15109293e5,15109329e5,15109365e5,15109509e5,15109545e5,15109581e5,15109617e5,15109653e5,15109689e5,15109725e5,15109761e5,15109797e5,15109869e5,15109905e5,15109977e5,15110013e5,15110085e5,15110121e5,15110193e5,15110265e5,15110301e5,15110337e5,15110373e5,15110409e5,15110445e5,15110517e5,15110553e5,15110589e5,15110661e5,15110697e5,15110733e5,15110769e5,15110985e5,15111129e5,15111165e5,15111201e5,15111273e5,15111309e5,15111345e5,15111381e5,15111417e5,15111633e5,15111669e5,15111705e5,15111741e5,15111777e5,15111885e5,15111921e5,15111957e5,151119936e4,15112029e5,151120662e4,15112101e5,15112137e5,15112209e5,15112245e5,15112281e5,15112353e5,15112389e5,15112497e5,15112533e5,15112569e5,15112641e5,15112857e5,15112965e5,15113001e5,15113037e5,15113073e5,151131096e4,15113145e5,15113181e5,151132176e4,15113253e5,15113289e5,15113325e5,15113361e5,15113397e5,15113469e5,15113505e5,15113541e5,15113577e5,15113613e5,15113649e5,15113685e5,15113721e5,15113757e5,15113793e5,15113829e5,15113865e5,151139016e4,15113937e5,15113973e5,151140114e4,151140822e4,151141182e4,15114405e5,15114441e5,15114477e5,15114549e5,15114621e5,15114657e5,15114693e5,15114729e5,15114765e5,15114801e5,15114837e5,15114873e5,151149132e4,15114945e5,151149816e4,15115053e5,15115089e5,15115125e5,15115197e5,15115233e5,15115305e5,15115341e5,15115449e5,15115488e5,15115521e5,15115557e5,15115593e5,151156296e4,151156656e4,15115701e5,151157376e4,15115773e5,15115809e5,151158456e4,15115881e5,15115953e5,15115989e5,15116025e5,15116061e5,151160982e4,15116133e5,15116169e5,15116385e5,15116421e5,15116457e5,15116493e5,151165296e4,151166016e4,15116637e5,15116673e5,151167096e4,15116745e5,151168188e4,15116853e5,15116889e5,151169256e4,15116997e5,15117033e5,151171056e4,151171416e4,15117249e5,15117285e5,151173216e4,15117357e5,15117393e5,15117429e5,15117465e5,15117501e5,15117537e5,15117573e5,15117645e5,15117681e5,15117717e5,15117753e5,15117789e5,15117825e5,15117861e5,15117897e5,15117933e5,15117969e5,15118005e5,151180416e4,15118077e5,15118113e5,15118149e5,15118257e5,151182936e4,15118329e5,15118365e5,15118437e5,15118545e5,151192296e4,15119301e5,15119481e5,15119517e5,15119805e5,151200216e4,15120309e5,15120705e5,15122073e5,15122325e5,15123189e5]}},geometry:{type:"LineString",coordinates:[[105.0281,1.7433],[104.8892,1.6431],[104.9594,1.6919],[105.0181,1.6211],[104.8811,1.5453],[104.8206,1.5914],[104.7547,1.5392],[104.7425,1.4717],[104.6894,1.4953],[104.6903,1.6167],[104.7017,1.6811],[104.7464,1.7656],[104.7258,1.7067],[104.6569,1.5958],[104.6492,1.5328],[104.605,1.5156],[104.6275,1.4519],[104.6119,1.3822],[104.5322,1.395],[104.5433,1.3425],[104.4961,1.3519],[104.5036,1.355],[104.5617,1.4044],[104.5542,1.4344],[104.4267,1.2914],[104.4711,1.2975],[104.4469,1.2831],[104.3878,1.2517],[104.3978,1.27],[104.3078,1.2611],[104.3442,1.2631],[104.3469,1.2375],[104.2994,1.2047],[104.4769,1.3211],[105.0969,1.7925],[105.1642,1.84],[105.3119,1.7894],[105.3806,1.8342],[105.2286,1.885],[105.2844,1.9331],[105.4058,2.0194],[105.0342,2.3183],[105.52,2.0875],[105.5828,2.1092],[105.72,2.1736],[105.6489,2.1372],[105.7631,2.0536],[105.7717,2.0422],[105.7533,2.0606],[105.7567,2.0614],[105.7561,2.0639],[105.7536,2.0639],[105.7536,2.0642],[105.7536,2.0644],[105.7533,2.0642],[105.6967,2.0361],[105.465,2.0558],[105.5342,1.9308],[105.4553,1.8817],[105.785,2.03],[105.7972,2.0967],[105.7856,2.2158],[105.8472,2.2539],[105.9006,2.3028],[105.9569,2.3442],[105.9239,2.2164],[106.1089,2.3258],[106.1092,2.3256],[106.1094,2.3256],[106.1056,2.3253],[106.1064,2.3258],[106.1058,2.3256],[106.1053,2.3256],[106.0922,2.3364],[106.1028,2.3264],[106.1044,2.3275],[106.1069,2.3261],[106.1081,2.3261],[106.1372,2.2881],[106.1883,2.2125],[106.3217,2.3197],[106.2575,2.2636],[106.54,2.4636],[106.6519,2.6169],[106.5769,2.56],[106.6081,2.6453],[106.7097,2.6997],[106.6356,2.7361],[106.5753,2.7875],[106.6792,2.9244],[106.7022,2.8808],[106.6425,2.8303],[106.6583,2.83],[106.8125,2.8786],[106.8131,2.8783],[106.8119,2.8786],[106.8117,2.8786],[106.8114,2.8786],[106.8119,2.8756],[106.8078,2.8789],[106.8086,2.8797],[106.8103,2.8825],[106.8108,2.8811],[106.8111,2.8794],[106.7656,2.9239],[106.8317,2.9219],[106.8308,2.9597],[106.7667,2.7844],[107.3692,3.5672],[107.3244,3.5022],[107.2778,3.4425],[107.1842,3.3256],[107.2308,3.3817],[107.1308,3.2642],[106.9425,3.0289],[106.9903,3.0736],[107.0281,3.1436],[107.0769,3.2058],[106.8594,3.2361],[106.8661,3.1578],[106.8581,3.0789],[106.8917,2.9967],[106.8494,2.9997],[106.7164,3.1144],[106.7011,3.0208],[106.7525,3.2983],[106.8167,3.3081],[106.7758,3.3925],[106.7675,3.3792],[106.7969,3.4928],[106.8931,3.5794],[106.8206,3.5569],[106.7506,3.5419],[106.6431,3.5764],[106.6756,3.5269],[106.6767,3.5289],[106.7206,3.4508],[106.6056,3.5108],[106.5858,3.5522],[106.6136,3.5872],[106.5492,3.5572],[106.5608,3.6542],[106.56,3.6539],[106.5603,3.6539],[106.5606,3.6536],[106.5608,3.6536],[106.5592,3.6539],[106.5594,3.6539],[106.5597,3.6539],[106.6997,3.6044],[106.545,3.6753],[106.8653,3.8817],[106.8528,3.7989],[106.8247,3.7247],[106.8147,3.6486],[106.7619,3.63],[106.8169,3.5903],[106.8303,3.6389],[106.8283,3.6411],[106.8283,3.6397],[106.8283,3.64],[106.8283,3.6403],[106.8283,3.6406],[106.8283,3.6394],[106.8183,3.6522],[106.8436,3.6436],[106.86,3.6517],[106.9003,3.655],[106.9686,3.5997],[106.9633,3.6939],[107.0267,3.7303],[107.0406,3.6206],[107.1181,3.6381],[107.2706,3.6731],[107.1578,3.8114],[107.0917,3.7697],[107.2872,4.1833],[106.7494,4.0875],[106.8483,3.9567],[106.7994,4.0231],[106.7089,4.1383],[106.7144,4.1364],[106.6881,4.1647],[106.5936,4.3025],[106.6403,4.2389],[106.8983,4.3794],[106.8264,4.4158],[106.7561,4.4506],[106.6439,4.4856],[106.6442,4.4853],[106.6444,4.4853],[106.6442,4.4847],[106.6433,4.4831],[106.6436,4.4856],[106.6456,4.4878],[106.5797,4.4697],[107.0511,4.3025],[106.9736,4.3422],[107.1289,4.2614],[107.2069,4.2228],[107.5581,4.2131],[107.6603,4.2672],[107.6036,4.3083],[107.6083,4.3011],[107.6214,4.2994],[107.6128,4.2914],[107.6175,4.2894],[107.6175,4.2892],[107.6172,4.2897],[107.6172,4.29],[107.6175,4.2897],[107.6169,4.29],[107.6167,4.29],[107.6164,4.2903],[107.6172,4.2881],[107.6175,4.2881],[107.6175,4.2886],[107.6192,4.2875],[107.6133,4.2831],[107.6075,4.2783],[107.6078,4.2783],[107.6086,4.2789],[107.6094,4.2794],[107.6094,4.2789],[107.6089,4.2778],[107.6083,4.2772],[107.6086,4.2758],[107.6083,4.2761],[107.6083,4.2764],[107.6083,4.2767],[107.6083,4.2769],[107.6078,4.2767],[107.6075,4.2781],[107.6086,4.2756]]}}]},color:"#FE81EB",type:"geojson",fitBoundsOnLoad:!0},Po=[Mo],Lo=function(e,t){var r=e.data.features[0].properties.coordinateProperties;return r?r.times.findIndex(function(e){return e===t}):-1},xo=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=e.data.features[0].geometry.coordinates,a=Lo(e,t);return n[a+r]?n[a+r]:n[a]},Co=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=Object(To.bearingToAzimuth)(Object(So.a)(Object(To.point)(e),Object(To.point)(t)));return r?Math.round(n):n},Ro=function(e,t,r){var a=Object(n.useMemo)(function(){return xo(e,t)},[t,e]),i=Object(n.useMemo)(function(){return xo(e,t,1)},[t,e]),o=Object(n.useMemo)(function(){return function(e,t,r){var n=Lo(e,t),a=e.data.features[0].geometry.coordinates,i=a[n],o=a[n+1],s=Object(Oo.a)(a[0],i,e.data.features[0]),u=Object(Io.a)(s),c=Object(Oo.a)(i,o,e.data.features[0]);return u+Object(Io.a)(c)*r/100}(e,t,r)},[e,r,t]),s=Co(a,i),u=Object(n.useState)({center:a,bearing:s,currentDistance:o}),c=Object(f.a)(u,2),l=c[0],p=c[1];return Object(n.useEffect)(function(){window.requestAnimationFrame(function(){var t=l.currentDistance<o;if(l.currentDistance!==o){var r=function(e,t,r){var n=r-t,a=Math.abs(n)>.1?n/2:n,i=t+(n<0?t+n>=r?a:r-t:t+n<=r?a:r-t),o=Object(Eo.a)(e.data.features[0],i),s=o&&o.geometry&&o.geometry.coordinates||null;return{center:null!==s?s:null,nextDistance:i}}(e,l.currentDistance,o),n=r.center,a=r.nextDistance;null!==n&&p(function(e){var r=Co(e.center,n,!0);return{center:n,bearing:t?r:r-180,currentDistance:a}})}else p(function(e){var t=Co(e.center,i);return{center:e.center,bearing:t,currentDistance:e.currentDistance}})})},[o,i,l.currentDistance,t,e]),Object(P.a)({},l)},jo={zoom:8,center:[2,105.5]},ko=function(){var e=function(e){var t=e.data.features[0].properties.coordinateProperties.times,r=Object(n.useState)({step:33,percentage:0}),a=Object(f.a)(r,2),i=a[0],o=a[1],s=i.step,u=i.percentage;return Object(n.useEffect)(function(){var t=e.data.features[0].geometry.coordinates,r=function(e){e.preventDefault(),"ArrowUp"===e.key?(e.stopPropagation(),o(u<90?{step:s,percentage:u+10}:{step:s+1,percentage:0})):"ArrowDown"===e.key?(e.stopPropagation(),o(u>0?{step:s,percentage:u-10}:{step:s-1,percentage:90})):"ArrowRight"===e.key?(e.stopPropagation(),s<t.length-1&&o({step:s+1,percentage:0})):"ArrowLeft"===e.key&&(e.stopPropagation(),s>0&&o({step:s-1,percentage:0}))};return window.addEventListener("keydown",r,!0),function(){window.removeEventListener("keydown",r,!0)}},[u,s,e.data.features]),{timestamp:t[s],percentage:u}}(Mo),t=e.timestamp,r=e.percentage,i=Ro(Mo,t,r),o=i.center,s=i.bearing,u=Object(n.useMemo)(function(){return[{latitude:o[1],longitude:o[0],content:a.a.createElement("span",{className:Ao.a.arrow,style:{transform:"translate(-50%, -50%) rotate(".concat(s,"deg)")}})}]},[s,o]);return a.a.createElement("div",{className:Ao.a.mapContainer},a.a.createElement(vo,{viewport:jo,tracks:Po,markers:u,transitionsEnabled:!1}))},Do=function(){return a.a.createElement(s.b,null,a.a.createElement(l,{path:"".concat("/pcp-prototypes","/"),default:!0}),a.a.createElement(Ie,{path:"".concat("/pcp-prototypes","/search")}),a.a.createElement(De,{path:"".concat("/pcp-prototypes","/scrolling")}),a.a.createElement(ko,{path:"".concat("/pcp-prototypes","/map-navigation")}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(Do,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},48:function(e,t,r){e.exports={container:"multi-select_container__30fY9",selectionsContainer:"multi-select_selectionsContainer__10emW",selectionItem:"multi-select_selectionItem__3L-va",selectionItemRemoveBtn:"multi-select_selectionItemRemoveBtn__3MPcp",inputText:"multi-select_inputText__3jLz4",toggleBtn:"multi-select_toggleBtn__35nKM",listContainer:"multi-select_listContainer__3_z51"}},93:function(e,t,r){e.exports={selectionContainer:"search_selectionContainer__5miAf"}}},[[220,1,2]]]);
//# sourceMappingURL=main.5f01c991.chunk.js.map